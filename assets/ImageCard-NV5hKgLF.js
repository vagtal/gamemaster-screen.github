import{r as f,j as e}from"./index-DsPVNeCc.js";import{R as C,C as n,M as b,B as j,k as p,b as U,F,aV as h}from"./FirebaseUtils-HVElewoM.js";import{u as R}from"./useAccountSync-B8QgE56T.js";import{F as k}from"./FileUpload-CXkB1MoP.js";import{I as D}from"./Image-CjrAABXn.js";import"./index-e3d5d3f4-Bp0ZfS4h.js";import"./tslib.es6-CDuPK5Eb.js";import"./LongPressButton-BLUHbYlB.js";import"./Paragraph-CiA2wm3O.js";import"./Anchor-C5bMsW47.js";import"./List-D2GmBvKY.js";import"./Select-B2rWent2.js";function v(g){const{state:u,dispatch:o}=f.useContext(C),l=R(),c=l&&u.user.hasStorage,{card:a}=g,[I,m]=f.useState(!1),x=c?"Drag and drop from a file or tab, or click to view files":"Drag and drop an image from another tab, or click to input a URL";let d=e.jsx(U,{label:x,onClick:()=>m(!0),fill:!0});return a.imageUrl.length>0&&(d=e.jsx(D,{fit:"contain",alt:"referenced image",src:a.imageUrl})),I&&(d=e.jsx(k,{currentUrl:g.card.imageUrl,onFileSelect:r=>{m(!1),o(n.SetImageUrl({cardId:a.cardId,imageUrl:r.url}))},fileType:"image",allowDirectLink:!0})),e.jsx(b,{commands:e.jsx(U,{icon:e.jsx(F,{icon:h}),onClick:()=>m(!0)}),cardState:a,onPaste:async r=>{var i;const t=(i=r.clipboardData.files)==null?void 0:i[0];if(c&&t){const s=await p.UploadUserFileToStorageAndGetURL(t,l,"image");o(n.SetImageUrl({cardId:a.cardId,imageUrl:s}))}},children:e.jsx(j,{fill:!0,onDropCapture:async r=>{var s;const t=r.dataTransfer.getData("URL");if(t){o(n.SetImageUrl({cardId:a.cardId,imageUrl:t}));return}const i=(s=r.dataTransfer.files)==null?void 0:s[0];if(c&&i){const S=await p.UploadUserFileToStorageAndGetURL(i,l,"image");o(n.SetImageUrl({cardId:a.cardId,imageUrl:S}));return}},children:d})})}export{v as default};
