import{r as n,j as e}from"./index-DiojgAgK.js";import{R as c,u as h,b,F as j,l as y,m as w,n as D,q as A,H as I,B as d,a as u,G as v,i as p,j as f,g as B,r as C,o as R,d as m,V as T,h as V,U as k,k as E}from"./FirebaseUtils-Br4SKQFO.js";import{R as F,A as G}from"./RollAllTablesButton-DReK43QB.js";import{u as H,C as P}from"./usePageTitle-KDece7ZW.js";import"./RollTableCard-DqBOIudu.js";import"./TextArea-Bgm-948E.js";import"./useScrollTo-hWQfr9bc.js";function z(){const{state:t}=n.useContext(c),a=h();return e.jsx(b,{icon:e.jsx(j,{icon:y}),label:"Copy this Dashboard",onClick:()=>L(t,a)})}function L(t,a){if(!a)return;const s=localStorage.getItem("appState"),l=s?JSON.parse(s):null,r=w.merge(D(),l),i=A(),o=t.dashboardsById[a];o&&(r.dashboardsById[i]={...o,campaignId:void 0}),r.cardsById={...r.cardsById,...t.cardsById},localStorage.setItem("appState",JSON.stringify(r)),window.location.href=`/e/${i}`}const x=()=>{var s;const{state:t}=n.useContext(c),a=h();return e.jsxs(I,{background:"brand",pad:"small",fill:"horizontal",children:[e.jsxs(d,{fill:"horizontal",direction:"column",justify:"center",align:"center",children:[e.jsx(u,{level:1,size:"small",margin:"none",children:((s=v(t,a))==null?void 0:s.name)||"Loading..."}),e.jsx(u,{level:2,size:"small",margin:"none",children:"Shared from Paragon Campaign Dashboard"})]}),e.jsxs(d,{direction:"row",flex:"grow",children:[e.jsx(F,{}),e.jsx(z,{})]})]})};function N(t){const[a,s]=n.useState(null);return n.useEffect(()=>{if(!t)return;const l=B(),r=C(l,`shared/${t}`);return R(r,i=>{const o=i.val();if(!o)return;m(r);const S=k(o),g=E.restorePrunedEmptyArrays(S);s(g)}),()=>m(r)},[t]),a}function Q(){const t=h(),a=N(t);return a?e.jsx(O,{loadedState:a}):e.jsx(p,{style:{minHeight:"100%"},theme:f,children:e.jsx(d,{fill:!0,align:"center",children:e.jsx(x,{})})})}function O(t){const[a,s]=n.useReducer(G,t.loadedState);return H(a),e.jsx(c.Provider,{value:{state:a,dispatch:s},children:e.jsx(T.Provider,{value:V.Dashboard,children:e.jsx(p,{style:{minHeight:"100%"},theme:f,children:e.jsxs(d,{fill:!0,align:"center",children:[e.jsx(x,{}),e.jsx(P,{})]})})})})}export{O as SharedDashboardViewWithState,Q as default};
