var $t=Object.defineProperty;var Pt=A=>{throw TypeError(A)};var zt=(A,r,y)=>r in A?$t(A,r,{enumerable:!0,configurable:!0,writable:!0,value:y}):A[r]=y;var we=(A,r,y)=>zt(A,typeof r!="symbol"?r+"":r,y),it=(A,r,y)=>r.has(A)||Pt("Cannot "+y);var I=(A,r,y)=>(it(A,r,"read from private field"),y?y.call(A):r.get(A)),ue=(A,r,y)=>r.has(A)?Pt("Cannot add the same private member more than once"):r instanceof WeakSet?r.add(A):r.set(A,y),he=(A,r,y,e)=>(it(A,r,"write to private field"),e?e.call(A,y):r.set(A,y),y),ce=(A,r,y)=>(it(A,r,"access private method"),y);var at=(A,r,y,e)=>({set _(a){he(A,r,a,y)},get _(){return I(A,r,e)}});import{g as getAugmentedNamespace,$ as _objectWithoutPropertiesLoose,a0 as _setPrototypeOf,r as reactExports,R as React,W as PropTypes,a1 as invariant,a2 as _extends,j as jsxRuntimeExports}from"./index-CLRY2txC.js";import{R as ReducerContext,V as ViewTypeContext,h as ViewType,P as PlayerViewPermission,M as BaseCard,B as Box,C as CardActions,b as Button,F as FontAwesomeIcon,b4 as faFileUpload,b5 as faList,b6 as faStepBackward,b7 as faCaretLeft,T as TextInput,b8 as faCaretRight,b9 as faStepForward,ba as faArrowsAltV,bb as faArrowsAltH}from"./FirebaseUtils-Btl4gnlr.js";import{c as commonjsRequire}from"./_commonjs-dynamic-modules-TDtrdbi3.js";import{c as clsx}from"./usePageTitle-DMpdEw5o.js";import{F as FileUpload}from"./FileUpload-bMUTXyc4.js";import{P as Paragraph}from"./Paragraph-CbCK5YeJ.js";import"./LongPressButton-5M01ANof.js";import"./useAccountSync-z4HZgZfC.js";import"./index-e3d5d3f4-DP6eC2yO.js";import"./tslib.es6-CDuPK5Eb.js";import"./Anchor-DQ3AdrQf.js";import"./List-DksybSsZ.js";import"./Select-C8LOAl_1.js";function warning(A,r){}var pdf={exports:{}};const __viteBrowserExternal={},__viteBrowserExternal$1=Object.freeze(Object.defineProperty({__proto__:null,default:__viteBrowserExternal},Symbol.toStringTag,{value:"Module"})),require$$5=getAugmentedNamespace(__viteBrowserExternal$1);var hasRequiredPdf;function requirePdf(){return hasRequiredPdf||(hasRequiredPdf=1,function(module,exports){(function(r,y){module.exports=y()})(globalThis,()=>(()=>{var __webpack_modules__=[,(A,r,y)=>{Object.defineProperty(r,"__esModule",{value:!0}),r.VerbosityLevel=r.Util=r.UnknownErrorException=r.UnexpectedResponseException=r.UNSUPPORTED_FEATURES=r.TextRenderingMode=r.StreamType=r.RenderingIntentFlag=r.PermissionFlag=r.PasswordResponses=r.PasswordException=r.PageActionEventType=r.OPS=r.MissingPDFException=r.LINE_FACTOR=r.LINE_DESCENT_FACTOR=r.InvalidPDFException=r.ImageKind=r.IDENTITY_MATRIX=r.FormatError=r.FontType=r.FeatureTest=r.FONT_IDENTITY_MATRIX=r.DocumentActionEventType=r.CMapCompressionType=r.BaseException=r.AnnotationType=r.AnnotationStateModelType=r.AnnotationReviewState=r.AnnotationReplyType=r.AnnotationMode=r.AnnotationMarkedState=r.AnnotationFlag=r.AnnotationFieldFlag=r.AnnotationEditorType=r.AnnotationEditorPrefix=r.AnnotationEditorParamsType=r.AnnotationBorderStyleType=r.AnnotationActionEventType=r.AbortException=void 0,r.arrayByteLength=N,r.arraysToBytes=te,r.assert=p,r.bytesToString=M,r.createPromiseCapability=Ue,r.createValidAbsoluteUrl=D,r.escapeString=ve,r.getModificationDate=je,r.getVerbosityLevel=ne,r.info=le,r.isArrayBuffer=Pe,r.isArrayEqual=Ie,r.isAscii=xe,r.objectFromMap=ee,r.objectSize=J,r.setVerbosityLevel=X,r.shadow=U,r.string32=H,r.stringToBytes=m,r.stringToPDFString=be,r.stringToUTF16BEString=Ae,r.stringToUTF8String=Ce,r.unreachable=$,r.utf8StringToString=Ee,r.warn=fe,y(2);const e=[1,0,0,1,0,0];r.IDENTITY_MATRIX=e;const a=[.001,0,0,.001,0,0];r.FONT_IDENTITY_MATRIX=a;const k=1.35;r.LINE_FACTOR=k;const O=.35;r.LINE_DESCENT_FACTOR=O;const S={ANY:1,DISPLAY:2,PRINT:4,ANNOTATIONS_FORMS:16,ANNOTATIONS_STORAGE:32,ANNOTATIONS_DISABLE:64,OPLIST:256};r.RenderingIntentFlag=S;const _={DISABLE:0,ENABLE:1,ENABLE_FORMS:2,ENABLE_STORAGE:3};r.AnnotationMode=_;const f="pdfjs_internal_editor_";r.AnnotationEditorPrefix=f;const C={DISABLE:-1,NONE:0,FREETEXT:3,INK:15};r.AnnotationEditorType=C;const L={FREETEXT_SIZE:1,FREETEXT_COLOR:2,FREETEXT_OPACITY:3,INK_COLOR:11,INK_THICKNESS:12,INK_OPACITY:13};r.AnnotationEditorParamsType=L;const w={PRINT:4,MODIFY_CONTENTS:8,COPY:16,MODIFY_ANNOTATIONS:32,FILL_INTERACTIVE_FORMS:256,COPY_FOR_ACCESSIBILITY:512,ASSEMBLE:1024,PRINT_HIGH_QUALITY:2048};r.PermissionFlag=w;const T={FILL:0,STROKE:1,FILL_STROKE:2,INVISIBLE:3,FILL_ADD_TO_PATH:4,STROKE_ADD_TO_PATH:5,FILL_STROKE_ADD_TO_PATH:6,ADD_TO_PATH:7,FILL_STROKE_MASK:3,ADD_TO_PATH_FLAG:4};r.TextRenderingMode=T;const h={GRAYSCALE_1BPP:1,RGB_24BPP:2,RGBA_32BPP:3};r.ImageKind=h;const t={TEXT:1,LINK:2,FREETEXT:3,LINE:4,SQUARE:5,CIRCLE:6,POLYGON:7,POLYLINE:8,HIGHLIGHT:9,UNDERLINE:10,SQUIGGLY:11,STRIKEOUT:12,STAMP:13,CARET:14,INK:15,POPUP:16,FILEATTACHMENT:17,SOUND:18,MOVIE:19,WIDGET:20,SCREEN:21,PRINTERMARK:22,TRAPNET:23,WATERMARK:24,THREED:25,REDACT:26};r.AnnotationType=t;const o={MARKED:"Marked",REVIEW:"Review"};r.AnnotationStateModelType=o;const c={MARKED:"Marked",UNMARKED:"Unmarked"};r.AnnotationMarkedState=c;const x={ACCEPTED:"Accepted",REJECTED:"Rejected",CANCELLED:"Cancelled",COMPLETED:"Completed",NONE:"None"};r.AnnotationReviewState=x;const b={GROUP:"Group",REPLY:"R"};r.AnnotationReplyType=b;const d={INVISIBLE:1,HIDDEN:2,PRINT:4,NOZOOM:8,NOROTATE:16,NOVIEW:32,READONLY:64,LOCKED:128,TOGGLENOVIEW:256,LOCKEDCONTENTS:512};r.AnnotationFlag=d;const i={READONLY:1,REQUIRED:2,NOEXPORT:4,MULTILINE:4096,PASSWORD:8192,NOTOGGLETOOFF:16384,RADIO:32768,PUSHBUTTON:65536,COMBO:131072,EDIT:262144,SORT:524288,FILESELECT:1048576,MULTISELECT:2097152,DONOTSPELLCHECK:4194304,DONOTSCROLL:8388608,COMB:16777216,RICHTEXT:33554432,RADIOSINUNISON:33554432,COMMITONSELCHANGE:67108864};r.AnnotationFieldFlag=i;const l={SOLID:1,DASHED:2,BEVELED:3,INSET:4,UNDERLINE:5};r.AnnotationBorderStyleType=l;const n={E:"Mouse Enter",X:"Mouse Exit",D:"Mouse Down",U:"Mouse Up",Fo:"Focus",Bl:"Blur",PO:"PageOpen",PC:"PageClose",PV:"PageVisible",PI:"PageInvisible",K:"Keystroke",F:"Format",V:"Validate",C:"Calculate"};r.AnnotationActionEventType=n;const E={WC:"WillClose",WS:"WillSave",DS:"DidSave",WP:"WillPrint",DP:"DidPrint"};r.DocumentActionEventType=E;const R={O:"PageOpen",C:"PageClose"};r.PageActionEventType=R;const G={UNKNOWN:"UNKNOWN",FLATE:"FLATE",LZW:"LZW",DCT:"DCT",JPX:"JPX",JBIG:"JBIG",A85:"A85",AHX:"AHX",CCF:"CCF",RLX:"RLX"};r.StreamType=G;const q={UNKNOWN:"UNKNOWN",TYPE1:"TYPE1",TYPE1STANDARD:"TYPE1STANDARD",TYPE1C:"TYPE1C",CIDFONTTYPE0:"CIDFONTTYPE0",CIDFONTTYPE0C:"CIDFONTTYPE0C",TRUETYPE:"TRUETYPE",CIDFONTTYPE2:"CIDFONTTYPE2",TYPE3:"TYPE3",OPENTYPE:"OPENTYPE",TYPE0:"TYPE0",MMTYPE1:"MMTYPE1"};r.FontType=q;const se={ERRORS:0,WARNINGS:1,INFOS:5};r.VerbosityLevel=se;const ae={NONE:0,BINARY:1,STREAM:2};r.CMapCompressionType=ae;const Z={dependency:1,setLineWidth:2,setLineCap:3,setLineJoin:4,setMiterLimit:5,setDash:6,setRenderingIntent:7,setFlatness:8,setGState:9,save:10,restore:11,transform:12,moveTo:13,lineTo:14,curveTo:15,curveTo2:16,curveTo3:17,closePath:18,rectangle:19,stroke:20,closeStroke:21,fill:22,eoFill:23,fillStroke:24,eoFillStroke:25,closeFillStroke:26,closeEOFillStroke:27,endPath:28,clip:29,eoClip:30,beginText:31,endText:32,setCharSpacing:33,setWordSpacing:34,setHScale:35,setLeading:36,setFont:37,setTextRenderingMode:38,setTextRise:39,moveText:40,setLeadingMoveText:41,setTextMatrix:42,nextLine:43,showText:44,showSpacedText:45,nextLineShowText:46,nextLineSetSpacingShowText:47,setCharWidth:48,setCharWidthAndBounds:49,setStrokeColorSpace:50,setFillColorSpace:51,setStrokeColor:52,setStrokeColorN:53,setFillColor:54,setFillColorN:55,setStrokeGray:56,setFillGray:57,setStrokeRGBColor:58,setFillRGBColor:59,setStrokeCMYKColor:60,setFillCMYKColor:61,shadingFill:62,beginInlineImage:63,beginImageData:64,endInlineImage:65,paintXObject:66,markPoint:67,markPointProps:68,beginMarkedContent:69,beginMarkedContentProps:70,endMarkedContent:71,beginCompat:72,endCompat:73,paintFormXObjectBegin:74,paintFormXObjectEnd:75,beginGroup:76,endGroup:77,beginAnnotations:78,endAnnotations:79,beginAnnotation:80,endAnnotation:81,paintJpegXObject:82,paintImageMaskXObject:83,paintImageMaskXObjectGroup:84,paintImageXObject:85,paintInlineImageXObject:86,paintInlineImageXObjectGroup:87,paintImageXObjectRepeat:88,paintImageMaskXObjectRepeat:89,paintSolidColorImageMask:90,constructPath:91};r.OPS=Z;const Q={unknown:"unknown",forms:"forms",javaScript:"javaScript",signatures:"signatures",smask:"smask",shadingPattern:"shadingPattern",font:"font",errorTilingPattern:"errorTilingPattern",errorExtGState:"errorExtGState",errorXObject:"errorXObject",errorFontLoadType3:"errorFontLoadType3",errorFontState:"errorFontState",errorFontMissing:"errorFontMissing",errorFontTranslate:"errorFontTranslate",errorColorSpace:"errorColorSpace",errorOperatorList:"errorOperatorList",errorFontToUnicode:"errorFontToUnicode",errorFontLoadNative:"errorFontLoadNative",errorFontBuildPath:"errorFontBuildPath",errorFontGetPath:"errorFontGetPath",errorMarkedContent:"errorMarkedContent",errorContentSubStream:"errorContentSubStream"};r.UNSUPPORTED_FEATURES=Q;const z={NEED_PASSWORD:1,INCORRECT_PASSWORD:2};r.PasswordResponses=z;let V=se.WARNINGS;function X(ie){Number.isInteger(ie)&&(V=ie)}function ne(){return V}function le(ie){V>=se.INFOS&&console.log(`Info: ${ie}`)}function fe(ie){V>=se.WARNINGS&&console.log(`Warning: ${ie}`)}function $(ie){throw new Error(ie)}function p(ie,Y){ie||$(Y)}function u(ie){if(!ie)return!1;switch(ie.protocol){case"http:":case"https:":case"ftp:":case"mailto:":case"tel:":return!0;default:return!1}}function D(ie,Y=null,K=null){if(!ie)return null;try{if(K&&typeof ie=="string"){if(K.addDefaultProtocol&&ie.startsWith("www.")){const ye=ie.match(/\./g);ye&&ye.length>=2&&(ie=`http://${ie}`)}if(K.tryConvertEncoding)try{ie=Ce(ie)}catch{}}const pe=Y?new URL(ie,Y):new URL(ie);if(u(pe))return pe}catch{}return null}function U(ie,Y,K){return Object.defineProperty(ie,Y,{value:K,enumerable:!0,configurable:!0,writable:!1}),K}const B=function(){function Y(K,pe){this.constructor===Y&&$("Cannot initialize BaseException."),this.message=K,this.name=pe}return Y.prototype=new Error,Y.constructor=Y,Y}();r.BaseException=B;class W extends B{constructor(Y,K){super(Y,"PasswordException"),this.code=K}}r.PasswordException=W;class s extends B{constructor(Y,K){super(Y,"UnknownErrorException"),this.details=K}}r.UnknownErrorException=s;class g extends B{constructor(Y){super(Y,"InvalidPDFException")}}r.InvalidPDFException=g;class P extends B{constructor(Y){super(Y,"MissingPDFException")}}r.MissingPDFException=P;class v extends B{constructor(Y,K){super(Y,"UnexpectedResponseException"),this.status=K}}r.UnexpectedResponseException=v;class F extends B{constructor(Y){super(Y,"FormatError")}}r.FormatError=F;class j extends B{constructor(Y){super(Y,"AbortException")}}r.AbortException=j;function M(ie){(typeof ie!="object"||ie===null||ie.length===void 0)&&$("Invalid argument for bytesToString");const Y=ie.length,K=8192;if(Y<K)return String.fromCharCode.apply(null,ie);const pe=[];for(let ye=0;ye<Y;ye+=K){const Te=Math.min(ye+K,Y),Se=ie.subarray(ye,Te);pe.push(String.fromCharCode.apply(null,Se))}return pe.join("")}function m(ie){typeof ie!="string"&&$("Invalid argument for stringToBytes");const Y=ie.length,K=new Uint8Array(Y);for(let pe=0;pe<Y;++pe)K[pe]=ie.charCodeAt(pe)&255;return K}function N(ie){if(ie.length!==void 0)return ie.length;if(ie.byteLength!==void 0)return ie.byteLength;$("Invalid argument for arrayByteLength")}function te(ie){const Y=ie.length;if(Y===1&&ie[0]instanceof Uint8Array)return ie[0];let K=0;for(let Te=0;Te<Y;Te++)K+=N(ie[Te]);let pe=0;const ye=new Uint8Array(K);for(let Te=0;Te<Y;Te++){let Se=ie[Te];Se instanceof Uint8Array||(typeof Se=="string"?Se=m(Se):Se=new Uint8Array(Se));const De=Se.byteLength;ye.set(Se,pe),pe+=De}return ye}function H(ie){return String.fromCharCode(ie>>24&255,ie>>16&255,ie>>8&255,ie&255)}function J(ie){return Object.keys(ie).length}function ee(ie){const Y=Object.create(null);for(const[K,pe]of ie)Y[K]=pe;return Y}function oe(){const ie=new Uint8Array(4);return ie[0]=1,new Uint32Array(ie.buffer,0,1)[0]===1}function de(){try{return new Function(""),!0}catch{return!1}}class re{static get isLittleEndian(){return U(this,"isLittleEndian",oe())}static get isEvalSupported(){return U(this,"isEvalSupported",de())}static get isOffscreenCanvasSupported(){return U(this,"isOffscreenCanvasSupported",typeof OffscreenCanvas<"u")}}r.FeatureTest=re;const _e=[...Array(256).keys()].map(ie=>ie.toString(16).padStart(2,"0"));class me{static makeHexColor(Y,K,pe){return`#${_e[Y]}${_e[K]}${_e[pe]}`}static scaleMinMax(Y,K){let pe;Y[0]?(Y[0]<0&&(pe=K[0],K[0]=K[1],K[1]=pe),K[0]*=Y[0],K[1]*=Y[0],Y[3]<0&&(pe=K[2],K[2]=K[3],K[3]=pe),K[2]*=Y[3],K[3]*=Y[3]):(pe=K[0],K[0]=K[2],K[2]=pe,pe=K[1],K[1]=K[3],K[3]=pe,Y[1]<0&&(pe=K[2],K[2]=K[3],K[3]=pe),K[2]*=Y[1],K[3]*=Y[1],Y[2]<0&&(pe=K[0],K[0]=K[1],K[1]=pe),K[0]*=Y[2],K[1]*=Y[2]),K[0]+=Y[4],K[1]+=Y[4],K[2]+=Y[5],K[3]+=Y[5]}static transform(Y,K){return[Y[0]*K[0]+Y[2]*K[1],Y[1]*K[0]+Y[3]*K[1],Y[0]*K[2]+Y[2]*K[3],Y[1]*K[2]+Y[3]*K[3],Y[0]*K[4]+Y[2]*K[5]+Y[4],Y[1]*K[4]+Y[3]*K[5]+Y[5]]}static applyTransform(Y,K){const pe=Y[0]*K[0]+Y[1]*K[2]+K[4],ye=Y[0]*K[1]+Y[1]*K[3]+K[5];return[pe,ye]}static applyInverseTransform(Y,K){const pe=K[0]*K[3]-K[1]*K[2],ye=(Y[0]*K[3]-Y[1]*K[2]+K[2]*K[5]-K[4]*K[3])/pe,Te=(-Y[0]*K[1]+Y[1]*K[0]+K[4]*K[1]-K[5]*K[0])/pe;return[ye,Te]}static getAxialAlignedBoundingBox(Y,K){const pe=me.applyTransform(Y,K),ye=me.applyTransform(Y.slice(2,4),K),Te=me.applyTransform([Y[0],Y[3]],K),Se=me.applyTransform([Y[2],Y[1]],K);return[Math.min(pe[0],ye[0],Te[0],Se[0]),Math.min(pe[1],ye[1],Te[1],Se[1]),Math.max(pe[0],ye[0],Te[0],Se[0]),Math.max(pe[1],ye[1],Te[1],Se[1])]}static inverseTransform(Y){const K=Y[0]*Y[3]-Y[1]*Y[2];return[Y[3]/K,-Y[1]/K,-Y[2]/K,Y[0]/K,(Y[2]*Y[5]-Y[4]*Y[3])/K,(Y[4]*Y[1]-Y[5]*Y[0])/K]}static apply3dTransform(Y,K){return[Y[0]*K[0]+Y[1]*K[1]+Y[2]*K[2],Y[3]*K[0]+Y[4]*K[1]+Y[5]*K[2],Y[6]*K[0]+Y[7]*K[1]+Y[8]*K[2]]}static singularValueDecompose2dScale(Y){const K=[Y[0],Y[2],Y[1],Y[3]],pe=Y[0]*K[0]+Y[1]*K[2],ye=Y[0]*K[1]+Y[1]*K[3],Te=Y[2]*K[0]+Y[3]*K[2],Se=Y[2]*K[1]+Y[3]*K[3],De=(pe+Se)/2,Be=Math.sqrt((pe+Se)**2-4*(pe*Se-Te*ye))/2,Ne=De+Be||1,ke=De-Be||1;return[Math.sqrt(Ne),Math.sqrt(ke)]}static normalizeRect(Y){const K=Y.slice(0);return Y[0]>Y[2]&&(K[0]=Y[2],K[2]=Y[0]),Y[1]>Y[3]&&(K[1]=Y[3],K[3]=Y[1]),K}static intersect(Y,K){const pe=Math.max(Math.min(Y[0],Y[2]),Math.min(K[0],K[2])),ye=Math.min(Math.max(Y[0],Y[2]),Math.max(K[0],K[2]));if(pe>ye)return null;const Te=Math.max(Math.min(Y[1],Y[3]),Math.min(K[1],K[3])),Se=Math.min(Math.max(Y[1],Y[3]),Math.max(K[1],K[3]));return Te>Se?null:[pe,Te,ye,Se]}static bezierBoundingBox(Y,K,pe,ye,Te,Se,De,Be){const Ne=[],ke=[[],[]];let We,Le,Xe,Re,Ye,Ke,nt,rt;for(let st=0;st<2;++st){if(st===0?(Le=6*Y-12*pe+6*Te,We=-3*Y+9*pe-9*Te+3*De,Xe=3*pe-3*Y):(Le=6*K-12*ye+6*Se,We=-3*K+9*ye-9*Se+3*Be,Xe=3*ye-3*K),Math.abs(We)<1e-12){if(Math.abs(Le)<1e-12)continue;Re=-Xe/Le,0<Re&&Re<1&&Ne.push(Re);continue}nt=Le*Le-4*Xe*We,rt=Math.sqrt(nt),!(nt<0)&&(Ye=(-Le+rt)/(2*We),0<Ye&&Ye<1&&Ne.push(Ye),Ke=(-Le-rt)/(2*We),0<Ke&&Ke<1&&Ne.push(Ke))}let He=Ne.length,Fe;const $e=He;for(;He--;)Re=Ne[He],Fe=1-Re,ke[0][He]=Fe*Fe*Fe*Y+3*Fe*Fe*Re*pe+3*Fe*Re*Re*Te+Re*Re*Re*De,ke[1][He]=Fe*Fe*Fe*K+3*Fe*Fe*Re*ye+3*Fe*Re*Re*Se+Re*Re*Re*Be;return ke[0][$e]=Y,ke[1][$e]=K,ke[0][$e+1]=De,ke[1][$e+1]=Be,ke[0].length=ke[1].length=$e+2,[Math.min(...ke[0]),Math.min(...ke[1]),Math.max(...ke[0]),Math.max(...ke[1])]}}r.Util=me;const ge=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,728,711,710,729,733,731,730,732,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,8226,8224,8225,8230,8212,8211,402,8260,8249,8250,8722,8240,8222,8220,8221,8216,8217,8218,8482,64257,64258,321,338,352,376,381,305,322,339,353,382,0,8364];function be(ie){if(ie[0]>="ï"){let K;if(ie[0]==="þ"&&ie[1]==="ÿ"?K="utf-16be":ie[0]==="ÿ"&&ie[1]==="þ"?K="utf-16le":ie[0]==="ï"&&ie[1]==="»"&&ie[2]==="¿"&&(K="utf-8"),K)try{const pe=new TextDecoder(K,{fatal:!0}),ye=m(ie);return pe.decode(ye)}catch(pe){fe(`stringToPDFString: "${pe}".`)}}const Y=[];for(let K=0,pe=ie.length;K<pe;K++){const ye=ge[ie.charCodeAt(K)];Y.push(ye?String.fromCharCode(ye):ie.charAt(K))}return Y.join("")}function ve(ie){return ie.replace(/([()\\\n\r])/g,Y=>Y===`
`?"\\n":Y==="\r"?"\\r":`\\${Y}`)}function xe(ie){return/^[\x00-\x7F]*$/.test(ie)}function Ae(ie){const Y=["þÿ"];for(let K=0,pe=ie.length;K<pe;K++){const ye=ie.charCodeAt(K);Y.push(String.fromCharCode(ye>>8&255),String.fromCharCode(ye&255))}return Y.join("")}function Ce(ie){return decodeURIComponent(escape(ie))}function Ee(ie){return unescape(encodeURIComponent(ie))}function Pe(ie){return typeof ie=="object"&&ie!==null&&ie.byteLength!==void 0}function Ie(ie,Y){if(ie.length!==Y.length)return!1;for(let K=0,pe=ie.length;K<pe;K++)if(ie[K]!==Y[K])return!1;return!0}function je(ie=new Date){return[ie.getUTCFullYear().toString(),(ie.getUTCMonth()+1).toString().padStart(2,"0"),ie.getUTCDate().toString().padStart(2,"0"),ie.getUTCHours().toString().padStart(2,"0"),ie.getUTCMinutes().toString().padStart(2,"0"),ie.getUTCSeconds().toString().padStart(2,"0")].join("")}function Ue(){const ie=Object.create(null);let Y=!1;return Object.defineProperty(ie,"settled",{get(){return Y}}),ie.promise=new Promise(function(K,pe){ie.resolve=function(ye){Y=!0,K(ye)},ie.reject=function(ye){Y=!0,pe(ye)}}),ie}},(A,r,y)=>{y(3)},(A,r)=>{Object.defineProperty(r,"__esModule",{value:!0}),r.isNodeJS=void 0;const y=typeof process=="object"&&process+""=="[object process]"&&!process.versions.nw&&!(process.versions.electron&&process.type&&process.type!=="browser");r.isNodeJS=y},(__unused_webpack_module,exports,__w_pdfjs_require__)=>{var A,y,e,a,k,O,S,_,f,ot,L,w;Object.defineProperty(exports,"__esModule",{value:!0}),exports.build=exports.RenderTask=exports.PDFWorkerUtil=exports.PDFWorker=exports.PDFPageProxy=exports.PDFDocumentProxy=exports.PDFDocumentLoadingTask=exports.PDFDataRangeTransport=exports.LoopbackPort=exports.DefaultStandardFontDataFactory=exports.DefaultCanvasFactory=exports.DefaultCMapReaderFactory=void 0,exports.getDocument=getDocument,exports.setPDFNetworkStreamFactory=setPDFNetworkStreamFactory,exports.version=void 0;var _util=__w_pdfjs_require__(1),_annotation_storage=__w_pdfjs_require__(5),_display_utils=__w_pdfjs_require__(8),_font_loader=__w_pdfjs_require__(11),_canvas=__w_pdfjs_require__(12),_worker_options=__w_pdfjs_require__(15),_is_node=__w_pdfjs_require__(3),_message_handler=__w_pdfjs_require__(16),_metadata=__w_pdfjs_require__(17),_optional_content_config=__w_pdfjs_require__(18),_transport_stream=__w_pdfjs_require__(19),_xfa_text=__w_pdfjs_require__(20);const DEFAULT_RANGE_CHUNK_SIZE=65536,RENDERING_CANCELLED_TIMEOUT=100;let DefaultCanvasFactory=_display_utils.DOMCanvasFactory;exports.DefaultCanvasFactory=DefaultCanvasFactory;let DefaultCMapReaderFactory=_display_utils.DOMCMapReaderFactory;exports.DefaultCMapReaderFactory=DefaultCMapReaderFactory;let DefaultStandardFontDataFactory=_display_utils.DOMStandardFontDataFactory;if(exports.DefaultStandardFontDataFactory=DefaultStandardFontDataFactory,_is_node.isNodeJS){const{NodeCanvasFactory:h,NodeCMapReaderFactory:t,NodeStandardFontDataFactory:o}=__w_pdfjs_require__(21);exports.DefaultCanvasFactory=DefaultCanvasFactory=h,exports.DefaultCMapReaderFactory=DefaultCMapReaderFactory=t,exports.DefaultStandardFontDataFactory=DefaultStandardFontDataFactory=o}let createPDFNetworkStream;function setPDFNetworkStreamFactory(h){createPDFNetworkStream=h}function getDocument(h){const t=new PDFDocumentLoadingTask;let o;if(typeof h=="string"||h instanceof URL)o={url:h};else if((0,_util.isArrayBuffer)(h))o={data:h};else if(h instanceof PDFDataRangeTransport)o={range:h};else{if(typeof h!="object")throw new Error("Invalid parameter in getDocument, need either string, URL, TypedArray, or parameter object.");if(!h.url&&!h.data&&!h.range)throw new Error("Invalid parameter object: need either .data, .range or .url");o=h}const c=Object.create(null);let x=null,b=null;for(const i in o){const l=o[i];switch(i){case"url":if(typeof window<"u")try{c[i]=new URL(l,window.location).href;continue}catch(n){(0,_util.warn)(`Cannot create valid URL: "${n}".`)}else if(typeof l=="string"||l instanceof URL){c[i]=l.toString();continue}throw new Error("Invalid PDF url data: either string or URL-object is expected in the url property.");case"range":x=l;continue;case"worker":b=l;continue;case"data":if(_is_node.isNodeJS&&typeof Buffer<"u"&&l instanceof Buffer)c[i]=new Uint8Array(l);else{if(l instanceof Uint8Array)break;if(typeof l=="string")c[i]=(0,_util.stringToBytes)(l);else if(typeof l=="object"&&l!==null&&!isNaN(l.length))c[i]=new Uint8Array(l);else if((0,_util.isArrayBuffer)(l))c[i]=new Uint8Array(l);else throw new Error("Invalid PDF binary data: either TypedArray, string, or array-like object is expected in the data property.")}continue}c[i]=l}if(c.CMapReaderFactory=c.CMapReaderFactory||DefaultCMapReaderFactory,c.StandardFontDataFactory=c.StandardFontDataFactory||DefaultStandardFontDataFactory,c.ignoreErrors=c.stopAtErrors!==!0,c.fontExtraProperties=c.fontExtraProperties===!0,c.pdfBug=c.pdfBug===!0,c.enableXfa=c.enableXfa===!0,(!Number.isInteger(c.rangeChunkSize)||c.rangeChunkSize<1)&&(c.rangeChunkSize=DEFAULT_RANGE_CHUNK_SIZE),(typeof c.docBaseUrl!="string"||(0,_display_utils.isDataScheme)(c.docBaseUrl))&&(c.docBaseUrl=null),(!Number.isInteger(c.maxImageSize)||c.maxImageSize<-1)&&(c.maxImageSize=-1),typeof c.cMapUrl!="string"&&(c.cMapUrl=null),typeof c.standardFontDataUrl!="string"&&(c.standardFontDataUrl=null),typeof c.useWorkerFetch!="boolean"&&(c.useWorkerFetch=c.CMapReaderFactory===_display_utils.DOMCMapReaderFactory&&c.StandardFontDataFactory===_display_utils.DOMStandardFontDataFactory),typeof c.isEvalSupported!="boolean"&&(c.isEvalSupported=!0),typeof c.disableFontFace!="boolean"&&(c.disableFontFace=_is_node.isNodeJS),typeof c.useSystemFonts!="boolean"&&(c.useSystemFonts=!_is_node.isNodeJS&&!c.disableFontFace),(typeof c.ownerDocument!="object"||c.ownerDocument===null)&&(c.ownerDocument=globalThis.document),typeof c.disableRange!="boolean"&&(c.disableRange=!1),typeof c.disableStream!="boolean"&&(c.disableStream=!1),typeof c.disableAutoFetch!="boolean"&&(c.disableAutoFetch=!1),(0,_util.setVerbosityLevel)(c.verbosity),!b){const i={verbosity:c.verbosity,port:_worker_options.GlobalWorkerOptions.workerPort};b=i.port?PDFWorker.fromPort(i):new PDFWorker(i),t._worker=b}const d=t.docId;return b.promise.then(function(){if(t.destroyed)throw new Error("Loading aborted");const i=_fetchDocument(b,c,x,d),l=new Promise(function(n){let E;x?E=new _transport_stream.PDFDataTransportStream({length:c.length,initialData:c.initialData,progressiveDone:c.progressiveDone,contentDispositionFilename:c.contentDispositionFilename,disableRange:c.disableRange,disableStream:c.disableStream},x):c.data||(E=createPDFNetworkStream({url:c.url,length:c.length,httpHeaders:c.httpHeaders,withCredentials:c.withCredentials,rangeChunkSize:c.rangeChunkSize,disableRange:c.disableRange,disableStream:c.disableStream})),n(E)});return Promise.all([i,l]).then(function([n,E]){if(t.destroyed)throw new Error("Loading aborted");const R=new _message_handler.MessageHandler(d,n,b.port),G=new WorkerTransport(R,t,E,c);t._transport=G,R.send("Ready",null)})}).catch(t._capability.reject),t}async function _fetchDocument(h,t,o,c){if(h.destroyed)throw new Error("Worker was destroyed");o&&(t.length=o.length,t.initialData=o.initialData,t.progressiveDone=o.progressiveDone,t.contentDispositionFilename=o.contentDispositionFilename);const x=await h.messageHandler.sendWithPromise("GetDocRequest",{docId:c,apiVersion:"2.16.105",source:{data:t.data,url:t.url,password:t.password,disableAutoFetch:t.disableAutoFetch,rangeChunkSize:t.rangeChunkSize,length:t.length},maxImageSize:t.maxImageSize,disableFontFace:t.disableFontFace,docBaseUrl:t.docBaseUrl,ignoreErrors:t.ignoreErrors,isEvalSupported:t.isEvalSupported,fontExtraProperties:t.fontExtraProperties,enableXfa:t.enableXfa,useSystemFonts:t.useSystemFonts,cMapUrl:t.useWorkerFetch?t.cMapUrl:null,standardFontDataUrl:t.useWorkerFetch?t.standardFontDataUrl:null});if(t.data&&(t.data=null),h.destroyed)throw new Error("Worker was destroyed");return x}const r=class r{constructor(){this._capability=(0,_util.createPromiseCapability)(),this._transport=null,this._worker=null,this.docId=`d${at(r,A)._++}`,this.destroyed=!1,this.onPassword=null,this.onProgress=null,this.onUnsupportedFeature=null}get promise(){return this._capability.promise}async destroy(){var t;this.destroyed=!0,await((t=this._transport)==null?void 0:t.destroy()),this._transport=null,this._worker&&(this._worker.destroy(),this._worker=null)}};A=new WeakMap,ue(r,A,0);let PDFDocumentLoadingTask=r;exports.PDFDocumentLoadingTask=PDFDocumentLoadingTask;class PDFDataRangeTransport{constructor(t,o,c=!1,x=null){this.length=t,this.initialData=o,this.progressiveDone=c,this.contentDispositionFilename=x,this._rangeListeners=[],this._progressListeners=[],this._progressiveReadListeners=[],this._progressiveDoneListeners=[],this._readyCapability=(0,_util.createPromiseCapability)()}addRangeListener(t){this._rangeListeners.push(t)}addProgressListener(t){this._progressListeners.push(t)}addProgressiveReadListener(t){this._progressiveReadListeners.push(t)}addProgressiveDoneListener(t){this._progressiveDoneListeners.push(t)}onDataRange(t,o){for(const c of this._rangeListeners)c(t,o)}onDataProgress(t,o){this._readyCapability.promise.then(()=>{for(const c of this._progressListeners)c(t,o)})}onDataProgressiveRead(t){this._readyCapability.promise.then(()=>{for(const o of this._progressiveReadListeners)o(t)})}onDataProgressiveDone(){this._readyCapability.promise.then(()=>{for(const t of this._progressiveDoneListeners)t()})}transportReady(){this._readyCapability.resolve()}requestDataRange(t,o){(0,_util.unreachable)("Abstract method PDFDataRangeTransport.requestDataRange")}abort(){}}exports.PDFDataRangeTransport=PDFDataRangeTransport;class PDFDocumentProxy{constructor(t,o){this._pdfInfo=t,this._transport=o,Object.defineProperty(this,"fingerprint",{get(){return(0,_display_utils.deprecated)("`PDFDocumentProxy.fingerprint`, please use `PDFDocumentProxy.fingerprints` instead."),this.fingerprints[0]}}),Object.defineProperty(this,"getStats",{value:async()=>((0,_display_utils.deprecated)("`PDFDocumentProxy.getStats`, please use the `PDFDocumentProxy.stats`-getter instead."),this.stats||{streamTypes:{},fontTypes:{}})})}get annotationStorage(){return this._transport.annotationStorage}get numPages(){return this._pdfInfo.numPages}get fingerprints(){return this._pdfInfo.fingerprints}get stats(){return this._transport.stats}get isPureXfa(){return!!this._transport._htmlForXfa}get allXfaHtml(){return this._transport._htmlForXfa}getPage(t){return this._transport.getPage(t)}getPageIndex(t){return this._transport.getPageIndex(t)}getDestinations(){return this._transport.getDestinations()}getDestination(t){return this._transport.getDestination(t)}getPageLabels(){return this._transport.getPageLabels()}getPageLayout(){return this._transport.getPageLayout()}getPageMode(){return this._transport.getPageMode()}getViewerPreferences(){return this._transport.getViewerPreferences()}getOpenAction(){return this._transport.getOpenAction()}getAttachments(){return this._transport.getAttachments()}getJavaScript(){return this._transport.getJavaScript()}getJSActions(){return this._transport.getDocJSActions()}getOutline(){return this._transport.getOutline()}getOptionalContentConfig(){return this._transport.getOptionalContentConfig()}getPermissions(){return this._transport.getPermissions()}getMetadata(){return this._transport.getMetadata()}getMarkInfo(){return this._transport.getMarkInfo()}getData(){return this._transport.getData()}getDownloadInfo(){return this._transport.downloadInfoCapability.promise}cleanup(t=!1){return this._transport.startCleanup(t||this.isPureXfa)}destroy(){return this.loadingTask.destroy()}get loadingParams(){return this._transport.loadingParams}get loadingTask(){return this._transport.loadingTask}saveDocument(){return this._transport.annotationStorage.size<=0&&(0,_display_utils.deprecated)("saveDocument called while `annotationStorage` is empty, please use the getData-method instead."),this._transport.saveDocument()}getFieldObjects(){return this._transport.getFieldObjects()}hasJSActions(){return this._transport.hasJSActions()}getCalculationOrderIds(){return this._transport.getCalculationOrderIds()}}exports.PDFDocumentProxy=PDFDocumentProxy;class PDFPageProxy{constructor(t,o,c,x,b=!1){this._pageIndex=t,this._pageInfo=o,this._ownerDocument=x,this._transport=c,this._stats=b?new _display_utils.StatTimer:null,this._pdfBug=b,this.commonObjs=c.commonObjs,this.objs=new PDFObjects,this._bitmaps=new Set,this.cleanupAfterRender=!1,this.pendingCleanup=!1,this._intentStates=new Map,this._annotationPromises=new Map,this.destroyed=!1}get pageNumber(){return this._pageIndex+1}get rotate(){return this._pageInfo.rotate}get ref(){return this._pageInfo.ref}get userUnit(){return this._pageInfo.userUnit}get view(){return this._pageInfo.view}getViewport({scale:t,rotation:o=this.rotate,offsetX:c=0,offsetY:x=0,dontFlip:b=!1}={}){return new _display_utils.PageViewport({viewBox:this.view,scale:t,rotation:o,offsetX:c,offsetY:x,dontFlip:b})}getAnnotations({intent:t="display"}={}){const o=this._transport.getRenderingIntent(t);let c=this._annotationPromises.get(o.cacheKey);return c||(c=this._transport.getAnnotations(this._pageIndex,o.renderingIntent),this._annotationPromises.set(o.cacheKey,c),c=c.then(x=>{for(const b of x)b.titleObj!==void 0&&Object.defineProperty(b,"title",{get(){return(0,_display_utils.deprecated)("`title`-property on annotation, please use `titleObj` instead."),b.titleObj.str}}),b.contentsObj!==void 0&&Object.defineProperty(b,"contents",{get(){return(0,_display_utils.deprecated)("`contents`-property on annotation, please use `contentsObj` instead."),b.contentsObj.str}});return x})),c}getJSActions(){return this._jsActionsPromise||(this._jsActionsPromise=this._transport.getPageJSActions(this._pageIndex))}async getXfa(){var t;return((t=this._transport._htmlForXfa)==null?void 0:t.children[this._pageIndex])||null}render({canvasContext:t,viewport:o,intent:c="display",annotationMode:x=_util.AnnotationMode.ENABLE,transform:b=null,imageLayer:d=null,canvasFactory:i=null,background:l=null,optionalContentConfigPromise:n=null,annotationCanvasMap:E=null,pageColors:R=null,printAnnotationStorage:G=null}){var X,ne;((X=arguments[0])==null?void 0:X.renderInteractiveForms)!==void 0&&((0,_display_utils.deprecated)("render no longer accepts the `renderInteractiveForms`-option, please use the `annotationMode`-option instead."),arguments[0].renderInteractiveForms===!0&&x===_util.AnnotationMode.ENABLE&&(x=_util.AnnotationMode.ENABLE_FORMS)),((ne=arguments[0])==null?void 0:ne.includeAnnotationStorage)!==void 0&&((0,_display_utils.deprecated)("render no longer accepts the `includeAnnotationStorage`-option, please use the `annotationMode`-option instead."),arguments[0].includeAnnotationStorage===!0&&x===_util.AnnotationMode.ENABLE&&(x=_util.AnnotationMode.ENABLE_STORAGE)),this._stats&&this._stats.time("Overall");const q=this._transport.getRenderingIntent(c,x,G);this.pendingCleanup=!1,n||(n=this._transport.getOptionalContentConfig());let se=this._intentStates.get(q.cacheKey);se||(se=Object.create(null),this._intentStates.set(q.cacheKey,se)),se.streamReaderCancelTimeout&&(clearTimeout(se.streamReaderCancelTimeout),se.streamReaderCancelTimeout=null);const ae=i||new DefaultCanvasFactory({ownerDocument:this._ownerDocument}),Z=!!(q.renderingIntent&_util.RenderingIntentFlag.PRINT);se.displayReadyCapability||(se.displayReadyCapability=(0,_util.createPromiseCapability)(),se.operatorList={fnArray:[],argsArray:[],lastChunk:!1,separateAnnots:null},this._stats&&this._stats.time("Page Request"),this._pumpOperatorList(q));const Q=le=>{se.renderTasks.delete(z),(this.cleanupAfterRender||Z)&&(this.pendingCleanup=!0),this._tryCleanup(),le?(z.capability.reject(le),this._abortOperatorList({intentState:se,reason:le instanceof Error?le:new Error(le)})):z.capability.resolve(),this._stats&&(this._stats.timeEnd("Rendering"),this._stats.timeEnd("Overall"))},z=new InternalRenderTask({callback:Q,params:{canvasContext:t,viewport:o,transform:b,imageLayer:d,background:l},objs:this.objs,commonObjs:this.commonObjs,annotationCanvasMap:E,operatorList:se.operatorList,pageIndex:this._pageIndex,canvasFactory:ae,useRequestAnimationFrame:!Z,pdfBug:this._pdfBug,pageColors:R});(se.renderTasks||(se.renderTasks=new Set)).add(z);const V=z.task;return Promise.all([se.displayReadyCapability.promise,n]).then(([le,fe])=>{if(this.pendingCleanup){Q();return}this._stats&&this._stats.time("Rendering"),z.initializeGraphics({transparency:le,optionalContentConfig:fe}),z.operatorListChanged()}).catch(Q),V}getOperatorList({intent:t="display",annotationMode:o=_util.AnnotationMode.ENABLE,printAnnotationStorage:c=null}={}){function x(){d.operatorList.lastChunk&&(d.opListReadCapability.resolve(d.operatorList),d.renderTasks.delete(i))}const b=this._transport.getRenderingIntent(t,o,c,!0);let d=this._intentStates.get(b.cacheKey);d||(d=Object.create(null),this._intentStates.set(b.cacheKey,d));let i;return d.opListReadCapability||(i=Object.create(null),i.operatorListChanged=x,d.opListReadCapability=(0,_util.createPromiseCapability)(),(d.renderTasks||(d.renderTasks=new Set)).add(i),d.operatorList={fnArray:[],argsArray:[],lastChunk:!1,separateAnnots:null},this._stats&&this._stats.time("Page Request"),this._pumpOperatorList(b)),d.opListReadCapability.promise}streamTextContent({disableCombineTextItems:t=!1,includeMarkedContent:o=!1}={}){return this._transport.messageHandler.sendWithStream("GetTextContent",{pageIndex:this._pageIndex,combineTextItems:t!==!0,includeMarkedContent:o===!0},{highWaterMark:100,size(x){return x.items.length}})}getTextContent(t={}){if(this._transport._htmlForXfa)return this.getXfa().then(c=>_xfa_text.XfaText.textContent(c));const o=this.streamTextContent(t);return new Promise(function(c,x){function b(){d.read().then(function({value:l,done:n}){if(n){c(i);return}Object.assign(i.styles,l.styles),i.items.push(...l.items),b()},x)}const d=o.getReader(),i={items:[],styles:Object.create(null)};b()})}getStructTree(){return this._structTreePromise||(this._structTreePromise=this._transport.getStructTree(this._pageIndex))}_destroy(){this.destroyed=!0;const t=[];for(const o of this._intentStates.values())if(this._abortOperatorList({intentState:o,reason:new Error("Page was destroyed."),force:!0}),!o.opListReadCapability)for(const c of o.renderTasks)t.push(c.completed),c.cancel();this.objs.clear();for(const o of this._bitmaps)o.close();return this._bitmaps.clear(),this._annotationPromises.clear(),this._jsActionsPromise=null,this._structTreePromise=null,this.pendingCleanup=!1,Promise.all(t)}cleanup(t=!1){return this.pendingCleanup=!0,this._tryCleanup(t)}_tryCleanup(t=!1){if(!this.pendingCleanup)return!1;for(const{renderTasks:o,operatorList:c}of this._intentStates.values())if(o.size>0||!c.lastChunk)return!1;this._intentStates.clear(),this.objs.clear(),this._annotationPromises.clear(),this._jsActionsPromise=null,this._structTreePromise=null,t&&this._stats&&(this._stats=new _display_utils.StatTimer);for(const o of this._bitmaps)o.close();return this._bitmaps.clear(),this.pendingCleanup=!1,!0}_startRenderPage(t,o){const c=this._intentStates.get(o);c&&(this._stats&&this._stats.timeEnd("Page Request"),c.displayReadyCapability&&c.displayReadyCapability.resolve(t))}_renderPageChunk(t,o){for(let c=0,x=t.length;c<x;c++)o.operatorList.fnArray.push(t.fnArray[c]),o.operatorList.argsArray.push(t.argsArray[c]);o.operatorList.lastChunk=t.lastChunk,o.operatorList.separateAnnots=t.separateAnnots;for(const c of o.renderTasks)c.operatorListChanged();t.lastChunk&&this._tryCleanup()}_pumpOperatorList({renderingIntent:t,cacheKey:o,annotationStorageMap:c}){const b=this._transport.messageHandler.sendWithStream("GetOperatorList",{pageIndex:this._pageIndex,intent:t,cacheKey:o,annotationStorage:c}).getReader(),d=this._intentStates.get(o);d.streamReader=b;const i=()=>{b.read().then(({value:l,done:n})=>{if(n){d.streamReader=null;return}this._transport.destroyed||(this._renderPageChunk(l,d),i())},l=>{if(d.streamReader=null,!this._transport.destroyed){if(d.operatorList){d.operatorList.lastChunk=!0;for(const n of d.renderTasks)n.operatorListChanged();this._tryCleanup()}if(d.displayReadyCapability)d.displayReadyCapability.reject(l);else if(d.opListReadCapability)d.opListReadCapability.reject(l);else throw l}})};i()}_abortOperatorList({intentState:t,reason:o,force:c=!1}){if(t.streamReader){if(!c){if(t.renderTasks.size>0)return;if(o instanceof _display_utils.RenderingCancelledException){t.streamReaderCancelTimeout=setTimeout(()=>{this._abortOperatorList({intentState:t,reason:o,force:!0}),t.streamReaderCancelTimeout=null},RENDERING_CANCELLED_TIMEOUT);return}}if(t.streamReader.cancel(new _util.AbortException(o.message)).catch(()=>{}),t.streamReader=null,!this._transport.destroyed){for(const[x,b]of this._intentStates)if(b===t){this._intentStates.delete(x);break}this.cleanup()}}}get stats(){return this._stats}}exports.PDFPageProxy=PDFPageProxy;class LoopbackPort{constructor(){this._listeners=[],this._deferred=Promise.resolve()}postMessage(t,o){const c={data:structuredClone(t,o)};this._deferred.then(()=>{for(const x of this._listeners)x.call(this,c)})}addEventListener(t,o){this._listeners.push(o)}removeEventListener(t,o){const c=this._listeners.indexOf(o);this._listeners.splice(c,1)}terminate(){this._listeners.length=0}}exports.LoopbackPort=LoopbackPort;const PDFWorkerUtil={isWorkerDisabled:!1,fallbackWorkerSrc:null,fakeWorkerId:0};exports.PDFWorkerUtil=PDFWorkerUtil;{if(_is_node.isNodeJS&&typeof commonjsRequire=="function")PDFWorkerUtil.isWorkerDisabled=!0,PDFWorkerUtil.fallbackWorkerSrc="./pdf.worker.js";else if(typeof document=="object"){const h=(y=document==null?void 0:document.currentScript)==null?void 0:y.src;h&&(PDFWorkerUtil.fallbackWorkerSrc=h.replace(/(\.(?:min\.)?js)(\?.*)?$/i,".worker$1$2"))}PDFWorkerUtil.isSameOrigin=function(h,t){let o;try{if(o=new URL(h),!o.origin||o.origin==="null")return!1}catch{return!1}const c=new URL(t,o);return o.origin===c.origin},PDFWorkerUtil.createCDNWrapper=function(h){const t=`importScripts("${h}");`;return URL.createObjectURL(new Blob([t]))}}const _PDFWorker=class _PDFWorker{constructor({name:h=null,port:t=null,verbosity:o=(0,_util.getVerbosityLevel)()}={}){if(t&&I(_PDFWorker,e).has(t))throw new Error("Cannot use more than one PDFWorker per port.");if(this.name=h,this.destroyed=!1,this.verbosity=o,this._readyCapability=(0,_util.createPromiseCapability)(),this._port=null,this._webWorker=null,this._messageHandler=null,t){I(_PDFWorker,e).set(t,this),this._initializeFromPort(t);return}this._initialize()}get promise(){return this._readyCapability.promise}get port(){return this._port}get messageHandler(){return this._messageHandler}_initializeFromPort(h){this._port=h,this._messageHandler=new _message_handler.MessageHandler("main","worker",h),this._messageHandler.on("ready",function(){}),this._readyCapability.resolve()}_initialize(){if(!PDFWorkerUtil.isWorkerDisabled&&!_PDFWorker._mainThreadWorkerMessageHandler){let{workerSrc:h}=_PDFWorker;try{PDFWorkerUtil.isSameOrigin(window.location.href,h)||(h=PDFWorkerUtil.createCDNWrapper(new URL(h,window.location).href));const t=new Worker(h),o=new _message_handler.MessageHandler("main","worker",t),c=()=>{t.removeEventListener("error",x),o.destroy(),t.terminate(),this.destroyed?this._readyCapability.reject(new Error("Worker was destroyed")):this._setupFakeWorker()},x=()=>{this._webWorker||c()};t.addEventListener("error",x),o.on("test",d=>{if(t.removeEventListener("error",x),this.destroyed){c();return}d?(this._messageHandler=o,this._port=t,this._webWorker=t,this._readyCapability.resolve(),o.send("configure",{verbosity:this.verbosity})):(this._setupFakeWorker(),o.destroy(),t.terminate())}),o.on("ready",d=>{if(t.removeEventListener("error",x),this.destroyed){c();return}try{b()}catch{this._setupFakeWorker()}});const b=()=>{const d=new Uint8Array;o.send("test",d,[d.buffer])};b();return}catch{(0,_util.info)("The worker has been disabled.")}}this._setupFakeWorker()}_setupFakeWorker(){PDFWorkerUtil.isWorkerDisabled||((0,_util.warn)("Setting up fake worker."),PDFWorkerUtil.isWorkerDisabled=!0),_PDFWorker._setupFakeWorkerGlobal.then(h=>{if(this.destroyed){this._readyCapability.reject(new Error("Worker was destroyed"));return}const t=new LoopbackPort;this._port=t;const o=`fake${PDFWorkerUtil.fakeWorkerId++}`,c=new _message_handler.MessageHandler(o+"_worker",o,t);h.setup(c,t);const x=new _message_handler.MessageHandler(o,o+"_worker",t);this._messageHandler=x,this._readyCapability.resolve(),x.send("configure",{verbosity:this.verbosity})}).catch(h=>{this._readyCapability.reject(new Error(`Setting up fake worker failed: "${h.message}".`))})}destroy(){this.destroyed=!0,this._webWorker&&(this._webWorker.terminate(),this._webWorker=null),I(_PDFWorker,e).delete(this._port),this._port=null,this._messageHandler&&(this._messageHandler.destroy(),this._messageHandler=null)}static fromPort(h){if(!(h!=null&&h.port))throw new Error("PDFWorker.fromPort - invalid method signature.");return I(this,e).has(h.port)?I(this,e).get(h.port):new _PDFWorker(h)}static get workerSrc(){if(_worker_options.GlobalWorkerOptions.workerSrc)return _worker_options.GlobalWorkerOptions.workerSrc;if(PDFWorkerUtil.fallbackWorkerSrc!==null)return _is_node.isNodeJS||(0,_display_utils.deprecated)('No "GlobalWorkerOptions.workerSrc" specified.'),PDFWorkerUtil.fallbackWorkerSrc;throw new Error('No "GlobalWorkerOptions.workerSrc" specified.')}static get _mainThreadWorkerMessageHandler(){var h;try{return((h=globalThis.pdfjsWorker)==null?void 0:h.WorkerMessageHandler)||null}catch{return null}}static get _setupFakeWorkerGlobal(){const loader=async()=>{const mainWorkerMessageHandler=this._mainThreadWorkerMessageHandler;if(mainWorkerMessageHandler)return mainWorkerMessageHandler;if(_is_node.isNodeJS&&typeof commonjsRequire=="function"){const worker=eval("require")(this.workerSrc);return worker.WorkerMessageHandler}return await(0,_display_utils.loadScript)(this.workerSrc),window.pdfjsWorker.WorkerMessageHandler};return(0,_util.shadow)(this,"_setupFakeWorkerGlobal",loader())}};e=new WeakMap,ue(_PDFWorker,e,new WeakMap);let PDFWorker=_PDFWorker;exports.PDFWorker=PDFWorker,PDFWorker.getWorkerSrc=function(){return(0,_display_utils.deprecated)("`PDFWorker.getWorkerSrc()`, please use `PDFWorker.workerSrc` instead."),this.workerSrc};class WorkerTransport{constructor(t,o,c,x){ue(this,a,null);ue(this,k,new Map);ue(this,O,new Map);ue(this,S,null);this.messageHandler=t,this.loadingTask=o,this.commonObjs=new PDFObjects,this.fontLoader=new _font_loader.FontLoader({docId:o.docId,onUnsupportedFeature:this._onUnsupportedFeature.bind(this),ownerDocument:x.ownerDocument,styleElement:x.styleElement}),this._params=x,x.useWorkerFetch||(this.CMapReaderFactory=new x.CMapReaderFactory({baseUrl:x.cMapUrl,isCompressed:x.cMapPacked}),this.StandardFontDataFactory=new x.StandardFontDataFactory({baseUrl:x.standardFontDataUrl})),this.destroyed=!1,this.destroyCapability=null,this._passwordCapability=null,this._networkStream=c,this._fullReader=null,this._lastProgress=null,this.downloadInfoCapability=(0,_util.createPromiseCapability)(),this.setupMessageHandler()}get annotationStorage(){return(0,_util.shadow)(this,"annotationStorage",new _annotation_storage.AnnotationStorage)}get stats(){return I(this,a)}getRenderingIntent(t,o=_util.AnnotationMode.ENABLE,c=null,x=!1){let b=_util.RenderingIntentFlag.DISPLAY,d=null;switch(t){case"any":b=_util.RenderingIntentFlag.ANY;break;case"display":break;case"print":b=_util.RenderingIntentFlag.PRINT;break;default:(0,_util.warn)(`getRenderingIntent - invalid intent: ${t}`)}switch(o){case _util.AnnotationMode.DISABLE:b+=_util.RenderingIntentFlag.ANNOTATIONS_DISABLE;break;case _util.AnnotationMode.ENABLE:break;case _util.AnnotationMode.ENABLE_FORMS:b+=_util.RenderingIntentFlag.ANNOTATIONS_FORMS;break;case _util.AnnotationMode.ENABLE_STORAGE:b+=_util.RenderingIntentFlag.ANNOTATIONS_STORAGE,d=(b&_util.RenderingIntentFlag.PRINT&&c instanceof _annotation_storage.PrintAnnotationStorage?c:this.annotationStorage).serializable;break;default:(0,_util.warn)(`getRenderingIntent - invalid annotationMode: ${o}`)}return x&&(b+=_util.RenderingIntentFlag.OPLIST),{renderingIntent:b,cacheKey:`${b}_${_annotation_storage.AnnotationStorage.getHash(d)}`,annotationStorageMap:d}}destroy(){if(this.destroyCapability)return this.destroyCapability.promise;this.destroyed=!0,this.destroyCapability=(0,_util.createPromiseCapability)(),this._passwordCapability&&this._passwordCapability.reject(new Error("Worker was destroyed during onPassword callback"));const t=[];for(const c of I(this,k).values())t.push(c._destroy());I(this,k).clear(),I(this,O).clear(),this.hasOwnProperty("annotationStorage")&&this.annotationStorage.resetModified();const o=this.messageHandler.sendWithPromise("Terminate",null);return t.push(o),Promise.all(t).then(()=>{this.commonObjs.clear(),this.fontLoader.clear(),he(this,S,null),this._getFieldObjectsPromise=null,this._hasJSActionsPromise=null,this._networkStream&&this._networkStream.cancelAllRequests(new _util.AbortException("Worker was terminated.")),this.messageHandler&&(this.messageHandler.destroy(),this.messageHandler=null),this.destroyCapability.resolve()},this.destroyCapability.reject),this.destroyCapability.promise}setupMessageHandler(){const{messageHandler:t,loadingTask:o}=this;t.on("GetReader",(c,x)=>{(0,_util.assert)(this._networkStream,"GetReader - no `IPDFStream` instance available."),this._fullReader=this._networkStream.getFullReader(),this._fullReader.onProgress=b=>{this._lastProgress={loaded:b.loaded,total:b.total}},x.onPull=()=>{this._fullReader.read().then(function({value:b,done:d}){if(d){x.close();return}(0,_util.assert)((0,_util.isArrayBuffer)(b),"GetReader - expected an ArrayBuffer."),x.enqueue(new Uint8Array(b),1,[b])}).catch(b=>{x.error(b)})},x.onCancel=b=>{this._fullReader.cancel(b),x.ready.catch(d=>{if(!this.destroyed)throw d})}}),t.on("ReaderHeadersReady",c=>{const x=(0,_util.createPromiseCapability)(),b=this._fullReader;return b.headersReady.then(()=>{var d;(!b.isStreamingSupported||!b.isRangeSupported)&&(this._lastProgress&&((d=o.onProgress)==null||d.call(o,this._lastProgress)),b.onProgress=i=>{var l;(l=o.onProgress)==null||l.call(o,{loaded:i.loaded,total:i.total})}),x.resolve({isStreamingSupported:b.isStreamingSupported,isRangeSupported:b.isRangeSupported,contentLength:b.contentLength})},x.reject),x.promise}),t.on("GetRangeReader",(c,x)=>{(0,_util.assert)(this._networkStream,"GetRangeReader - no `IPDFStream` instance available.");const b=this._networkStream.getRangeReader(c.begin,c.end);if(!b){x.close();return}x.onPull=()=>{b.read().then(function({value:d,done:i}){if(i){x.close();return}(0,_util.assert)((0,_util.isArrayBuffer)(d),"GetRangeReader - expected an ArrayBuffer."),x.enqueue(new Uint8Array(d),1,[d])}).catch(d=>{x.error(d)})},x.onCancel=d=>{b.cancel(d),x.ready.catch(i=>{if(!this.destroyed)throw i})}}),t.on("GetDoc",({pdfInfo:c})=>{this._numPages=c.numPages,this._htmlForXfa=c.htmlForXfa,delete c.htmlForXfa,o._capability.resolve(new PDFDocumentProxy(c,this))}),t.on("DocException",function(c){let x;switch(c.name){case"PasswordException":x=new _util.PasswordException(c.message,c.code);break;case"InvalidPDFException":x=new _util.InvalidPDFException(c.message);break;case"MissingPDFException":x=new _util.MissingPDFException(c.message);break;case"UnexpectedResponseException":x=new _util.UnexpectedResponseException(c.message,c.status);break;case"UnknownErrorException":x=new _util.UnknownErrorException(c.message,c.details);break;default:(0,_util.unreachable)("DocException - expected a valid Error.")}o._capability.reject(x)}),t.on("PasswordRequest",c=>{if(this._passwordCapability=(0,_util.createPromiseCapability)(),o.onPassword){const x=b=>{b instanceof Error?this._passwordCapability.reject(b):this._passwordCapability.resolve({password:b})};try{o.onPassword(x,c.code)}catch(b){this._passwordCapability.reject(b)}}else this._passwordCapability.reject(new _util.PasswordException(c.message,c.code));return this._passwordCapability.promise}),t.on("DataLoaded",c=>{var x;(x=o.onProgress)==null||x.call(o,{loaded:c.length,total:c.length}),this.downloadInfoCapability.resolve(c)}),t.on("StartRenderPage",c=>{if(this.destroyed)return;I(this,k).get(c.pageIndex)._startRenderPage(c.transparency,c.cacheKey)}),t.on("commonobj",([c,x,b])=>{var d;if(!this.destroyed&&!this.commonObjs.has(c))switch(x){case"Font":const i=this._params;if("error"in b){const E=b.error;(0,_util.warn)(`Error during font loading: ${E}`),this.commonObjs.resolve(c,E);break}let l=null;i.pdfBug&&((d=globalThis.FontInspector)!=null&&d.enabled)&&(l={registerFont(E,R){globalThis.FontInspector.fontAdded(E,R)}});const n=new _font_loader.FontFaceObject(b,{isEvalSupported:i.isEvalSupported,disableFontFace:i.disableFontFace,ignoreErrors:i.ignoreErrors,onUnsupportedFeature:this._onUnsupportedFeature.bind(this),fontRegistry:l});this.fontLoader.bind(n).catch(E=>t.sendWithPromise("FontFallback",{id:c})).finally(()=>{!i.fontExtraProperties&&n.data&&(n.data=null),this.commonObjs.resolve(c,n)});break;case"FontPath":case"Image":this.commonObjs.resolve(c,b);break;default:throw new Error(`Got unknown common object type ${x}`)}}),t.on("obj",([c,x,b,d])=>{var l;if(this.destroyed)return;const i=I(this,k).get(x);if(!i.objs.has(c))switch(b){case"Image":i.objs.resolve(c,d);const n=8e6;if(d){let E;if(d.bitmap){const{bitmap:R,width:G,height:q}=d;E=G*q*4,i._bitmaps.add(R)}else E=((l=d.data)==null?void 0:l.length)||0;E>n&&(i.cleanupAfterRender=!0)}break;case"Pattern":i.objs.resolve(c,d);break;default:throw new Error(`Got unknown object type ${b}`)}}),t.on("DocProgress",c=>{var x;this.destroyed||(x=o.onProgress)==null||x.call(o,{loaded:c.loaded,total:c.total})}),t.on("DocStats",c=>{this.destroyed||he(this,a,Object.freeze({streamTypes:Object.freeze(c.streamTypes),fontTypes:Object.freeze(c.fontTypes)}))}),t.on("UnsupportedFeature",this._onUnsupportedFeature.bind(this)),t.on("FetchBuiltInCMap",c=>this.destroyed?Promise.reject(new Error("Worker was destroyed.")):this.CMapReaderFactory?this.CMapReaderFactory.fetch(c):Promise.reject(new Error("CMapReaderFactory not initialized, see the `useWorkerFetch` parameter."))),t.on("FetchStandardFontData",c=>this.destroyed?Promise.reject(new Error("Worker was destroyed.")):this.StandardFontDataFactory?this.StandardFontDataFactory.fetch(c):Promise.reject(new Error("StandardFontDataFactory not initialized, see the `useWorkerFetch` parameter.")))}_onUnsupportedFeature({featureId:t}){var o,c;this.destroyed||(c=(o=this.loadingTask).onUnsupportedFeature)==null||c.call(o,t)}getData(){return this.messageHandler.sendWithPromise("GetData",null)}getPage(t){if(!Number.isInteger(t)||t<=0||t>this._numPages)return Promise.reject(new Error("Invalid page request."));const o=t-1,c=I(this,O).get(o);if(c)return c;const x=this.messageHandler.sendWithPromise("GetPage",{pageIndex:o}).then(b=>{if(this.destroyed)throw new Error("Transport destroyed");const d=new PDFPageProxy(o,b,this,this._params.ownerDocument,this._params.pdfBug);return I(this,k).set(o,d),d});return I(this,O).set(o,x),x}getPageIndex(t){return typeof t!="object"||t===null||!Number.isInteger(t.num)||t.num<0||!Number.isInteger(t.gen)||t.gen<0?Promise.reject(new Error("Invalid pageIndex request.")):this.messageHandler.sendWithPromise("GetPageIndex",{num:t.num,gen:t.gen})}getAnnotations(t,o){return this.messageHandler.sendWithPromise("GetAnnotations",{pageIndex:t,intent:o})}saveDocument(){var t;return this.messageHandler.sendWithPromise("SaveDocument",{isPureXfa:!!this._htmlForXfa,numPages:this._numPages,annotationStorage:this.annotationStorage.serializable,filename:((t=this._fullReader)==null?void 0:t.filename)??null}).finally(()=>{this.annotationStorage.resetModified()})}getFieldObjects(){return this._getFieldObjectsPromise||(this._getFieldObjectsPromise=this.messageHandler.sendWithPromise("GetFieldObjects",null))}hasJSActions(){return this._hasJSActionsPromise||(this._hasJSActionsPromise=this.messageHandler.sendWithPromise("HasJSActions",null))}getCalculationOrderIds(){return this.messageHandler.sendWithPromise("GetCalculationOrderIds",null)}getDestinations(){return this.messageHandler.sendWithPromise("GetDestinations",null)}getDestination(t){return typeof t!="string"?Promise.reject(new Error("Invalid destination request.")):this.messageHandler.sendWithPromise("GetDestination",{id:t})}getPageLabels(){return this.messageHandler.sendWithPromise("GetPageLabels",null)}getPageLayout(){return this.messageHandler.sendWithPromise("GetPageLayout",null)}getPageMode(){return this.messageHandler.sendWithPromise("GetPageMode",null)}getViewerPreferences(){return this.messageHandler.sendWithPromise("GetViewerPreferences",null)}getOpenAction(){return this.messageHandler.sendWithPromise("GetOpenAction",null)}getAttachments(){return this.messageHandler.sendWithPromise("GetAttachments",null)}getJavaScript(){return this.messageHandler.sendWithPromise("GetJavaScript",null)}getDocJSActions(){return this.messageHandler.sendWithPromise("GetDocJSActions",null)}getPageJSActions(t){return this.messageHandler.sendWithPromise("GetPageJSActions",{pageIndex:t})}getStructTree(t){return this.messageHandler.sendWithPromise("GetStructTree",{pageIndex:t})}getOutline(){return this.messageHandler.sendWithPromise("GetOutline",null)}getOptionalContentConfig(){return this.messageHandler.sendWithPromise("GetOptionalContentConfig",null).then(t=>new _optional_content_config.OptionalContentConfig(t))}getPermissions(){return this.messageHandler.sendWithPromise("GetPermissions",null)}getMetadata(){return I(this,S)||he(this,S,this.messageHandler.sendWithPromise("GetMetadata",null).then(t=>{var o,c;return{info:t[0],metadata:t[1]?new _metadata.Metadata(t[1]):null,contentDispositionFilename:((o=this._fullReader)==null?void 0:o.filename)??null,contentLength:((c=this._fullReader)==null?void 0:c.contentLength)??null}}))}getMarkInfo(){return this.messageHandler.sendWithPromise("GetMarkInfo",null)}async startCleanup(t=!1){if(await this.messageHandler.sendWithPromise("Cleanup",null),!this.destroyed){for(const o of I(this,k).values())if(!o.cleanup())throw new Error(`startCleanup: Page ${o.pageNumber} is currently rendering.`);this.commonObjs.clear(),t||this.fontLoader.clear(),he(this,S,null),this._getFieldObjectsPromise=null,this._hasJSActionsPromise=null}}get loadingParams(){const t=this._params;return(0,_util.shadow)(this,"loadingParams",{disableAutoFetch:t.disableAutoFetch,enableXfa:t.enableXfa})}}a=new WeakMap,k=new WeakMap,O=new WeakMap,S=new WeakMap;class PDFObjects{constructor(){ue(this,f);ue(this,_,Object.create(null))}get(t,o=null){if(o){const x=ce(this,f,ot).call(this,t);return x.capability.promise.then(()=>o(x.data)),null}const c=I(this,_)[t];if(!(c!=null&&c.capability.settled))throw new Error(`Requesting object that isn't resolved yet ${t}.`);return c.data}has(t){const o=I(this,_)[t];return(o==null?void 0:o.capability.settled)||!1}resolve(t,o=null){const c=ce(this,f,ot).call(this,t);c.data=o,c.capability.resolve()}clear(){he(this,_,Object.create(null))}}_=new WeakMap,f=new WeakSet,ot=function(t){const o=I(this,_)[t];return o||(I(this,_)[t]={capability:(0,_util.createPromiseCapability)(),data:null})};class RenderTask{constructor(t){ue(this,L,null);he(this,L,t),this.onContinue=null}get promise(){return I(this,L).capability.promise}cancel(){I(this,L).cancel()}get separateAnnots(){const{separateAnnots:t}=I(this,L).operatorList;if(!t)return!1;const{annotationCanvasMap:o}=I(this,L);return t.form||t.canvas&&(o==null?void 0:o.size)>0}}L=new WeakMap,exports.RenderTask=RenderTask;const T=class T{constructor({callback:t,params:o,objs:c,commonObjs:x,annotationCanvasMap:b,operatorList:d,pageIndex:i,canvasFactory:l,useRequestAnimationFrame:n=!1,pdfBug:E=!1,pageColors:R=null}){this.callback=t,this.params=o,this.objs=c,this.commonObjs=x,this.annotationCanvasMap=b,this.operatorListIdx=null,this.operatorList=d,this._pageIndex=i,this.canvasFactory=l,this._pdfBug=E,this.pageColors=R,this.running=!1,this.graphicsReadyCallback=null,this.graphicsReady=!1,this._useRequestAnimationFrame=n===!0&&typeof window<"u",this.cancelled=!1,this.capability=(0,_util.createPromiseCapability)(),this.task=new RenderTask(this),this._cancelBound=this.cancel.bind(this),this._continueBound=this._continue.bind(this),this._scheduleNextBound=this._scheduleNext.bind(this),this._nextBound=this._next.bind(this),this._canvas=o.canvasContext.canvas}get completed(){return this.capability.promise.catch(function(){})}initializeGraphics({transparency:t=!1,optionalContentConfig:o}){var l;if(this.cancelled)return;if(this._canvas){if(I(T,w).has(this._canvas))throw new Error("Cannot use the same canvas during multiple render() operations. Use different canvas or ensure previous operations were cancelled or completed.");I(T,w).add(this._canvas)}this._pdfBug&&((l=globalThis.StepperManager)!=null&&l.enabled)&&(this.stepper=globalThis.StepperManager.create(this._pageIndex),this.stepper.init(this.operatorList),this.stepper.nextBreakPoint=this.stepper.getNextBreakPoint());const{canvasContext:c,viewport:x,transform:b,imageLayer:d,background:i}=this.params;this.gfx=new _canvas.CanvasGraphics(c,this.commonObjs,this.objs,this.canvasFactory,d,o,this.annotationCanvasMap,this.pageColors),this.gfx.beginDrawing({transform:b,viewport:x,transparency:t,background:i}),this.operatorListIdx=0,this.graphicsReady=!0,this.graphicsReadyCallback&&this.graphicsReadyCallback()}cancel(t=null){this.running=!1,this.cancelled=!0,this.gfx&&this.gfx.endDrawing(),this._canvas&&I(T,w).delete(this._canvas),this.callback(t||new _display_utils.RenderingCancelledException(`Rendering cancelled, page ${this._pageIndex+1}`,"canvas"))}operatorListChanged(){if(!this.graphicsReady){this.graphicsReadyCallback||(this.graphicsReadyCallback=this._continueBound);return}this.stepper&&this.stepper.updateOperatorList(this.operatorList),!this.running&&this._continue()}_continue(){this.running=!0,!this.cancelled&&(this.task.onContinue?this.task.onContinue(this._scheduleNextBound):this._scheduleNext())}_scheduleNext(){this._useRequestAnimationFrame?window.requestAnimationFrame(()=>{this._nextBound().catch(this._cancelBound)}):Promise.resolve().then(this._nextBound).catch(this._cancelBound)}async _next(){this.cancelled||(this.operatorListIdx=this.gfx.executeOperatorList(this.operatorList,this.operatorListIdx,this._continueBound,this.stepper),this.operatorListIdx===this.operatorList.argsArray.length&&(this.running=!1,this.operatorList.lastChunk&&(this.gfx.endDrawing(),this._canvas&&I(T,w).delete(this._canvas),this.callback())))}};w=new WeakMap,ue(T,w,new WeakSet);let InternalRenderTask=T;const version="2.16.105";exports.version=version;const build="172ccdbe5";exports.build=build},(A,r,y)=>{var _,Tt,C;Object.defineProperty(r,"__esModule",{value:!0}),r.PrintAnnotationStorage=r.AnnotationStorage=void 0;var e=y(1),a=y(6),k=y(10);class O{constructor(){ue(this,_);this._storage=new Map,this._modified=!1,this.onSetModified=null,this.onResetModified=null,this.onAnnotationEditor=null}getValue(w,T){const h=this._storage.get(w);return h===void 0?T:Object.assign(T,h)}getRawValue(w){return this._storage.get(w)}remove(w){if(this._storage.delete(w),this._storage.size===0&&this.resetModified(),typeof this.onAnnotationEditor=="function"){for(const T of this._storage.values())if(T instanceof a.AnnotationEditor)return;this.onAnnotationEditor(null)}}setValue(w,T){const h=this._storage.get(w);let t=!1;if(h!==void 0)for(const[o,c]of Object.entries(T))h[o]!==c&&(t=!0,h[o]=c);else t=!0,this._storage.set(w,T);t&&ce(this,_,Tt).call(this),T instanceof a.AnnotationEditor&&typeof this.onAnnotationEditor=="function"&&this.onAnnotationEditor(T.constructor._type)}has(w){return this._storage.has(w)}getAll(){return this._storage.size>0?(0,e.objectFromMap)(this._storage):null}get size(){return this._storage.size}resetModified(){this._modified&&(this._modified=!1,typeof this.onResetModified=="function"&&this.onResetModified())}get print(){return new S(this)}get serializable(){if(this._storage.size===0)return null;const w=new Map;for(const[T,h]of this._storage){const t=h instanceof a.AnnotationEditor?h.serialize():h;t&&w.set(T,t)}return w}static getHash(w){if(!w)return"";const T=new k.MurmurHash3_64;for(const[h,t]of w)T.update(`${h}:${JSON.stringify(t)}`);return T.hexdigest()}}_=new WeakSet,Tt=function(){this._modified||(this._modified=!0,typeof this.onSetModified=="function"&&this.onSetModified())},r.AnnotationStorage=O;class S extends O{constructor(T){super();ue(this,C,null);he(this,C,structuredClone(T.serializable))}get print(){(0,e.unreachable)("Should not call PrintAnnotationStorage.print")}get serializable(){return I(this,C)}}C=new WeakMap,r.PrintAnnotationStorage=S},(A,r,y)=>{var O,S,_,f,C,L;Object.defineProperty(r,"__esModule",{value:!0}),r.AnnotationEditor=void 0;var e=y(7),a=y(1);const w=class w{constructor(h){ue(this,O,this.focusin.bind(this));ue(this,S,this.focusout.bind(this));ue(this,_,!1);ue(this,f,!1);ue(this,C,!1);ue(this,L,w._zIndex++);this.constructor===w&&(0,a.unreachable)("Cannot initialize AnnotationEditor."),this.parent=h.parent,this.id=h.id,this.width=this.height=null,this.pageIndex=h.parent.pageIndex,this.name=h.name,this.div=null;const[t,o]=this.parent.viewportBaseDimensions;this.x=h.x/t,this.y=h.y/o,this.rotation=this.parent.viewport.rotation,this.isAttachedToDOM=!1}static get _defaultLineColor(){return(0,a.shadow)(this,"_defaultLineColor",this._colorManager.getHexCode("CanvasText"))}setInBackground(){this.div.style.zIndex=0}setInForeground(){this.div.style.zIndex=I(this,L)}focusin(h){I(this,_)?he(this,_,!1):this.parent.setSelected(this)}focusout(h){if(!this.isAttachedToDOM)return;const t=h.relatedTarget;t!=null&&t.closest(`#${this.id}`)||(h.preventDefault(),this.parent.isMultipleSelection||this.commitOrRemove())}commitOrRemove(){this.isEmpty()?this.remove():this.commit()}commit(){this.parent.addToAnnotationStorage(this)}dragstart(h){const t=this.parent.div.getBoundingClientRect();this.startX=h.clientX-t.x,this.startY=h.clientY-t.y,h.dataTransfer.setData("text/plain",this.id),h.dataTransfer.effectAllowed="move"}setAt(h,t,o,c){const[x,b]=this.parent.viewportBaseDimensions;[o,c]=this.screenToPageTranslation(o,c),this.x=(h+o)/x,this.y=(t+c)/b,this.div.style.left=`${100*this.x}%`,this.div.style.top=`${100*this.y}%`}translate(h,t){const[o,c]=this.parent.viewportBaseDimensions;[h,t]=this.screenToPageTranslation(h,t),this.x+=h/o,this.y+=t/c,this.div.style.left=`${100*this.x}%`,this.div.style.top=`${100*this.y}%`}screenToPageTranslation(h,t){const{rotation:o}=this.parent.viewport;switch(o){case 90:return[t,-h];case 180:return[-h,-t];case 270:return[-t,h];default:return[h,t]}}setDims(h,t){const[o,c]=this.parent.viewportBaseDimensions;this.div.style.width=`${100*h/o}%`,this.div.style.height=`${100*t/c}%`}getInitialTranslation(){return[0,0]}render(){this.div=document.createElement("div"),this.div.setAttribute("data-editor-rotation",(360-this.rotation)%360),this.div.className=this.name,this.div.setAttribute("id",this.id),this.div.setAttribute("tabIndex",0),this.setInForeground(),this.div.addEventListener("focusin",I(this,O)),this.div.addEventListener("focusout",I(this,S));const[h,t]=this.getInitialTranslation();return this.translate(h,t),(0,e.bindEvents)(this,this.div,["dragstart","pointerdown"]),this.div}pointerdown(h){const t=e.KeyboardManager.platform.isMac;if(h.button!==0||h.ctrlKey&&t){h.preventDefault();return}h.ctrlKey&&!t||h.shiftKey||h.metaKey&&t?this.parent.toggleSelected(this):this.parent.setSelected(this),he(this,_,!0)}getRect(h,t){const[o,c]=this.parent.viewportBaseDimensions,[x,b]=this.parent.pageDimensions,d=x*h/o,i=b*t/c,l=this.x*x,n=this.y*b,E=this.width*x,R=this.height*b;switch(this.rotation){case 0:return[l+d,b-n-i-R,l+d+E,b-n-i];case 90:return[l+i,b-n+d,l+i+R,b-n+d+E];case 180:return[l-d-E,b-n+i,l-d,b-n+i+R];case 270:return[l-i-R,b-n-d-E,l-i,b-n-d];default:throw new Error("Invalid rotation")}}getRectInCurrentCoords(h,t){const[o,c,x,b]=h,d=x-o,i=b-c;switch(this.rotation){case 0:return[o,t-b,d,i];case 90:return[o,t-c,i,d];case 180:return[x,t-c,d,i];case 270:return[x,t-b,i,d];default:throw new Error("Invalid rotation")}}onceAdded(){}isEmpty(){return!1}enableEditMode(){he(this,C,!0)}disableEditMode(){he(this,C,!1)}isInEditMode(){return I(this,C)}shouldGetKeyboardEvents(){return!1}needsToBeRebuilt(){return this.div&&!this.isAttachedToDOM}rebuild(){var h;(h=this.div)==null||h.addEventListener("focusin",I(this,O))}serialize(){(0,a.unreachable)("An editor must be serializable")}static deserialize(h,t){const o=new this.prototype.constructor({parent:t,id:t.getNextId()});o.rotation=h.rotation;const[c,x]=t.pageDimensions,[b,d,i,l]=o.getRectInCurrentCoords(h.rect,x);return o.x=b/c,o.y=d/x,o.width=i/c,o.height=l/x,o}remove(){this.div.removeEventListener("focusin",I(this,O)),this.div.removeEventListener("focusout",I(this,S)),this.isEmpty()||this.commit(),this.parent.remove(this)}select(){var h;(h=this.div)==null||h.classList.add("selectedEditor")}unselect(){var h;(h=this.div)==null||h.classList.remove("selectedEditor")}updateParams(h,t){}disableEditing(){}enableEditing(){}get propertiesToUpdate(){return{}}get contentDiv(){return this.div}get isEditing(){return I(this,f)}set isEditing(h){he(this,f,h),h?(this.parent.setSelected(this),this.parent.setActiveEditor(this)):this.parent.setActiveEditor(null)}};O=new WeakMap,S=new WeakMap,_=new WeakMap,f=new WeakMap,C=new WeakMap,L=new WeakMap,we(w,"_colorManager",new e.ColorManager),we(w,"_zIndex",1);let k=w;r.AnnotationEditor=k},(A,r,y)=>{var T,h,t,o,c,x,xt,i,n,E,R,G,q,se,ae,Z,Q,z,V,X,ne,le,fe,$,p,u,Ct,lt,Oe,ze,wt,Rt,ct,Ve,Je;Object.defineProperty(r,"__esModule",{value:!0}),r.KeyboardManager=r.CommandManager=r.ColorManager=r.AnnotationEditorUIManager=void 0,r.bindEvents=k,r.opacityToHex=O;var e=y(1),a=y(8);function k(M,m,N){for(const te of N)m.addEventListener(te,M[te].bind(M))}function O(M){return Math.round(Math.min(255,Math.max(1,255*M))).toString(16).padStart(2,"0")}class S{constructor(){ue(this,T,0)}getId(){return`${e.AnnotationEditorPrefix}${at(this,T)._++}`}}T=new WeakMap;class _{constructor(m=128){ue(this,h,[]);ue(this,t,!1);ue(this,o);ue(this,c,-1);he(this,o,m)}add({cmd:m,undo:N,mustExec:te,type:H=NaN,overwriteIfSameType:J=!1,keepUndo:ee=!1}){if(te&&m(),I(this,t))return;const oe={cmd:m,undo:N,type:H};if(I(this,c)===-1){I(this,h).length>0&&(I(this,h).length=0),he(this,c,0),I(this,h).push(oe);return}if(J&&I(this,h)[I(this,c)].type===H){ee&&(oe.undo=I(this,h)[I(this,c)].undo),I(this,h)[I(this,c)]=oe;return}const de=I(this,c)+1;de===I(this,o)?I(this,h).splice(0,1):(he(this,c,de),de<I(this,h).length&&I(this,h).splice(de)),I(this,h).push(oe)}undo(){I(this,c)!==-1&&(he(this,t,!0),I(this,h)[I(this,c)].undo(),he(this,t,!1),he(this,c,I(this,c)-1))}redo(){I(this,c)<I(this,h).length-1&&(he(this,c,I(this,c)+1),he(this,t,!0),I(this,h)[I(this,c)].cmd(),he(this,t,!1))}hasSomethingToUndo(){return I(this,c)!==-1}hasSomethingToRedo(){return I(this,c)<I(this,h).length-1}destroy(){he(this,h,null)}}h=new WeakMap,t=new WeakMap,o=new WeakMap,c=new WeakMap,r.CommandManager=_;const d=class d{constructor(m){ue(this,x);this.buffer=[],this.callbacks=new Map,this.allKeys=new Set;const N=d.platform.isMac;for(const[te,H]of m)for(const J of te){const ee=J.startsWith("mac+");N&&ee?(this.callbacks.set(J.slice(4),H),this.allKeys.add(J.split("+").at(-1))):!N&&!ee&&(this.callbacks.set(J,H),this.allKeys.add(J.split("+").at(-1)))}}static get platform(){const m=typeof navigator<"u"?navigator.platform:"";return(0,e.shadow)(this,"platform",{isWin:m.includes("Win"),isMac:m.includes("Mac")})}exec(m,N){if(!this.allKeys.has(N.key))return;const te=this.callbacks.get(ce(this,x,xt).call(this,N));te&&(te.bind(m)(),N.stopPropagation(),N.preventDefault())}};x=new WeakSet,xt=function(m){m.altKey&&this.buffer.push("alt"),m.ctrlKey&&this.buffer.push("ctrl"),m.metaKey&&this.buffer.push("meta"),m.shiftKey&&this.buffer.push("shift"),this.buffer.push(m.key);const N=this.buffer.join("+");return this.buffer.length=0,N};let f=d;r.KeyboardManager=f;class C{constructor(){ue(this,i,null)}copy(m){m&&(Array.isArray(m)?he(this,i,m.map(N=>N.serialize())):he(this,i,[m.serialize()]),he(this,i,I(this,i).filter(N=>!!N)),I(this,i).length===0&&he(this,i,null))}paste(){return I(this,i)}isEmpty(){return I(this,i)===null}destroy(){he(this,i,null)}}i=new WeakMap;const l=class l{get _colors(){const m=new Map([["CanvasText",null],["Canvas",null]]);return(0,a.getColorValues)(m),(0,e.shadow)(this,"_colors",m)}convert(m){const N=(0,a.getRGB)(m);if(!window.matchMedia("(forced-colors: active)").matches)return N;for(const[te,H]of this._colors)if(H.every((J,ee)=>J===N[ee]))return l._colorsMapping.get(te);return N}getHexCode(m){const N=this._colors.get(m);return N?e.Util.makeHexColor(...N):m}};we(l,"_colorsMapping",new Map([["CanvasText",[0,0,0]],["Canvas",[255,255,255]]]));let L=l;r.ColorManager=L;const j=class j{constructor(m,N){ue(this,u);ue(this,n,null);ue(this,E,new Map);ue(this,R,new Map);ue(this,G,new C);ue(this,q,new _);ue(this,se,0);ue(this,ae,null);ue(this,Z,null);ue(this,Q,new S);ue(this,z,!1);ue(this,V,e.AnnotationEditorType.NONE);ue(this,X,new Set);ue(this,ne,this.keydown.bind(this));ue(this,le,this.onEditingAction.bind(this));ue(this,fe,this.onPageChanging.bind(this));ue(this,$,{isEditing:!1,isEmpty:!0,hasEmptyClipboard:!0,hasSomethingToUndo:!1,hasSomethingToRedo:!1,hasSelectedEditor:!1});ue(this,p,null);he(this,p,m),he(this,Z,N),I(this,Z)._on("editingaction",I(this,le)),I(this,Z)._on("pagechanging",I(this,fe))}destroy(){ce(this,u,lt).call(this),I(this,Z)._off("editingaction",I(this,le)),I(this,Z)._off("pagechanging",I(this,fe));for(const m of I(this,R).values())m.destroy();I(this,R).clear(),I(this,E).clear(),he(this,n,null),I(this,X).clear(),I(this,G).destroy(),I(this,q).destroy()}onPageChanging({pageNumber:m}){he(this,se,m-1)}focusMainContainer(){I(this,p).focus()}keydown(m){var N;(N=this.getActive())!=null&&N.shouldGetKeyboardEvents()||j._keyboardManager.exec(this,m)}onEditingAction(m){["undo","redo","cut","copy","paste","delete","selectAll"].includes(m.name)&&this[m.name]()}setEditingState(m){m?(ce(this,u,Ct).call(this),ce(this,u,Oe).call(this,{isEditing:I(this,V)!==e.AnnotationEditorType.NONE,isEmpty:ce(this,u,Ve).call(this),hasSomethingToUndo:I(this,q).hasSomethingToUndo(),hasSomethingToRedo:I(this,q).hasSomethingToRedo(),hasSelectedEditor:!1,hasEmptyClipboard:I(this,G).isEmpty()})):(ce(this,u,lt).call(this),ce(this,u,Oe).call(this,{isEditing:!1}))}registerEditorTypes(m){he(this,ae,m);for(const N of I(this,ae))ce(this,u,ze).call(this,N.defaultPropertiesToUpdate)}getId(){return I(this,Q).getId()}addLayer(m){I(this,R).set(m.pageIndex,m),I(this,z)?m.enable():m.disable()}removeLayer(m){I(this,R).delete(m.pageIndex)}updateMode(m){if(he(this,V,m),m===e.AnnotationEditorType.NONE)this.setEditingState(!1),ce(this,u,Rt).call(this);else{this.setEditingState(!0),ce(this,u,wt).call(this);for(const N of I(this,R).values())N.updateMode(m)}}updateToolbar(m){m!==I(this,V)&&I(this,Z).dispatch("switchannotationeditormode",{source:this,mode:m})}updateParams(m,N){for(const te of I(this,X))te.updateParams(m,N);for(const te of I(this,ae))te.updateDefaultParams(m,N)}getEditors(m){const N=[];for(const te of I(this,E).values())te.pageIndex===m&&N.push(te);return N}getEditor(m){return I(this,E).get(m)}addEditor(m){I(this,E).set(m.id,m)}removeEditor(m){I(this,E).delete(m.id),this.unselect(m)}setActiveEditor(m){I(this,n)!==m&&(he(this,n,m),m&&ce(this,u,ze).call(this,m.propertiesToUpdate))}toggleSelected(m){if(I(this,X).has(m)){I(this,X).delete(m),m.unselect(),ce(this,u,Oe).call(this,{hasSelectedEditor:this.hasSelection});return}I(this,X).add(m),m.select(),ce(this,u,ze).call(this,m.propertiesToUpdate),ce(this,u,Oe).call(this,{hasSelectedEditor:!0})}setSelected(m){for(const N of I(this,X))N!==m&&N.unselect();I(this,X).clear(),I(this,X).add(m),m.select(),ce(this,u,ze).call(this,m.propertiesToUpdate),ce(this,u,Oe).call(this,{hasSelectedEditor:!0})}isSelected(m){return I(this,X).has(m)}unselect(m){m.unselect(),I(this,X).delete(m),ce(this,u,Oe).call(this,{hasSelectedEditor:this.hasSelection})}get hasSelection(){return I(this,X).size!==0}undo(){I(this,q).undo(),ce(this,u,Oe).call(this,{hasSomethingToUndo:I(this,q).hasSomethingToUndo(),hasSomethingToRedo:!0,isEmpty:ce(this,u,Ve).call(this)})}redo(){I(this,q).redo(),ce(this,u,Oe).call(this,{hasSomethingToUndo:!0,hasSomethingToRedo:I(this,q).hasSomethingToRedo(),isEmpty:ce(this,u,Ve).call(this)})}addCommands(m){I(this,q).add(m),ce(this,u,Oe).call(this,{hasSomethingToUndo:!0,hasSomethingToRedo:!1,isEmpty:ce(this,u,Ve).call(this)})}delete(){if(I(this,n)&&I(this,n).commitOrRemove(),!this.hasSelection)return;const m=[...I(this,X)],N=()=>{for(const H of m)H.remove()},te=()=>{for(const H of m)ce(this,u,ct).call(this,H)};this.addCommands({cmd:N,undo:te,mustExec:!0})}copy(){if(I(this,n)&&I(this,n).commitOrRemove(),this.hasSelection){const m=[];for(const N of I(this,X))N.isEmpty()||m.push(N);if(m.length===0)return;I(this,G).copy(m),ce(this,u,Oe).call(this,{hasEmptyClipboard:!1})}}cut(){this.copy(),this.delete()}paste(){if(I(this,G).isEmpty())return;this.unselectAll();const m=I(this,R).get(I(this,se)),N=I(this,G).paste().map(J=>m.deserialize(J)),te=()=>{for(const J of N)ce(this,u,ct).call(this,J);ce(this,u,Je).call(this,N)},H=()=>{for(const J of N)J.remove()};this.addCommands({cmd:te,undo:H,mustExec:!0})}selectAll(){for(const m of I(this,X))m.commit();ce(this,u,Je).call(this,I(this,E).values())}unselectAll(){if(I(this,n)){I(this,n).commitOrRemove();return}if(ce(this,u,Je).size!==0){for(const m of I(this,X))m.unselect();I(this,X).clear(),ce(this,u,Oe).call(this,{hasSelectedEditor:!1})}}isActive(m){return I(this,n)===m}getActive(){return I(this,n)}getMode(){return I(this,V)}};n=new WeakMap,E=new WeakMap,R=new WeakMap,G=new WeakMap,q=new WeakMap,se=new WeakMap,ae=new WeakMap,Z=new WeakMap,Q=new WeakMap,z=new WeakMap,V=new WeakMap,X=new WeakMap,ne=new WeakMap,le=new WeakMap,fe=new WeakMap,$=new WeakMap,p=new WeakMap,u=new WeakSet,Ct=function(){I(this,p).addEventListener("keydown",I(this,ne))},lt=function(){I(this,p).removeEventListener("keydown",I(this,ne))},Oe=function(m){Object.entries(m).some(([te,H])=>I(this,$)[te]!==H)&&I(this,Z).dispatch("annotationeditorstateschanged",{source:this,details:Object.assign(I(this,$),m)})},ze=function(m){I(this,Z).dispatch("annotationeditorparamschanged",{source:this,details:m})},wt=function(){if(!I(this,z)){he(this,z,!0);for(const m of I(this,R).values())m.enable()}},Rt=function(){if(this.unselectAll(),I(this,z)){he(this,z,!1);for(const m of I(this,R).values())m.disable()}},ct=function(m){const N=I(this,R).get(m.pageIndex);N?N.addOrRebuild(m):this.addEditor(m)},Ve=function(){if(I(this,E).size===0)return!0;if(I(this,E).size===1)for(const m of I(this,E).values())return m.isEmpty();return!1},Je=function(m){I(this,X).clear();for(const N of m)N.isEmpty()||(I(this,X).add(N),N.select());ce(this,u,Oe).call(this,{hasSelectedEditor:!0})},we(j,"_keyboardManager",new f([[["ctrl+a","mac+meta+a"],j.prototype.selectAll],[["ctrl+c","mac+meta+c"],j.prototype.copy],[["ctrl+v","mac+meta+v"],j.prototype.paste],[["ctrl+x","mac+meta+x"],j.prototype.cut],[["ctrl+z","mac+meta+z"],j.prototype.undo],[["ctrl+y","ctrl+shift+Z","mac+meta+shift+Z"],j.prototype.redo],[["Backspace","alt+Backspace","ctrl+Backspace","shift+Backspace","mac+Backspace","mac+alt+Backspace","mac+ctrl+Backspace","Delete","ctrl+Delete","shift+Delete"],j.prototype.delete],[["Escape","mac+Escape"],j.prototype.unselectAll]]));let w=j;r.AnnotationEditorUIManager=w},(A,r,y)=>{Object.defineProperty(r,"__esModule",{value:!0}),r.StatTimer=r.RenderingCancelledException=r.PixelsPerInch=r.PageViewport=r.PDFDateString=r.DOMStandardFontDataFactory=r.DOMSVGFactory=r.DOMCanvasFactory=r.DOMCMapReaderFactory=r.AnnotationPrefix=void 0,r.deprecated=l,r.getColorValues=q,r.getCurrentTransform=se,r.getCurrentTransformInverse=ae,r.getFilenameFromUrl=c,r.getPdfFilenameFromUrl=x,r.getRGB=G,r.getXfaPageViewport=R,r.isDataScheme=t,r.isPdfFile=o,r.isValidFetchUrl=d,r.loadScript=i;var e=y(9),a=y(1);const k="http://www.w3.org/2000/svg",O="pdfjs_internal_id_";r.AnnotationPrefix=O;const Z=class Z{};we(Z,"CSS",96),we(Z,"PDF",72),we(Z,"PDF_TO_CSS_UNITS",Z.CSS/Z.PDF);let S=Z;r.PixelsPerInch=S;class _ extends e.BaseCanvasFactory{constructor({ownerDocument:z=globalThis.document}={}){super(),this._document=z}_createCanvas(z,V){const X=this._document.createElement("canvas");return X.width=z,X.height=V,X}}r.DOMCanvasFactory=_;async function f(Q,z=!1){if(d(Q,document.baseURI)){const V=await fetch(Q);if(!V.ok)throw new Error(V.statusText);return z?new Uint8Array(await V.arrayBuffer()):(0,a.stringToBytes)(await V.text())}return new Promise((V,X)=>{const ne=new XMLHttpRequest;ne.open("GET",Q,!0),z&&(ne.responseType="arraybuffer"),ne.onreadystatechange=()=>{if(ne.readyState===XMLHttpRequest.DONE){if(ne.status===200||ne.status===0){let le;if(z&&ne.response?le=new Uint8Array(ne.response):!z&&ne.responseText&&(le=(0,a.stringToBytes)(ne.responseText)),le){V(le);return}}X(new Error(ne.statusText))}},ne.send(null)})}class C extends e.BaseCMapReaderFactory{_fetchData(z,V){return f(z,this.isCompressed).then(X=>({cMapData:X,compressionType:V}))}}r.DOMCMapReaderFactory=C;class L extends e.BaseStandardFontDataFactory{_fetchData(z){return f(z,!0)}}r.DOMStandardFontDataFactory=L;class w extends e.BaseSVGFactory{_createSVG(z){return document.createElementNS(k,z)}}r.DOMSVGFactory=w;class T{constructor({viewBox:z,scale:V,rotation:X,offsetX:ne=0,offsetY:le=0,dontFlip:fe=!1}){this.viewBox=z,this.scale=V,this.rotation=X,this.offsetX=ne,this.offsetY=le;const $=(z[2]+z[0])/2,p=(z[3]+z[1])/2;let u,D,U,B;switch(X%=360,X<0&&(X+=360),X){case 180:u=-1,D=0,U=0,B=1;break;case 90:u=0,D=1,U=1,B=0;break;case 270:u=0,D=-1,U=-1,B=0;break;case 0:u=1,D=0,U=0,B=-1;break;default:throw new Error("PageViewport: Invalid rotation, must be a multiple of 90 degrees.")}fe&&(U=-U,B=-B);let W,s,g,P;u===0?(W=Math.abs(p-z[1])*V+ne,s=Math.abs($-z[0])*V+le,g=Math.abs(z[3]-z[1])*V,P=Math.abs(z[2]-z[0])*V):(W=Math.abs($-z[0])*V+ne,s=Math.abs(p-z[1])*V+le,g=Math.abs(z[2]-z[0])*V,P=Math.abs(z[3]-z[1])*V),this.transform=[u*V,D*V,U*V,B*V,W-u*V*$-U*V*p,s-D*V*$-B*V*p],this.width=g,this.height=P}clone({scale:z=this.scale,rotation:V=this.rotation,offsetX:X=this.offsetX,offsetY:ne=this.offsetY,dontFlip:le=!1}={}){return new T({viewBox:this.viewBox.slice(),scale:z,rotation:V,offsetX:X,offsetY:ne,dontFlip:le})}convertToViewportPoint(z,V){return a.Util.applyTransform([z,V],this.transform)}convertToViewportRectangle(z){const V=a.Util.applyTransform([z[0],z[1]],this.transform),X=a.Util.applyTransform([z[2],z[3]],this.transform);return[V[0],V[1],X[0],X[1]]}convertToPdfPoint(z,V){return a.Util.applyInverseTransform([z,V],this.transform)}}r.PageViewport=T;class h extends a.BaseException{constructor(z,V){super(z,"RenderingCancelledException"),this.type=V}}r.RenderingCancelledException=h;function t(Q){const z=Q.length;let V=0;for(;V<z&&Q[V].trim()==="";)V++;return Q.substring(V,V+5).toLowerCase()==="data:"}function o(Q){return typeof Q=="string"&&/\.pdf$/i.test(Q)}function c(Q){const z=Q.indexOf("#"),V=Q.indexOf("?"),X=Math.min(z>0?z:Q.length,V>0?V:Q.length);return Q.substring(Q.lastIndexOf("/",X)+1,X)}function x(Q,z="document.pdf"){if(typeof Q!="string")return z;if(t(Q))return(0,a.warn)('getPdfFilenameFromUrl: ignore "data:"-URL for performance reasons.'),z;const V=/^(?:(?:[^:]+:)?\/\/[^/]+)?([^?#]*)(\?[^#]*)?(#.*)?$/,X=/[^/?#=]+\.pdf\b(?!.*\.pdf\b)/i,ne=V.exec(Q);let le=X.exec(ne[1])||X.exec(ne[2])||X.exec(ne[3]);if(le&&(le=le[0],le.includes("%")))try{le=X.exec(decodeURIComponent(le))[0]}catch{}return le||z}class b{constructor(){this.started=Object.create(null),this.times=[]}time(z){z in this.started&&(0,a.warn)(`Timer is already running for ${z}`),this.started[z]=Date.now()}timeEnd(z){z in this.started||(0,a.warn)(`Timer has not been started for ${z}`),this.times.push({name:z,start:this.started[z],end:Date.now()}),delete this.started[z]}toString(){const z=[];let V=0;for(const X of this.times){const ne=X.name;ne.length>V&&(V=ne.length)}for(const X of this.times){const ne=X.end-X.start;z.push(`${X.name.padEnd(V)} ${ne}ms
`)}return z.join("")}}r.StatTimer=b;function d(Q,z){try{const{protocol:V}=z?new URL(Q,z):new URL(Q);return V==="http:"||V==="https:"}catch{return!1}}function i(Q,z=!1){return new Promise((V,X)=>{const ne=document.createElement("script");ne.src=Q,ne.onload=function(le){z&&ne.remove(),V(le)},ne.onerror=function(){X(new Error(`Cannot load script at: ${ne.src}`))},(document.head||document.documentElement).append(ne)})}function l(Q){console.log("Deprecated API usage: "+Q)}let n;class E{static toDateObject(z){if(!z||typeof z!="string")return null;n||(n=new RegExp("^D:(\\d{4})(\\d{2})?(\\d{2})?(\\d{2})?(\\d{2})?(\\d{2})?([Z|+|-])?(\\d{2})?'?(\\d{2})?'?"));const V=n.exec(z);if(!V)return null;const X=parseInt(V[1],10);let ne=parseInt(V[2],10);ne=ne>=1&&ne<=12?ne-1:0;let le=parseInt(V[3],10);le=le>=1&&le<=31?le:1;let fe=parseInt(V[4],10);fe=fe>=0&&fe<=23?fe:0;let $=parseInt(V[5],10);$=$>=0&&$<=59?$:0;let p=parseInt(V[6],10);p=p>=0&&p<=59?p:0;const u=V[7]||"Z";let D=parseInt(V[8],10);D=D>=0&&D<=23?D:0;let U=parseInt(V[9],10)||0;return U=U>=0&&U<=59?U:0,u==="-"?(fe+=D,$+=U):u==="+"&&(fe-=D,$-=U),new Date(Date.UTC(X,ne,le,fe,$,p))}}r.PDFDateString=E;function R(Q,{scale:z=1,rotation:V=0}){const{width:X,height:ne}=Q.attributes.style,le=[0,0,parseInt(X),parseInt(ne)];return new T({viewBox:le,scale:z,rotation:V})}function G(Q){if(Q.startsWith("#")){const z=parseInt(Q.slice(1),16);return[(z&16711680)>>16,(z&65280)>>8,z&255]}return Q.startsWith("rgb(")?Q.slice(4,-1).split(",").map(z=>parseInt(z)):Q.startsWith("rgba(")?Q.slice(5,-1).split(",").map(z=>parseInt(z)).slice(0,3):((0,a.warn)(`Not a valid color format: "${Q}"`),[0,0,0])}function q(Q){const z=document.createElement("span");z.style.visibility="hidden",document.body.append(z);for(const V of Q.keys()){z.style.color=V;const X=window.getComputedStyle(z).color;Q.set(V,G(X))}z.remove()}function se(Q){const{a:z,b:V,c:X,d:ne,e:le,f:fe}=Q.getTransform();return[z,V,X,ne,le,fe]}function ae(Q){const{a:z,b:V,c:X,d:ne,e:le,f:fe}=Q.getTransform().invertSelf();return[z,V,X,ne,le,fe]}},(A,r,y)=>{Object.defineProperty(r,"__esModule",{value:!0}),r.BaseStandardFontDataFactory=r.BaseSVGFactory=r.BaseCanvasFactory=r.BaseCMapReaderFactory=void 0;var e=y(1);class a{constructor(){this.constructor===a&&(0,e.unreachable)("Cannot initialize BaseCanvasFactory.")}create(f,C){if(f<=0||C<=0)throw new Error("Invalid canvas size");const L=this._createCanvas(f,C);return{canvas:L,context:L.getContext("2d")}}reset(f,C,L){if(!f.canvas)throw new Error("Canvas is not specified");if(C<=0||L<=0)throw new Error("Invalid canvas size");f.canvas.width=C,f.canvas.height=L}destroy(f){if(!f.canvas)throw new Error("Canvas is not specified");f.canvas.width=0,f.canvas.height=0,f.canvas=null,f.context=null}_createCanvas(f,C){(0,e.unreachable)("Abstract method `_createCanvas` called.")}}r.BaseCanvasFactory=a;class k{constructor({baseUrl:f=null,isCompressed:C=!1}){this.constructor===k&&(0,e.unreachable)("Cannot initialize BaseCMapReaderFactory."),this.baseUrl=f,this.isCompressed=C}async fetch({name:f}){if(!this.baseUrl)throw new Error('The CMap "baseUrl" parameter must be specified, ensure that the "cMapUrl" and "cMapPacked" API parameters are provided.');if(!f)throw new Error("CMap name must be specified.");const C=this.baseUrl+f+(this.isCompressed?".bcmap":""),L=this.isCompressed?e.CMapCompressionType.BINARY:e.CMapCompressionType.NONE;return this._fetchData(C,L).catch(w=>{throw new Error(`Unable to load ${this.isCompressed?"binary ":""}CMap at: ${C}`)})}_fetchData(f,C){(0,e.unreachable)("Abstract method `_fetchData` called.")}}r.BaseCMapReaderFactory=k;class O{constructor({baseUrl:f=null}){this.constructor===O&&(0,e.unreachable)("Cannot initialize BaseStandardFontDataFactory."),this.baseUrl=f}async fetch({filename:f}){if(!this.baseUrl)throw new Error('The standard font "baseUrl" parameter must be specified, ensure that the "standardFontDataUrl" API parameter is provided.');if(!f)throw new Error("Font filename must be specified.");const C=`${this.baseUrl}${f}`;return this._fetchData(C).catch(L=>{throw new Error(`Unable to load font data at: ${C}`)})}_fetchData(f){(0,e.unreachable)("Abstract method `_fetchData` called.")}}r.BaseStandardFontDataFactory=O;class S{constructor(){this.constructor===S&&(0,e.unreachable)("Cannot initialize BaseSVGFactory.")}create(f,C,L=!1){if(f<=0||C<=0)throw new Error("Invalid SVG dimensions");const w=this._createSVG("svg:svg");return w.setAttribute("version","1.1"),L||(w.setAttribute("width",`${f}px`),w.setAttribute("height",`${C}px`)),w.setAttribute("preserveAspectRatio","none"),w.setAttribute("viewBox",`0 0 ${f} ${C}`),w}createElement(f){if(typeof f!="string")throw new Error("Invalid SVG element type");return this._createSVG(f)}_createSVG(f){(0,e.unreachable)("Abstract method `_createSVG` called.")}}r.BaseSVGFactory=S},(A,r,y)=>{Object.defineProperty(r,"__esModule",{value:!0}),r.MurmurHash3_64=void 0;var e=y(1);const a=3285377520,k=4294901760,O=65535;class S{constructor(f){this.h1=f?f&4294967295:a,this.h2=f?f&4294967295:a}update(f){let C,L;if(typeof f=="string"){C=new Uint8Array(f.length*2),L=0;for(let n=0,E=f.length;n<E;n++){const R=f.charCodeAt(n);R<=255?C[L++]=R:(C[L++]=R>>>8,C[L++]=R&255)}}else if((0,e.isArrayBuffer)(f))C=f.slice(),L=C.byteLength;else throw new Error("Wrong data format in MurmurHash3_64_update. Input must be a string or array.");const w=L>>2,T=L-w*4,h=new Uint32Array(C.buffer,0,w);let t=0,o=0,c=this.h1,x=this.h2;const b=3432918353,d=461845907,i=b&O,l=d&O;for(let n=0;n<w;n++)n&1?(t=h[n],t=t*b&k|t*i&O,t=t<<15|t>>>17,t=t*d&k|t*l&O,c^=t,c=c<<13|c>>>19,c=c*5+3864292196):(o=h[n],o=o*b&k|o*i&O,o=o<<15|o>>>17,o=o*d&k|o*l&O,x^=o,x=x<<13|x>>>19,x=x*5+3864292196);switch(t=0,T){case 3:t^=C[w*4+2]<<16;case 2:t^=C[w*4+1]<<8;case 1:t^=C[w*4],t=t*b&k|t*i&O,t=t<<15|t>>>17,t=t*d&k|t*l&O,w&1?c^=t:x^=t}this.h1=c,this.h2=x}hexdigest(){let f=this.h1,C=this.h2;f^=C>>>1,f=f*3981806797&k|f*36045&O,C=C*4283543511&k|((C<<16|f>>>16)*2950163797&k)>>>16,f^=C>>>1,f=f*444984403&k|f*60499&O,C=C*3301882366&k|((C<<16|f>>>16)*3120437893&k)>>>16,f^=C>>>1;const L=(f>>>0).toString(16),w=(C>>>0).toString(16);return L.padStart(8,"0")+w.padStart(8,"0")}}r.MurmurHash3_64=S},(A,r,y)=>{Object.defineProperty(r,"__esModule",{value:!0}),r.FontLoader=r.FontFaceObject=void 0;var e=y(1);class a{constructor({docId:_,onUnsupportedFeature:f,ownerDocument:C=globalThis.document,styleElement:L=null}){this.constructor===a&&(0,e.unreachable)("Cannot initialize BaseFontLoader."),this.docId=_,this._onUnsupportedFeature=f,this._document=C,this.nativeFontFaces=[],this.styleElement=null}addNativeFontFace(_){this.nativeFontFaces.push(_),this._document.fonts.add(_)}insertRule(_){let f=this.styleElement;f||(f=this.styleElement=this._document.createElement("style"),f.id=`PDFJS_FONT_STYLE_TAG_${this.docId}`,this._document.documentElement.getElementsByTagName("head")[0].append(f));const C=f.sheet;C.insertRule(_,C.cssRules.length)}clear(){for(const _ of this.nativeFontFaces)this._document.fonts.delete(_);this.nativeFontFaces.length=0,this.styleElement&&(this.styleElement.remove(),this.styleElement=null)}async bind(_){if(_.attached||_.missingFile)return;if(_.attached=!0,this.isFontLoadingAPISupported){const C=_.createNativeFontFace();if(C){this.addNativeFontFace(C);try{await C.loaded}catch(L){throw this._onUnsupportedFeature({featureId:e.UNSUPPORTED_FEATURES.errorFontLoadNative}),(0,e.warn)(`Failed to load font '${C.family}': '${L}'.`),_.disableFontFace=!0,L}}return}const f=_.createFontFaceRule();if(f){if(this.insertRule(f),this.isSyncFontLoadingSupported)return;await new Promise(C=>{const L=this._queueLoadingCallback(C);this._prepareFontLoadEvent([f],[_],L)})}}_queueLoadingCallback(_){(0,e.unreachable)("Abstract method `_queueLoadingCallback`.")}get isFontLoadingAPISupported(){var f;const _=!!((f=this._document)!=null&&f.fonts);return(0,e.shadow)(this,"isFontLoadingAPISupported",_)}get isSyncFontLoadingSupported(){(0,e.unreachable)("Abstract method `isSyncFontLoadingSupported`.")}get _loadTestFont(){(0,e.unreachable)("Abstract method `_loadTestFont`.")}_prepareFontLoadEvent(_,f,C){(0,e.unreachable)("Abstract method `_prepareFontLoadEvent`.")}}let k;r.FontLoader=k,r.FontLoader=k=class extends a{constructor(_){super(_),this.loadingContext={requests:[],nextRequestId:0},this.loadTestFontId=0}get isSyncFontLoadingSupported(){let _=!1;if(typeof navigator>"u")_=!0;else{const f=/Mozilla\/5.0.*?rv:(\d+).*? Gecko/.exec(navigator.userAgent);(f==null?void 0:f[1])>=14&&(_=!0)}return(0,e.shadow)(this,"isSyncFontLoadingSupported",_)}_queueLoadingCallback(_){function f(){for((0,e.assert)(!L.done,"completeRequest() cannot be called twice."),L.done=!0;C.requests.length>0&&C.requests[0].done;){const w=C.requests.shift();setTimeout(w.callback,0)}}const C=this.loadingContext,L={id:`pdfjs-font-loading-${C.nextRequestId++}`,done:!1,complete:f,callback:_};return C.requests.push(L),L}get _loadTestFont(){const _=function(){return atob("T1RUTwALAIAAAwAwQ0ZGIDHtZg4AAAOYAAAAgUZGVE1lkzZwAAAEHAAAABxHREVGABQAFQAABDgAAAAeT1MvMlYNYwkAAAEgAAAAYGNtYXABDQLUAAACNAAAAUJoZWFk/xVFDQAAALwAAAA2aGhlYQdkA+oAAAD0AAAAJGhtdHgD6AAAAAAEWAAAAAZtYXhwAAJQAAAAARgAAAAGbmFtZVjmdH4AAAGAAAAAsXBvc3T/hgAzAAADeAAAACAAAQAAAAEAALZRFsRfDzz1AAsD6AAAAADOBOTLAAAAAM4KHDwAAAAAA+gDIQAAAAgAAgAAAAAAAAABAAADIQAAAFoD6AAAAAAD6AABAAAAAAAAAAAAAAAAAAAAAQAAUAAAAgAAAAQD6AH0AAUAAAKKArwAAACMAooCvAAAAeAAMQECAAACAAYJAAAAAAAAAAAAAQAAAAAAAAAAAAAAAFBmRWQAwAAuAC4DIP84AFoDIQAAAAAAAQAAAAAAAAAAACAAIAABAAAADgCuAAEAAAAAAAAAAQAAAAEAAAAAAAEAAQAAAAEAAAAAAAIAAQAAAAEAAAAAAAMAAQAAAAEAAAAAAAQAAQAAAAEAAAAAAAUAAQAAAAEAAAAAAAYAAQAAAAMAAQQJAAAAAgABAAMAAQQJAAEAAgABAAMAAQQJAAIAAgABAAMAAQQJAAMAAgABAAMAAQQJAAQAAgABAAMAAQQJAAUAAgABAAMAAQQJAAYAAgABWABYAAAAAAAAAwAAAAMAAAAcAAEAAAAAADwAAwABAAAAHAAEACAAAAAEAAQAAQAAAC7//wAAAC7////TAAEAAAAAAAABBgAAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAEAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAMAAAAAAAD/gwAyAAAAAQAAAAAAAAAAAAAAAAAAAAABAAQEAAEBAQJYAAEBASH4DwD4GwHEAvgcA/gXBIwMAYuL+nz5tQXkD5j3CBLnEQACAQEBIVhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYAAABAQAADwACAQEEE/t3Dov6fAH6fAT+fPp8+nwHDosMCvm1Cvm1DAz6fBQAAAAAAAABAAAAAMmJbzEAAAAAzgTjFQAAAADOBOQpAAEAAAAAAAAADAAUAAQAAAABAAAAAgABAAAAAAAAAAAD6AAAAAAAAA==")};return(0,e.shadow)(this,"_loadTestFont",_())}_prepareFontLoadEvent(_,f,C){function L(ae,Z){return ae.charCodeAt(Z)<<24|ae.charCodeAt(Z+1)<<16|ae.charCodeAt(Z+2)<<8|ae.charCodeAt(Z+3)&255}function w(ae,Z,Q,z){const V=ae.substring(0,Z),X=ae.substring(Z+Q);return V+z+X}let T,h;const t=this._document.createElement("canvas");t.width=1,t.height=1;const o=t.getContext("2d");let c=0;function x(ae,Z){if(c++,c>30){(0,e.warn)("Load test font never loaded."),Z();return}if(o.font="30px "+ae,o.fillText(".",0,20),o.getImageData(0,0,1,1).data[3]>0){Z();return}setTimeout(x.bind(null,ae,Z))}const b=`lt${Date.now()}${this.loadTestFontId++}`;let d=this._loadTestFont;d=w(d,976,b.length,b);const l=16,n=1482184792;let E=L(d,l);for(T=0,h=b.length-3;T<h;T+=4)E=E-n+L(b,T)|0;T<b.length&&(E=E-n+L(b+"XXX",T)|0),d=w(d,l,4,(0,e.string32)(E));const R=`url(data:font/opentype;base64,${btoa(d)});`,G=`@font-face {font-family:"${b}";src:${R}}`;this.insertRule(G);const q=[];for(const ae of f)q.push(ae.loadedName);q.push(b);const se=this._document.createElement("div");se.style.visibility="hidden",se.style.width=se.style.height="10px",se.style.position="absolute",se.style.top=se.style.left="0px";for(const ae of q){const Z=this._document.createElement("span");Z.textContent="Hi",Z.style.fontFamily=ae,se.append(Z)}this._document.body.append(se),x(b,()=>{se.remove(),C.complete()})}};class O{constructor(_,{isEvalSupported:f=!0,disableFontFace:C=!1,ignoreErrors:L=!1,onUnsupportedFeature:w,fontRegistry:T=null}){this.compiledGlyphs=Object.create(null);for(const h in _)this[h]=_[h];this.isEvalSupported=f!==!1,this.disableFontFace=C===!0,this.ignoreErrors=L===!0,this._onUnsupportedFeature=w,this.fontRegistry=T}createNativeFontFace(){if(!this.data||this.disableFontFace)return null;let _;if(!this.cssFontInfo)_=new FontFace(this.loadedName,this.data,{});else{const f={weight:this.cssFontInfo.fontWeight};this.cssFontInfo.italicAngle&&(f.style=`oblique ${this.cssFontInfo.italicAngle}deg`),_=new FontFace(this.cssFontInfo.fontFamily,this.data,f)}return this.fontRegistry&&this.fontRegistry.registerFont(this),_}createFontFaceRule(){if(!this.data||this.disableFontFace)return null;const _=(0,e.bytesToString)(this.data),f=`url(data:${this.mimetype};base64,${btoa(_)});`;let C;if(!this.cssFontInfo)C=`@font-face {font-family:"${this.loadedName}";src:${f}}`;else{let L=`font-weight: ${this.cssFontInfo.fontWeight};`;this.cssFontInfo.italicAngle&&(L+=`font-style: oblique ${this.cssFontInfo.italicAngle}deg;`),C=`@font-face {font-family:"${this.cssFontInfo.fontFamily}";${L}src:${f}}`}return this.fontRegistry&&this.fontRegistry.registerFont(this,f),C}getPathGenerator(_,f){if(this.compiledGlyphs[f]!==void 0)return this.compiledGlyphs[f];let C;try{C=_.get(this.loadedName+"_path_"+f)}catch(L){if(!this.ignoreErrors)throw L;return this._onUnsupportedFeature({featureId:e.UNSUPPORTED_FEATURES.errorFontGetPath}),(0,e.warn)(`getPathGenerator - ignoring character: "${L}".`),this.compiledGlyphs[f]=function(w,T){}}if(this.isEvalSupported&&e.FeatureTest.isEvalSupported){const L=[];for(const w of C){const T=w.args!==void 0?w.args.join(","):"";L.push("c.",w.cmd,"(",T,`);
`)}return this.compiledGlyphs[f]=new Function("c","size",L.join(""))}return this.compiledGlyphs[f]=function(L,w){for(const T of C)T.cmd==="scale"&&(T.args=[w,-w]),L[T.cmd].apply(L,T.args)}}}r.FontFaceObject=O},(A,r,y)=>{var ne,ut;Object.defineProperty(r,"__esModule",{value:!0}),r.CanvasGraphics=void 0;var e=y(8),a=y(1),k=y(13),O=y(14),S=y(3);const _=16,f=100,C=4096,L=15,w=10,T=S.isNodeJS&&typeof Path2D>"u"?-1:1e3,h=16;function t($,p){if($._removeMirroring)throw new Error("Context is already forwarding operations.");$.__originalSave=$.save,$.__originalRestore=$.restore,$.__originalRotate=$.rotate,$.__originalScale=$.scale,$.__originalTranslate=$.translate,$.__originalTransform=$.transform,$.__originalSetTransform=$.setTransform,$.__originalResetTransform=$.resetTransform,$.__originalClip=$.clip,$.__originalMoveTo=$.moveTo,$.__originalLineTo=$.lineTo,$.__originalBezierCurveTo=$.bezierCurveTo,$.__originalRect=$.rect,$.__originalClosePath=$.closePath,$.__originalBeginPath=$.beginPath,$._removeMirroring=()=>{$.save=$.__originalSave,$.restore=$.__originalRestore,$.rotate=$.__originalRotate,$.scale=$.__originalScale,$.translate=$.__originalTranslate,$.transform=$.__originalTransform,$.setTransform=$.__originalSetTransform,$.resetTransform=$.__originalResetTransform,$.clip=$.__originalClip,$.moveTo=$.__originalMoveTo,$.lineTo=$.__originalLineTo,$.bezierCurveTo=$.__originalBezierCurveTo,$.rect=$.__originalRect,$.closePath=$.__originalClosePath,$.beginPath=$.__originalBeginPath,delete $._removeMirroring},$.save=function(){p.save(),this.__originalSave()},$.restore=function(){p.restore(),this.__originalRestore()},$.translate=function(D,U){p.translate(D,U),this.__originalTranslate(D,U)},$.scale=function(D,U){p.scale(D,U),this.__originalScale(D,U)},$.transform=function(D,U,B,W,s,g){p.transform(D,U,B,W,s,g),this.__originalTransform(D,U,B,W,s,g)},$.setTransform=function(D,U,B,W,s,g){p.setTransform(D,U,B,W,s,g),this.__originalSetTransform(D,U,B,W,s,g)},$.resetTransform=function(){p.resetTransform(),this.__originalResetTransform()},$.rotate=function(D){p.rotate(D),this.__originalRotate(D)},$.clip=function(D){p.clip(D),this.__originalClip(D)},$.moveTo=function(u,D){p.moveTo(u,D),this.__originalMoveTo(u,D)},$.lineTo=function(u,D){p.lineTo(u,D),this.__originalLineTo(u,D)},$.bezierCurveTo=function(u,D,U,B,W,s){p.bezierCurveTo(u,D,U,B,W,s),this.__originalBezierCurveTo(u,D,U,B,W,s)},$.rect=function(u,D,U,B){p.rect(u,D,U,B),this.__originalRect(u,D,U,B)},$.closePath=function(){p.closePath(),this.__originalClosePath()},$.beginPath=function(){p.beginPath(),this.__originalBeginPath()}}class o{constructor(p){this.canvasFactory=p,this.cache=Object.create(null)}getCanvas(p,u,D){let U;return this.cache[p]!==void 0?(U=this.cache[p],this.canvasFactory.reset(U,u,D)):(U=this.canvasFactory.create(u,D),this.cache[p]=U),U}delete(p){delete this.cache[p]}clear(){for(const p in this.cache){const u=this.cache[p];this.canvasFactory.destroy(u),delete this.cache[p]}}}function c($,p,u,D,U,B,W,s,g,P){const[v,F,j,M,m,N]=(0,e.getCurrentTransform)($);if(F===0&&j===0){const J=W*v+m,ee=Math.round(J),oe=s*M+N,de=Math.round(oe),re=(W+g)*v+m,_e=Math.abs(Math.round(re)-ee)||1,me=(s+P)*M+N,ge=Math.abs(Math.round(me)-de)||1;return $.setTransform(Math.sign(v),0,0,Math.sign(M),ee,de),$.drawImage(p,u,D,U,B,0,0,_e,ge),$.setTransform(v,F,j,M,m,N),[_e,ge]}if(v===0&&M===0){const J=s*j+m,ee=Math.round(J),oe=W*F+N,de=Math.round(oe),re=(s+P)*j+m,_e=Math.abs(Math.round(re)-ee)||1,me=(W+g)*F+N,ge=Math.abs(Math.round(me)-de)||1;return $.setTransform(0,Math.sign(F),Math.sign(j),0,ee,de),$.drawImage(p,u,D,U,B,0,0,ge,_e),$.setTransform(v,F,j,M,m,N),[ge,_e]}$.drawImage(p,u,D,U,B,W,s,g,P);const te=Math.hypot(v,F),H=Math.hypot(j,M);return[te*g,H*P]}function x($){const{width:p,height:u}=$;if(p>T||u>T)return null;const D=1e3,U=new Uint8Array([0,2,4,0,1,0,5,4,8,10,0,8,0,2,1,0]),B=p+1;let W=new Uint8Array(B*(u+1)),s,g,P;const v=p+7&-8;let F=new Uint8Array(v*u),j=0;for(const H of $.data){let J=128;for(;J>0;)F[j++]=H&J?0:255,J>>=1}let M=0;for(j=0,F[j]!==0&&(W[0]=1,++M),g=1;g<p;g++)F[j]!==F[j+1]&&(W[g]=F[j]?2:1,++M),j++;for(F[j]!==0&&(W[g]=2,++M),s=1;s<u;s++){j=s*v,P=s*B,F[j-v]!==F[j]&&(W[P]=F[j]?1:8,++M);let H=(F[j]?4:0)+(F[j-v]?8:0);for(g=1;g<p;g++)H=(H>>2)+(F[j+1]?4:0)+(F[j-v+1]?8:0),U[H]&&(W[P+g]=U[H],++M),j++;if(F[j-v]!==F[j]&&(W[P+g]=F[j]?2:4,++M),M>D)return null}for(j=v*(u-1),P=s*B,F[j]!==0&&(W[P]=8,++M),g=1;g<p;g++)F[j]!==F[j+1]&&(W[P+g]=F[j]?4:8,++M),j++;if(F[j]!==0&&(W[P+g]=4,++M),M>D)return null;const m=new Int32Array([0,B,-1,0,-B,0,0,0,1]),N=new Path2D;for(s=0;M&&s<=u;s++){let H=s*B;const J=H+p;for(;H<J&&!W[H];)H++;if(H===J)continue;N.moveTo(H%B,s);const ee=H;let oe=W[H];do{const de=m[oe];do H+=de;while(!W[H]);const re=W[H];re!==5&&re!==10?(oe=re,W[H]=0):(oe=re&51*oe>>4,W[H]&=oe>>2|oe<<2),N.lineTo(H%B,H/B|0),W[H]||--M}while(ee!==H);--s}return F=null,W=null,function(H){H.save(),H.scale(1/p,-1/u),H.translate(0,-u),H.fill(N),H.beginPath(),H.restore()}}class b{constructor(p,u){this.alphaIsShape=!1,this.fontSize=0,this.fontSizeScale=1,this.textMatrix=a.IDENTITY_MATRIX,this.textMatrixScale=1,this.fontMatrix=a.FONT_IDENTITY_MATRIX,this.leading=0,this.x=0,this.y=0,this.lineX=0,this.lineY=0,this.charSpacing=0,this.wordSpacing=0,this.textHScale=1,this.textRenderingMode=a.TextRenderingMode.FILL,this.textRise=0,this.fillColor="#000000",this.strokeColor="#000000",this.patternFill=!1,this.fillAlpha=1,this.strokeAlpha=1,this.lineWidth=1,this.activeSMask=null,this.transferMaps=null,this.startNewPathAndClipBox([0,0,p,u])}clone(){const p=Object.create(this);return p.clipBox=this.clipBox.slice(),p}setCurrentPoint(p,u){this.x=p,this.y=u}updatePathMinMax(p,u,D){[u,D]=a.Util.applyTransform([u,D],p),this.minX=Math.min(this.minX,u),this.minY=Math.min(this.minY,D),this.maxX=Math.max(this.maxX,u),this.maxY=Math.max(this.maxY,D)}updateRectMinMax(p,u){const D=a.Util.applyTransform(u,p),U=a.Util.applyTransform(u.slice(2),p);this.minX=Math.min(this.minX,D[0],U[0]),this.minY=Math.min(this.minY,D[1],U[1]),this.maxX=Math.max(this.maxX,D[0],U[0]),this.maxY=Math.max(this.maxY,D[1],U[1])}updateScalingPathMinMax(p,u){a.Util.scaleMinMax(p,u),this.minX=Math.min(this.minX,u[0]),this.maxX=Math.max(this.maxX,u[1]),this.minY=Math.min(this.minY,u[2]),this.maxY=Math.max(this.maxY,u[3])}updateCurvePathMinMax(p,u,D,U,B,W,s,g,P,v){const F=a.Util.bezierBoundingBox(u,D,U,B,W,s,g,P);if(v){v[0]=Math.min(v[0],F[0],F[2]),v[1]=Math.max(v[1],F[0],F[2]),v[2]=Math.min(v[2],F[1],F[3]),v[3]=Math.max(v[3],F[1],F[3]);return}this.updateRectMinMax(p,F)}getPathBoundingBox(p=k.PathType.FILL,u=null){const D=[this.minX,this.minY,this.maxX,this.maxY];if(p===k.PathType.STROKE){u||(0,a.unreachable)("Stroke bounding box must include transform.");const U=a.Util.singularValueDecompose2dScale(u),B=U[0]*this.lineWidth/2,W=U[1]*this.lineWidth/2;D[0]-=B,D[1]-=W,D[2]+=B,D[3]+=W}return D}updateClipFromPath(){const p=a.Util.intersect(this.clipBox,this.getPathBoundingBox());this.startNewPathAndClipBox(p||[0,0,0,0])}isEmptyClip(){return this.minX===1/0}startNewPathAndClipBox(p){this.clipBox=p,this.minX=1/0,this.minY=1/0,this.maxX=0,this.maxY=0}getClippedPathBoundingBox(p=k.PathType.FILL,u=null){return a.Util.intersect(this.clipBox,this.getPathBoundingBox(p,u))}}function d($,p,u=null){if(typeof ImageData<"u"&&p instanceof ImageData){$.putImageData(p,0,0);return}const D=p.height,U=p.width,B=D%h,W=(D-B)/h,s=B===0?W:W+1,g=$.createImageData(U,h);let P=0,v;const F=p.data,j=g.data;let M,m,N,te,H,J,ee,oe;if(u)switch(u.length){case 1:H=u[0],J=u[0],ee=u[0],oe=u[0];break;case 4:H=u[0],J=u[1],ee=u[2],oe=u[3];break}if(p.kind===a.ImageKind.GRAYSCALE_1BPP){const de=F.byteLength,re=new Uint32Array(j.buffer,0,j.byteLength>>2),_e=re.length,me=U+7>>3;let ge=4294967295,be=a.FeatureTest.isLittleEndian?4278190080:255;for(oe&&oe[0]===255&&oe[255]===0&&([ge,be]=[be,ge]),M=0;M<s;M++){for(N=M<W?h:B,v=0,m=0;m<N;m++){const ve=de-P;let xe=0;const Ae=ve>me?U:ve*8-7,Ce=Ae&-8;let Ee=0,Pe=0;for(;xe<Ce;xe+=8)Pe=F[P++],re[v++]=Pe&128?ge:be,re[v++]=Pe&64?ge:be,re[v++]=Pe&32?ge:be,re[v++]=Pe&16?ge:be,re[v++]=Pe&8?ge:be,re[v++]=Pe&4?ge:be,re[v++]=Pe&2?ge:be,re[v++]=Pe&1?ge:be;for(;xe<Ae;xe++)Ee===0&&(Pe=F[P++],Ee=128),re[v++]=Pe&Ee?ge:be,Ee>>=1}for(;v<_e;)re[v++]=0;$.putImageData(g,0,M*h)}}else if(p.kind===a.ImageKind.RGBA_32BPP){const de=!!(H||J||ee);for(m=0,te=U*h*4,M=0;M<W;M++){if(j.set(F.subarray(P,P+te)),P+=te,de)for(let re=0;re<te;re+=4)H&&(j[re+0]=H[j[re+0]]),J&&(j[re+1]=J[j[re+1]]),ee&&(j[re+2]=ee[j[re+2]]);$.putImageData(g,0,m),m+=h}if(M<s){if(te=U*B*4,j.set(F.subarray(P,P+te)),de)for(let re=0;re<te;re+=4)H&&(j[re+0]=H[j[re+0]]),J&&(j[re+1]=J[j[re+1]]),ee&&(j[re+2]=ee[j[re+2]]);$.putImageData(g,0,m)}}else if(p.kind===a.ImageKind.RGB_24BPP){const de=!!(H||J||ee);for(N=h,te=U*N,M=0;M<s;M++){for(M>=W&&(N=B,te=U*N),v=0,m=te;m--;)j[v++]=F[P++],j[v++]=F[P++],j[v++]=F[P++],j[v++]=255;if(de)for(let re=0;re<v;re+=4)H&&(j[re+0]=H[j[re+0]]),J&&(j[re+1]=J[j[re+1]]),ee&&(j[re+2]=ee[j[re+2]]);$.putImageData(g,0,M*h)}}else throw new Error(`bad image kind: ${p.kind}`)}function i($,p){if(p.bitmap){$.drawImage(p.bitmap,0,0);return}const u=p.height,D=p.width,U=u%h,B=(u-U)/h,W=U===0?B:B+1,s=$.createImageData(D,h);let g=0;const P=p.data,v=s.data;for(let F=0;F<W;F++){const j=F<B?h:U;({srcPos:g}=(0,O.applyMaskImageData)({src:P,srcPos:g,dest:v,width:D,height:j})),$.putImageData(s,0,F*h)}}function l($,p){const u=["strokeStyle","fillStyle","fillRule","globalAlpha","lineWidth","lineCap","lineJoin","miterLimit","globalCompositeOperation","font"];for(let D=0,U=u.length;D<U;D++){const B=u[D];$[B]!==void 0&&(p[B]=$[B])}$.setLineDash!==void 0&&(p.setLineDash($.getLineDash()),p.lineDashOffset=$.lineDashOffset)}function n($,p){$.strokeStyle=$.fillStyle=p||"#000000",$.fillRule="nonzero",$.globalAlpha=1,$.lineWidth=1,$.lineCap="butt",$.lineJoin="miter",$.miterLimit=10,$.globalCompositeOperation="source-over",$.font="10px sans-serif",$.setLineDash!==void 0&&($.setLineDash([]),$.lineDashOffset=0)}function E($,p,u,D){const U=$.length;for(let B=3;B<U;B+=4){const W=$[B];if(W===0)$[B-3]=p,$[B-2]=u,$[B-1]=D;else if(W<255){const s=255-W;$[B-3]=$[B-3]*W+p*s>>8,$[B-2]=$[B-2]*W+u*s>>8,$[B-1]=$[B-1]*W+D*s>>8}}}function R($,p,u){const D=$.length,U=1/255;for(let B=3;B<D;B+=4){const W=u?u[$[B]]:$[B];p[B]=p[B]*W*U|0}}function G($,p,u){const D=$.length;for(let U=3;U<D;U+=4){const B=$[U-3]*77+$[U-2]*152+$[U-1]*28;p[U]=u?p[U]*u[B>>8]>>8:p[U]*B>>16}}function q($,p,u,D,U,B,W,s,g,P,v){const F=!!B,j=F?B[0]:0,M=F?B[1]:0,m=F?B[2]:0;let N;U==="Luminosity"?N=G:N=R;const H=Math.min(D,Math.ceil(1048576/u));for(let J=0;J<D;J+=H){const ee=Math.min(H,D-J),oe=$.getImageData(s-P,J+(g-v),u,ee),de=p.getImageData(s,J+g,u,ee);F&&E(oe.data,j,M,m),N(oe.data,de.data,W),p.putImageData(de,s,J+g)}}function se($,p,u,D){const U=D[0],B=D[1],W=D[2]-U,s=D[3]-B;W===0||s===0||(q(p.context,u,W,s,p.subtype,p.backdrop,p.transferMap,U,B,p.offsetX,p.offsetY),$.save(),$.globalAlpha=1,$.globalCompositeOperation="source-over",$.setTransform(1,0,0,1,0,0),$.drawImage(u.canvas,0,0),$.restore())}function ae($,p){const u=a.Util.singularValueDecompose2dScale($);u[0]=Math.fround(u[0]),u[1]=Math.fround(u[1]);const D=Math.fround((globalThis.devicePixelRatio||1)*e.PixelsPerInch.PDF_TO_CSS_UNITS);return p!==void 0?p:u[0]<=D||u[1]<=D}const Z=["butt","round","square"],Q=["miter","round","bevel"],z={},V={},fe=class fe{constructor(p,u,D,U,B,W,s,g){ue(this,ne);this.ctx=p,this.current=new b(this.ctx.canvas.width,this.ctx.canvas.height),this.stateStack=[],this.pendingClip=null,this.pendingEOFill=!1,this.res=null,this.xobjs=null,this.commonObjs=u,this.objs=D,this.canvasFactory=U,this.imageLayer=B,this.groupStack=[],this.processingType3=null,this.baseTransform=null,this.baseTransformStack=[],this.groupLevel=0,this.smaskStack=[],this.smaskCounter=0,this.tempSMask=null,this.suspendedCtx=null,this.contentVisible=!0,this.markedContentStack=[],this.optionalContentConfig=W,this.cachedCanvases=new o(this.canvasFactory),this.cachedPatterns=new Map,this.annotationCanvasMap=s,this.viewportScale=1,this.outputScaleX=1,this.outputScaleY=1,this.backgroundColor=(g==null?void 0:g.background)||null,this.foregroundColor=(g==null?void 0:g.foreground)||null,this._cachedScaleForStroking=null,this._cachedGetSinglePixelWidth=null,this._cachedBitmapsMap=new Map}getObject(p,u=null){return typeof p=="string"?p.startsWith("g_")?this.commonObjs.get(p):this.objs.get(p):u}beginDrawing({transform:p,viewport:u,transparency:D=!1,background:U=null}){const B=this.ctx.canvas.width,W=this.ctx.canvas.height,s=U||"#ffffff";if(this.ctx.save(),this.foregroundColor&&this.backgroundColor){this.ctx.fillStyle=this.foregroundColor;const g=this.foregroundColor=this.ctx.fillStyle;this.ctx.fillStyle=this.backgroundColor;const P=this.backgroundColor=this.ctx.fillStyle;let v=!0,F=s;if(this.ctx.fillStyle=s,F=this.ctx.fillStyle,v=typeof F=="string"&&/^#[0-9A-Fa-f]{6}$/.test(F),g==="#000000"&&P==="#ffffff"||g===P||!v)this.foregroundColor=this.backgroundColor=null;else{const[j,M,m]=(0,e.getRGB)(F),N=H=>(H/=255,H<=.03928?H/12.92:((H+.055)/1.055)**2.4),te=Math.round(.2126*N(j)+.7152*N(M)+.0722*N(m));this.selectColor=(H,J,ee)=>{const oe=.2126*N(H)+.7152*N(J)+.0722*N(ee);return Math.round(oe)===te?P:g}}}if(this.ctx.fillStyle=this.backgroundColor||s,this.ctx.fillRect(0,0,B,W),this.ctx.restore(),D){const g=this.cachedCanvases.getCanvas("transparent",B,W);this.compositeCtx=this.ctx,this.transparentCanvas=g.canvas,this.ctx=g.context,this.ctx.save(),this.ctx.transform(...(0,e.getCurrentTransform)(this.compositeCtx))}this.ctx.save(),n(this.ctx,this.foregroundColor),p&&(this.ctx.transform(...p),this.outputScaleX=p[0],this.outputScaleY=p[0]),this.ctx.transform(...u.transform),this.viewportScale=u.scale,this.baseTransform=(0,e.getCurrentTransform)(this.ctx),this.imageLayer&&((0,e.deprecated)("The `imageLayer` functionality will be removed in the future."),this.imageLayer.beginLayout())}executeOperatorList(p,u,D,U){const B=p.argsArray,W=p.fnArray;let s=u||0;const g=B.length;if(g===s)return s;const P=g-s>w&&typeof D=="function",v=P?Date.now()+L:0;let F=0;const j=this.commonObjs,M=this.objs;let m;for(;;){if(U!==void 0&&s===U.nextBreakPoint)return U.breakIt(s,D),s;if(m=W[s],m!==a.OPS.dependency)this[m].apply(this,B[s]);else for(const N of B[s]){const te=N.startsWith("g_")?j:M;if(!te.has(N))return te.get(N,D),s}if(s++,s===g)return s;if(P&&++F>w){if(Date.now()>v)return D(),s;F=0}}}endDrawing(){ce(this,ne,ut).call(this),this.cachedCanvases.clear(),this.cachedPatterns.clear();for(const p of this._cachedBitmapsMap.values()){for(const u of p.values())typeof HTMLCanvasElement<"u"&&u instanceof HTMLCanvasElement&&(u.width=u.height=0);p.clear()}this._cachedBitmapsMap.clear(),this.imageLayer&&this.imageLayer.endLayout()}_scaleImage(p,u){const D=p.width,U=p.height;let B=Math.max(Math.hypot(u[0],u[1]),1),W=Math.max(Math.hypot(u[2],u[3]),1),s=D,g=U,P="prescale1",v,F;for(;B>2&&s>1||W>2&&g>1;){let j=s,M=g;B>2&&s>1&&(j=Math.ceil(s/2),B/=s/j),W>2&&g>1&&(M=Math.ceil(g/2),W/=g/M),v=this.cachedCanvases.getCanvas(P,j,M),F=v.context,F.clearRect(0,0,j,M),F.drawImage(p,0,0,s,g,0,0,j,M),p=v.canvas,s=j,g=M,P=P==="prescale1"?"prescale2":"prescale1"}return{img:p,paintWidth:s,paintHeight:g}}_createMaskCanvas(p){const u=this.ctx,{width:D,height:U}=p,B=this.current.fillColor,W=this.current.patternFill,s=(0,e.getCurrentTransform)(u);let g,P,v,F;if((p.bitmap||p.data)&&p.count>1){const _e=p.bitmap||p.data.buffer,me=s.slice(0,4);P=JSON.stringify(W?me:[me,B]),g=this._cachedBitmapsMap.get(_e),g||(g=new Map,this._cachedBitmapsMap.set(_e,g));const ge=g.get(P);if(ge&&!W){const be=Math.round(Math.min(s[0],s[2])+s[4]),ve=Math.round(Math.min(s[1],s[3])+s[5]);return{canvas:ge,offsetX:be,offsetY:ve}}v=ge}v||(F=this.cachedCanvases.getCanvas("maskCanvas",D,U),i(F.context,p));let j=a.Util.transform(s,[1/D,0,0,-1/U,0,0]);j=a.Util.transform(j,[1,0,0,1,0,-U]);const M=a.Util.applyTransform([0,0],j),m=a.Util.applyTransform([D,U],j),N=a.Util.normalizeRect([M[0],M[1],m[0],m[1]]),te=Math.round(N[2]-N[0])||1,H=Math.round(N[3]-N[1])||1,J=this.cachedCanvases.getCanvas("fillCanvas",te,H),ee=J.context,oe=Math.min(M[0],m[0]),de=Math.min(M[1],m[1]);ee.translate(-oe,-de),ee.transform(...j),v||(v=this._scaleImage(F.canvas,(0,e.getCurrentTransformInverse)(ee)),v=v.img,g&&W&&g.set(P,v)),ee.imageSmoothingEnabled=ae((0,e.getCurrentTransform)(ee),p.interpolate),c(ee,v,0,0,v.width,v.height,0,0,D,U),ee.globalCompositeOperation="source-in";const re=a.Util.transform((0,e.getCurrentTransformInverse)(ee),[1,0,0,1,-oe,-de]);return ee.fillStyle=W?B.getPattern(u,this,re,k.PathType.FILL):B,ee.fillRect(0,0,D,U),g&&!W&&(this.cachedCanvases.delete("fillCanvas"),g.set(P,J.canvas)),{canvas:J.canvas,offsetX:Math.round(oe),offsetY:Math.round(de)}}setLineWidth(p){p!==this.current.lineWidth&&(this._cachedScaleForStroking=null),this.current.lineWidth=p,this.ctx.lineWidth=p}setLineCap(p){this.ctx.lineCap=Z[p]}setLineJoin(p){this.ctx.lineJoin=Q[p]}setMiterLimit(p){this.ctx.miterLimit=p}setDash(p,u){const D=this.ctx;D.setLineDash!==void 0&&(D.setLineDash(p),D.lineDashOffset=u)}setRenderingIntent(p){}setFlatness(p){}setGState(p){for(let u=0,D=p.length;u<D;u++){const U=p[u],B=U[0],W=U[1];switch(B){case"LW":this.setLineWidth(W);break;case"LC":this.setLineCap(W);break;case"LJ":this.setLineJoin(W);break;case"ML":this.setMiterLimit(W);break;case"D":this.setDash(W[0],W[1]);break;case"RI":this.setRenderingIntent(W);break;case"FL":this.setFlatness(W);break;case"Font":this.setFont(W[0],W[1]);break;case"CA":this.current.strokeAlpha=U[1];break;case"ca":this.current.fillAlpha=U[1],this.ctx.globalAlpha=U[1];break;case"BM":this.ctx.globalCompositeOperation=W;break;case"SMask":this.current.activeSMask=W?this.tempSMask:null,this.tempSMask=null,this.checkSMaskState();break;case"TR":this.current.transferMaps=W}}}get inSMaskMode(){return!!this.suspendedCtx}checkSMaskState(){const p=this.inSMaskMode;this.current.activeSMask&&!p?this.beginSMaskMode():!this.current.activeSMask&&p&&this.endSMaskMode()}beginSMaskMode(){if(this.inSMaskMode)throw new Error("beginSMaskMode called while already in smask mode");const p=this.ctx.canvas.width,u=this.ctx.canvas.height,D="smaskGroupAt"+this.groupLevel,U=this.cachedCanvases.getCanvas(D,p,u);this.suspendedCtx=this.ctx,this.ctx=U.context;const B=this.ctx;B.setTransform(...(0,e.getCurrentTransform)(this.suspendedCtx)),l(this.suspendedCtx,B),t(B,this.suspendedCtx),this.setGState([["BM","source-over"],["ca",1],["CA",1]])}endSMaskMode(){if(!this.inSMaskMode)throw new Error("endSMaskMode called while not in smask mode");this.ctx._removeMirroring(),l(this.ctx,this.suspendedCtx),this.ctx=this.suspendedCtx,this.suspendedCtx=null}compose(p){if(!this.current.activeSMask)return;p?(p[0]=Math.floor(p[0]),p[1]=Math.floor(p[1]),p[2]=Math.ceil(p[2]),p[3]=Math.ceil(p[3])):p=[0,0,this.ctx.canvas.width,this.ctx.canvas.height];const u=this.current.activeSMask,D=this.suspendedCtx;se(D,u,this.ctx,p),this.ctx.save(),this.ctx.setTransform(1,0,0,1,0,0),this.ctx.clearRect(0,0,this.ctx.canvas.width,this.ctx.canvas.height),this.ctx.restore()}save(){this.inSMaskMode?(l(this.ctx,this.suspendedCtx),this.suspendedCtx.save()):this.ctx.save();const p=this.current;this.stateStack.push(p),this.current=p.clone()}restore(){this.stateStack.length===0&&this.inSMaskMode&&this.endSMaskMode(),this.stateStack.length!==0&&(this.current=this.stateStack.pop(),this.inSMaskMode?(this.suspendedCtx.restore(),l(this.suspendedCtx,this.ctx)):this.ctx.restore(),this.checkSMaskState(),this.pendingClip=null,this._cachedScaleForStroking=null,this._cachedGetSinglePixelWidth=null)}transform(p,u,D,U,B,W){this.ctx.transform(p,u,D,U,B,W),this._cachedScaleForStroking=null,this._cachedGetSinglePixelWidth=null}constructPath(p,u,D){const U=this.ctx,B=this.current;let W=B.x,s=B.y,g,P;const v=(0,e.getCurrentTransform)(U),F=v[0]===0&&v[3]===0||v[1]===0&&v[2]===0,j=F?D.slice(0):null;for(let M=0,m=0,N=p.length;M<N;M++)switch(p[M]|0){case a.OPS.rectangle:W=u[m++],s=u[m++];const te=u[m++],H=u[m++],J=W+te,ee=s+H;U.moveTo(W,s),te===0||H===0?U.lineTo(J,ee):(U.lineTo(J,s),U.lineTo(J,ee),U.lineTo(W,ee)),F||B.updateRectMinMax(v,[W,s,J,ee]),U.closePath();break;case a.OPS.moveTo:W=u[m++],s=u[m++],U.moveTo(W,s),F||B.updatePathMinMax(v,W,s);break;case a.OPS.lineTo:W=u[m++],s=u[m++],U.lineTo(W,s),F||B.updatePathMinMax(v,W,s);break;case a.OPS.curveTo:g=W,P=s,W=u[m+4],s=u[m+5],U.bezierCurveTo(u[m],u[m+1],u[m+2],u[m+3],W,s),B.updateCurvePathMinMax(v,g,P,u[m],u[m+1],u[m+2],u[m+3],W,s,j),m+=6;break;case a.OPS.curveTo2:g=W,P=s,U.bezierCurveTo(W,s,u[m],u[m+1],u[m+2],u[m+3]),B.updateCurvePathMinMax(v,g,P,W,s,u[m],u[m+1],u[m+2],u[m+3],j),W=u[m+2],s=u[m+3],m+=4;break;case a.OPS.curveTo3:g=W,P=s,W=u[m+2],s=u[m+3],U.bezierCurveTo(u[m],u[m+1],W,s,W,s),B.updateCurvePathMinMax(v,g,P,u[m],u[m+1],W,s,W,s,j),m+=4;break;case a.OPS.closePath:U.closePath();break}F&&B.updateScalingPathMinMax(v,j),B.setCurrentPoint(W,s)}closePath(){this.ctx.closePath()}stroke(p){p=typeof p<"u"?p:!0;const u=this.ctx,D=this.current.strokeColor;u.globalAlpha=this.current.strokeAlpha,this.contentVisible&&(typeof D=="object"&&(D!=null&&D.getPattern)?(u.save(),u.strokeStyle=D.getPattern(u,this,(0,e.getCurrentTransformInverse)(u),k.PathType.STROKE),this.rescaleAndStroke(!1),u.restore()):this.rescaleAndStroke(!0)),p&&this.consumePath(this.current.getClippedPathBoundingBox()),u.globalAlpha=this.current.fillAlpha}closeStroke(){this.closePath(),this.stroke()}fill(p){p=typeof p<"u"?p:!0;const u=this.ctx,D=this.current.fillColor,U=this.current.patternFill;let B=!1;U&&(u.save(),u.fillStyle=D.getPattern(u,this,(0,e.getCurrentTransformInverse)(u),k.PathType.FILL),B=!0);const W=this.current.getClippedPathBoundingBox();this.contentVisible&&W!==null&&(this.pendingEOFill?(u.fill("evenodd"),this.pendingEOFill=!1):u.fill()),B&&u.restore(),p&&this.consumePath(W)}eoFill(){this.pendingEOFill=!0,this.fill()}fillStroke(){this.fill(!1),this.stroke(!1),this.consumePath()}eoFillStroke(){this.pendingEOFill=!0,this.fillStroke()}closeFillStroke(){this.closePath(),this.fillStroke()}closeEOFillStroke(){this.pendingEOFill=!0,this.closePath(),this.fillStroke()}endPath(){this.consumePath()}clip(){this.pendingClip=z}eoClip(){this.pendingClip=V}beginText(){this.current.textMatrix=a.IDENTITY_MATRIX,this.current.textMatrixScale=1,this.current.x=this.current.lineX=0,this.current.y=this.current.lineY=0}endText(){const p=this.pendingTextPaths,u=this.ctx;if(p===void 0){u.beginPath();return}u.save(),u.beginPath();for(const D of p)u.setTransform(...D.transform),u.translate(D.x,D.y),D.addToPath(u,D.fontSize);u.restore(),u.clip(),u.beginPath(),delete this.pendingTextPaths}setCharSpacing(p){this.current.charSpacing=p}setWordSpacing(p){this.current.wordSpacing=p}setHScale(p){this.current.textHScale=p/100}setLeading(p){this.current.leading=-p}setFont(p,u){const D=this.commonObjs.get(p),U=this.current;if(!D)throw new Error(`Can't find font for ${p}`);if(U.fontMatrix=D.fontMatrix||a.FONT_IDENTITY_MATRIX,(U.fontMatrix[0]===0||U.fontMatrix[3]===0)&&(0,a.warn)("Invalid font matrix for font "+p),u<0?(u=-u,U.fontDirection=-1):U.fontDirection=1,this.current.font=D,this.current.fontSize=u,D.isType3Font)return;const B=D.loadedName||"sans-serif";let W="normal";D.black?W="900":D.bold&&(W="bold");const s=D.italic?"italic":"normal",g=`"${B}", ${D.fallbackName}`;let P=u;u<_?P=_:u>f&&(P=f),this.current.fontSizeScale=u/P,this.ctx.font=`${s} ${W} ${P}px ${g}`}setTextRenderingMode(p){this.current.textRenderingMode=p}setTextRise(p){this.current.textRise=p}moveText(p,u){this.current.x=this.current.lineX+=p,this.current.y=this.current.lineY+=u}setLeadingMoveText(p,u){this.setLeading(-u),this.moveText(p,u)}setTextMatrix(p,u,D,U,B,W){this.current.textMatrix=[p,u,D,U,B,W],this.current.textMatrixScale=Math.hypot(p,u),this.current.x=this.current.lineX=0,this.current.y=this.current.lineY=0}nextLine(){this.moveText(0,this.current.leading)}paintChar(p,u,D,U){const B=this.ctx,W=this.current,s=W.font,g=W.textRenderingMode,P=W.fontSize/W.fontSizeScale,v=g&a.TextRenderingMode.FILL_STROKE_MASK,F=!!(g&a.TextRenderingMode.ADD_TO_PATH_FLAG),j=W.patternFill&&!s.missingFile;let M;(s.disableFontFace||F||j)&&(M=s.getPathGenerator(this.commonObjs,p)),s.disableFontFace||j?(B.save(),B.translate(u,D),B.beginPath(),M(B,P),U&&B.setTransform(...U),(v===a.TextRenderingMode.FILL||v===a.TextRenderingMode.FILL_STROKE)&&B.fill(),(v===a.TextRenderingMode.STROKE||v===a.TextRenderingMode.FILL_STROKE)&&B.stroke(),B.restore()):((v===a.TextRenderingMode.FILL||v===a.TextRenderingMode.FILL_STROKE)&&B.fillText(p,u,D),(v===a.TextRenderingMode.STROKE||v===a.TextRenderingMode.FILL_STROKE)&&B.strokeText(p,u,D)),F&&(this.pendingTextPaths||(this.pendingTextPaths=[])).push({transform:(0,e.getCurrentTransform)(B),x:u,y:D,fontSize:P,addToPath:M})}get isFontSubpixelAAEnabled(){const{context:p}=this.cachedCanvases.getCanvas("isFontSubpixelAAEnabled",10,10);p.scale(1.5,1),p.fillText("I",0,10);const u=p.getImageData(0,0,10,10).data;let D=!1;for(let U=3;U<u.length;U+=4)if(u[U]>0&&u[U]<255){D=!0;break}return(0,a.shadow)(this,"isFontSubpixelAAEnabled",D)}showText(p){const u=this.current,D=u.font;if(D.isType3Font)return this.showType3Text(p);const U=u.fontSize;if(U===0)return;const B=this.ctx,W=u.fontSizeScale,s=u.charSpacing,g=u.wordSpacing,P=u.fontDirection,v=u.textHScale*P,F=p.length,j=D.vertical,M=j?1:-1,m=D.defaultVMetrics,N=U*u.fontMatrix[0],te=u.textRenderingMode===a.TextRenderingMode.FILL&&!D.disableFontFace&&!u.patternFill;B.save(),B.transform(...u.textMatrix),B.translate(u.x,u.y+u.textRise),P>0?B.scale(v,-1):B.scale(v,1);let H;if(u.patternFill){B.save();const re=u.fillColor.getPattern(B,this,(0,e.getCurrentTransformInverse)(B),k.PathType.FILL);H=(0,e.getCurrentTransform)(B),B.restore(),B.fillStyle=re}let J=u.lineWidth;const ee=u.textMatrixScale;if(ee===0||J===0){const re=u.textRenderingMode&a.TextRenderingMode.FILL_STROKE_MASK;(re===a.TextRenderingMode.STROKE||re===a.TextRenderingMode.FILL_STROKE)&&(J=this.getSinglePixelWidth())}else J/=ee;W!==1&&(B.scale(W,W),J/=W),B.lineWidth=J;let oe=0,de;for(de=0;de<F;++de){const re=p[de];if(typeof re=="number"){oe+=M*re*U/1e3;continue}let _e=!1;const me=(re.isSpace?g:0)+s,ge=re.fontChar,be=re.accent;let ve,xe,Ae=re.width;if(j){const Ee=re.vmetric||m,Pe=-(re.vmetric?Ee[1]:Ae*.5)*N,Ie=Ee[2]*N;Ae=Ee?-Ee[0]:Ae,ve=Pe/W,xe=(oe+Ie)/W}else ve=oe/W,xe=0;if(D.remeasure&&Ae>0){const Ee=B.measureText(ge).width*1e3/U*W;if(Ae<Ee&&this.isFontSubpixelAAEnabled){const Pe=Ae/Ee;_e=!0,B.save(),B.scale(Pe,1),ve/=Pe}else Ae!==Ee&&(ve+=(Ae-Ee)/2e3*U/W)}if(this.contentVisible&&(re.isInFont||D.missingFile)){if(te&&!be)B.fillText(ge,ve,xe);else if(this.paintChar(ge,ve,xe,H),be){const Ee=ve+U*be.offset.x/W,Pe=xe-U*be.offset.y/W;this.paintChar(be.fontChar,Ee,Pe,H)}}let Ce;j?Ce=Ae*N-me*P:Ce=Ae*N+me*P,oe+=Ce,_e&&B.restore()}j?u.y-=oe:u.x+=oe*v,B.restore(),this.compose()}showType3Text(p){const u=this.ctx,D=this.current,U=D.font,B=D.fontSize,W=D.fontDirection,s=U.vertical?1:-1,g=D.charSpacing,P=D.wordSpacing,v=D.textHScale*W,F=D.fontMatrix||a.FONT_IDENTITY_MATRIX,j=p.length,M=D.textRenderingMode===a.TextRenderingMode.INVISIBLE;let m,N,te,H;if(!(M||B===0)){for(this._cachedScaleForStroking=null,this._cachedGetSinglePixelWidth=null,u.save(),u.transform(...D.textMatrix),u.translate(D.x,D.y),u.scale(v,W),m=0;m<j;++m){if(N=p[m],typeof N=="number"){H=s*N*B/1e3,this.ctx.translate(H,0),D.x+=H*v;continue}const J=(N.isSpace?P:0)+g,ee=U.charProcOperatorList[N.operatorListId];if(!ee){(0,a.warn)(`Type3 character "${N.operatorListId}" is not available.`);continue}this.contentVisible&&(this.processingType3=N,this.save(),u.scale(B,B),u.transform(...F),this.executeOperatorList(ee),this.restore()),te=a.Util.applyTransform([N.width,0],F)[0]*B+J,u.translate(te,0),D.x+=te*v}u.restore(),this.processingType3=null}}setCharWidth(p,u){}setCharWidthAndBounds(p,u,D,U,B,W){this.ctx.rect(D,U,B-D,W-U),this.ctx.clip(),this.endPath()}getColorN_Pattern(p){let u;if(p[0]==="TilingPattern"){const D=p[1],U=this.baseTransform||(0,e.getCurrentTransform)(this.ctx),B={createCanvasGraphics:W=>new fe(W,this.commonObjs,this.objs,this.canvasFactory)};u=new k.TilingPattern(p,D,this.ctx,B,U)}else u=this._getPattern(p[1],p[2]);return u}setStrokeColorN(){this.current.strokeColor=this.getColorN_Pattern(arguments)}setFillColorN(){this.current.fillColor=this.getColorN_Pattern(arguments),this.current.patternFill=!0}setStrokeRGBColor(p,u,D){var B;const U=((B=this.selectColor)==null?void 0:B.call(this,p,u,D))||a.Util.makeHexColor(p,u,D);this.ctx.strokeStyle=U,this.current.strokeColor=U}setFillRGBColor(p,u,D){var B;const U=((B=this.selectColor)==null?void 0:B.call(this,p,u,D))||a.Util.makeHexColor(p,u,D);this.ctx.fillStyle=U,this.current.fillColor=U,this.current.patternFill=!1}_getPattern(p,u=null){let D;return this.cachedPatterns.has(p)?D=this.cachedPatterns.get(p):(D=(0,k.getShadingPattern)(this.objs.get(p)),this.cachedPatterns.set(p,D)),u&&(D.matrix=u),D}shadingFill(p){if(!this.contentVisible)return;const u=this.ctx;this.save();const D=this._getPattern(p);u.fillStyle=D.getPattern(u,this,(0,e.getCurrentTransformInverse)(u),k.PathType.SHADING);const U=(0,e.getCurrentTransformInverse)(u);if(U){const B=u.canvas,W=B.width,s=B.height,g=a.Util.applyTransform([0,0],U),P=a.Util.applyTransform([0,s],U),v=a.Util.applyTransform([W,0],U),F=a.Util.applyTransform([W,s],U),j=Math.min(g[0],P[0],v[0],F[0]),M=Math.min(g[1],P[1],v[1],F[1]),m=Math.max(g[0],P[0],v[0],F[0]),N=Math.max(g[1],P[1],v[1],F[1]);this.ctx.fillRect(j,M,m-j,N-M)}else this.ctx.fillRect(-1e10,-1e10,2e10,2e10);this.compose(this.current.getClippedPathBoundingBox()),this.restore()}beginInlineImage(){(0,a.unreachable)("Should not call beginInlineImage")}beginImageData(){(0,a.unreachable)("Should not call beginImageData")}paintFormXObjectBegin(p,u){if(this.contentVisible&&(this.save(),this.baseTransformStack.push(this.baseTransform),Array.isArray(p)&&p.length===6&&this.transform(...p),this.baseTransform=(0,e.getCurrentTransform)(this.ctx),u)){const D=u[2]-u[0],U=u[3]-u[1];this.ctx.rect(u[0],u[1],D,U),this.current.updateRectMinMax((0,e.getCurrentTransform)(this.ctx),u),this.clip(),this.endPath()}}paintFormXObjectEnd(){this.contentVisible&&(this.restore(),this.baseTransform=this.baseTransformStack.pop())}beginGroup(p){if(!this.contentVisible)return;this.save(),this.inSMaskMode&&(this.endSMaskMode(),this.current.activeSMask=null);const u=this.ctx;p.isolated||(0,a.info)("TODO: Support non-isolated groups."),p.knockout&&(0,a.warn)("Knockout groups not supported.");const D=(0,e.getCurrentTransform)(u);if(p.matrix&&u.transform(...p.matrix),!p.bbox)throw new Error("Bounding box is required.");let U=a.Util.getAxialAlignedBoundingBox(p.bbox,(0,e.getCurrentTransform)(u));const B=[0,0,u.canvas.width,u.canvas.height];U=a.Util.intersect(U,B)||[0,0,0,0];const W=Math.floor(U[0]),s=Math.floor(U[1]);let g=Math.max(Math.ceil(U[2])-W,1),P=Math.max(Math.ceil(U[3])-s,1),v=1,F=1;g>C&&(v=g/C,g=C),P>C&&(F=P/C,P=C),this.current.startNewPathAndClipBox([0,0,g,P]);let j="groupAt"+this.groupLevel;p.smask&&(j+="_smask_"+this.smaskCounter++%2);const M=this.cachedCanvases.getCanvas(j,g,P),m=M.context;m.scale(1/v,1/F),m.translate(-W,-s),m.transform(...D),p.smask?this.smaskStack.push({canvas:M.canvas,context:m,offsetX:W,offsetY:s,scaleX:v,scaleY:F,subtype:p.smask.subtype,backdrop:p.smask.backdrop,transferMap:p.smask.transferMap||null,startTransformInverse:null}):(u.setTransform(1,0,0,1,0,0),u.translate(W,s),u.scale(v,F),u.save()),l(u,m),this.ctx=m,this.setGState([["BM","source-over"],["ca",1],["CA",1]]),this.groupStack.push(u),this.groupLevel++}endGroup(p){if(!this.contentVisible)return;this.groupLevel--;const u=this.ctx,D=this.groupStack.pop();if(this.ctx=D,this.ctx.imageSmoothingEnabled=!1,p.smask)this.tempSMask=this.smaskStack.pop(),this.restore();else{this.ctx.restore();const U=(0,e.getCurrentTransform)(this.ctx);this.restore(),this.ctx.save(),this.ctx.setTransform(...U);const B=a.Util.getAxialAlignedBoundingBox([0,0,u.canvas.width,u.canvas.height],U);this.ctx.drawImage(u.canvas,0,0),this.ctx.restore(),this.compose(B)}}beginAnnotation(p,u,D,U,B){if(ce(this,ne,ut).call(this),n(this.ctx,this.foregroundColor),this.ctx.save(),this.save(),this.baseTransform&&this.ctx.setTransform(...this.baseTransform),Array.isArray(u)&&u.length===4){const W=u[2]-u[0],s=u[3]-u[1];if(B&&this.annotationCanvasMap){D=D.slice(),D[4]-=u[0],D[5]-=u[1],u=u.slice(),u[0]=u[1]=0,u[2]=W,u[3]=s;const[g,P]=a.Util.singularValueDecompose2dScale((0,e.getCurrentTransform)(this.ctx)),{viewportScale:v}=this,F=Math.ceil(W*this.outputScaleX*v),j=Math.ceil(s*this.outputScaleY*v);this.annotationCanvas=this.canvasFactory.create(F,j);const{canvas:M,context:m}=this.annotationCanvas;this.annotationCanvasMap.set(p,M),this.annotationCanvas.savedCtx=this.ctx,this.ctx=m,this.ctx.setTransform(g,0,0,-P,0,s*P),n(this.ctx,this.foregroundColor)}else n(this.ctx,this.foregroundColor),this.ctx.rect(u[0],u[1],W,s),this.ctx.clip(),this.endPath()}this.current=new b(this.ctx.canvas.width,this.ctx.canvas.height),this.transform(...D),this.transform(...U)}endAnnotation(){this.annotationCanvas&&(this.ctx=this.annotationCanvas.savedCtx,delete this.annotationCanvas.savedCtx,delete this.annotationCanvas)}paintImageMaskXObject(p){if(!this.contentVisible)return;const u=p.count;p=this.getObject(p.data,p),p.count=u;const D=this.ctx,U=this.processingType3;if(U&&(U.compiled===void 0&&(U.compiled=x(p)),U.compiled)){U.compiled(D);return}const B=this._createMaskCanvas(p),W=B.canvas;D.save(),D.setTransform(1,0,0,1,0,0),D.drawImage(W,B.offsetX,B.offsetY),D.restore(),this.compose()}paintImageMaskXObjectRepeat(p,u,D=0,U=0,B,W){if(!this.contentVisible)return;p=this.getObject(p.data,p);const s=this.ctx;s.save();const g=(0,e.getCurrentTransform)(s);s.transform(u,D,U,B,0,0);const P=this._createMaskCanvas(p);s.setTransform(1,0,0,1,0,0);for(let v=0,F=W.length;v<F;v+=2){const j=a.Util.transform(g,[u,D,U,B,W[v],W[v+1]]),[M,m]=a.Util.applyTransform([0,0],j);s.drawImage(P.canvas,M,m)}s.restore(),this.compose()}paintImageMaskXObjectGroup(p){if(!this.contentVisible)return;const u=this.ctx,D=this.current.fillColor,U=this.current.patternFill;for(const B of p){const{data:W,width:s,height:g,transform:P}=B,v=this.cachedCanvases.getCanvas("maskCanvas",s,g),F=v.context;F.save();const j=this.getObject(W,B);i(F,j),F.globalCompositeOperation="source-in",F.fillStyle=U?D.getPattern(F,this,(0,e.getCurrentTransformInverse)(u),k.PathType.FILL):D,F.fillRect(0,0,s,g),F.restore(),u.save(),u.transform(...P),u.scale(1,-1),c(u,v.canvas,0,0,s,g,0,-1,1,1),u.restore()}this.compose()}paintImageXObject(p){if(!this.contentVisible)return;const u=this.getObject(p);if(!u){(0,a.warn)("Dependent image isn't ready yet");return}this.paintInlineImageXObject(u)}paintImageXObjectRepeat(p,u,D,U){if(!this.contentVisible)return;const B=this.getObject(p);if(!B){(0,a.warn)("Dependent image isn't ready yet");return}const W=B.width,s=B.height,g=[];for(let P=0,v=U.length;P<v;P+=2)g.push({transform:[u,0,0,D,U[P],U[P+1]],x:0,y:0,w:W,h:s});this.paintInlineImageXObjectGroup(B,g)}paintInlineImageXObject(p){if(!this.contentVisible)return;const u=p.width,D=p.height,U=this.ctx;this.save(),U.scale(1/u,-1/D);let B;if(typeof HTMLElement=="function"&&p instanceof HTMLElement||!p.data)B=p;else{const P=this.cachedCanvases.getCanvas("inlineImage",u,D),v=P.context;d(v,p,this.current.transferMaps),B=P.canvas}const W=this._scaleImage(B,(0,e.getCurrentTransformInverse)(U));U.imageSmoothingEnabled=ae((0,e.getCurrentTransform)(U),p.interpolate);const[s,g]=c(U,W.img,0,0,W.paintWidth,W.paintHeight,0,-D,u,D);if(this.imageLayer){const[P,v]=a.Util.applyTransform([0,-D],(0,e.getCurrentTransform)(this.ctx));this.imageLayer.appendImage({imgData:p,left:P,top:v,width:s,height:g})}this.compose(),this.restore()}paintInlineImageXObjectGroup(p,u){if(!this.contentVisible)return;const D=this.ctx,U=p.width,B=p.height,W=this.cachedCanvases.getCanvas("inlineImage",U,B),s=W.context;d(s,p,this.current.transferMaps);for(const g of u){if(D.save(),D.transform(...g.transform),D.scale(1,-1),c(D,W.canvas,g.x,g.y,g.w,g.h,0,-1,1,1),this.imageLayer){const[P,v]=a.Util.applyTransform([g.x,g.y],(0,e.getCurrentTransform)(this.ctx));this.imageLayer.appendImage({imgData:p,left:P,top:v,width:U,height:B})}D.restore()}this.compose()}paintSolidColorImageMask(){this.contentVisible&&(this.ctx.fillRect(0,0,1,1),this.compose())}markPoint(p){}markPointProps(p,u){}beginMarkedContent(p){this.markedContentStack.push({visible:!0})}beginMarkedContentProps(p,u){p==="OC"?this.markedContentStack.push({visible:this.optionalContentConfig.isVisible(u)}):this.markedContentStack.push({visible:!0}),this.contentVisible=this.isContentVisible()}endMarkedContent(){this.markedContentStack.pop(),this.contentVisible=this.isContentVisible()}beginCompat(){}endCompat(){}consumePath(p){const u=this.current.isEmptyClip();this.pendingClip&&this.current.updateClipFromPath(),this.pendingClip||this.compose(p);const D=this.ctx;this.pendingClip&&(u||(this.pendingClip===V?D.clip("evenodd"):D.clip()),this.pendingClip=null),this.current.startNewPathAndClipBox(this.current.clipBox),D.beginPath()}getSinglePixelWidth(){if(!this._cachedGetSinglePixelWidth){const p=(0,e.getCurrentTransform)(this.ctx);if(p[1]===0&&p[2]===0)this._cachedGetSinglePixelWidth=1/Math.min(Math.abs(p[0]),Math.abs(p[3]));else{const u=Math.abs(p[0]*p[3]-p[2]*p[1]),D=Math.hypot(p[0],p[2]),U=Math.hypot(p[1],p[3]);this._cachedGetSinglePixelWidth=Math.max(D,U)/u}}return this._cachedGetSinglePixelWidth}getScaleForStroking(){if(!this._cachedScaleForStroking){const{lineWidth:p}=this.current,u=(0,e.getCurrentTransform)(this.ctx);let D,U;if(u[1]===0&&u[2]===0){const B=Math.abs(u[0]),W=Math.abs(u[3]);if(p===0)D=1/B,U=1/W;else{const s=B*p,g=W*p;D=s<1?1/s:1,U=g<1?1/g:1}}else{const B=Math.abs(u[0]*u[3]-u[2]*u[1]),W=Math.hypot(u[0],u[1]),s=Math.hypot(u[2],u[3]);if(p===0)D=s/B,U=W/B;else{const g=p*B;D=s>g?s/g:1,U=W>g?W/g:1}}this._cachedScaleForStroking=[D,U]}return this._cachedScaleForStroking}rescaleAndStroke(p){const{ctx:u}=this,{lineWidth:D}=this.current,[U,B]=this.getScaleForStroking();if(u.lineWidth=D||1,U===1&&B===1){u.stroke();return}let W,s,g;p&&(W=(0,e.getCurrentTransform)(u),s=u.getLineDash().slice(),g=u.lineDashOffset),u.scale(U,B);const P=Math.max(U,B);u.setLineDash(u.getLineDash().map(v=>v/P)),u.lineDashOffset/=P,u.stroke(),p&&(u.setTransform(...W),u.setLineDash(s),u.lineDashOffset=g)}isContentVisible(){for(let p=this.markedContentStack.length-1;p>=0;p--)if(!this.markedContentStack[p].visible)return!1;return!0}};ne=new WeakSet,ut=function(){for(;this.stateStack.length||this.inSMaskMode;)this.restore();this.ctx.restore(),this.transparentCanvas&&(this.ctx=this.compositeCtx,this.ctx.save(),this.ctx.setTransform(1,0,0,1,0,0),this.ctx.drawImage(this.transparentCanvas,0,0),this.ctx.restore(),this.transparentCanvas=null)};let X=fe;r.CanvasGraphics=X;for(const $ in a.OPS)X.prototype[$]!==void 0&&(X.prototype[a.OPS[$]]=X.prototype[$])},(A,r,y)=>{Object.defineProperty(r,"__esModule",{value:!0}),r.TilingPattern=r.PathType=void 0,r.getShadingPattern=h;var e=y(1),a=y(8),k=y(3);const O={FILL:"Fill",STROKE:"Stroke",SHADING:"Shading"};r.PathType=O;function S(c,x){if(!x||k.isNodeJS)return;const b=x[2]-x[0],d=x[3]-x[1],i=new Path2D;i.rect(x[0],x[1],b,d),c.clip(i)}class _{constructor(){this.constructor===_&&(0,e.unreachable)("Cannot initialize BaseShadingPattern.")}getPattern(){(0,e.unreachable)("Abstract method `getPattern` called.")}}class f extends _{constructor(x){super(),this._type=x[1],this._bbox=x[2],this._colorStops=x[3],this._p0=x[4],this._p1=x[5],this._r0=x[6],this._r1=x[7],this.matrix=null}_createGradient(x){let b;this._type==="axial"?b=x.createLinearGradient(this._p0[0],this._p0[1],this._p1[0],this._p1[1]):this._type==="radial"&&(b=x.createRadialGradient(this._p0[0],this._p0[1],this._r0,this._p1[0],this._p1[1],this._r1));for(const d of this._colorStops)b.addColorStop(d[0],d[1]);return b}getPattern(x,b,d,i){let l;if(i===O.STROKE||i===O.FILL){const n=b.current.getClippedPathBoundingBox(i,(0,a.getCurrentTransform)(x))||[0,0,0,0],E=Math.ceil(n[2]-n[0])||1,R=Math.ceil(n[3]-n[1])||1,G=b.cachedCanvases.getCanvas("pattern",E,R,!0),q=G.context;q.clearRect(0,0,q.canvas.width,q.canvas.height),q.beginPath(),q.rect(0,0,q.canvas.width,q.canvas.height),q.translate(-n[0],-n[1]),d=e.Util.transform(d,[1,0,0,1,n[0],n[1]]),q.transform(...b.baseTransform),this.matrix&&q.transform(...this.matrix),S(q,this._bbox),q.fillStyle=this._createGradient(q),q.fill(),l=x.createPattern(G.canvas,"no-repeat");const se=new DOMMatrix(d);try{l.setTransform(se)}catch(ae){(0,e.warn)(`RadialAxialShadingPattern.getPattern: "${ae==null?void 0:ae.message}".`)}}else S(x,this._bbox),l=this._createGradient(x);return l}}function C(c,x,b,d,i,l,n,E){const R=x.coords,G=x.colors,q=c.data,se=c.width*4;let ae;R[b+1]>R[d+1]&&(ae=b,b=d,d=ae,ae=l,l=n,n=ae),R[d+1]>R[i+1]&&(ae=d,d=i,i=ae,ae=n,n=E,E=ae),R[b+1]>R[d+1]&&(ae=b,b=d,d=ae,ae=l,l=n,n=ae);const Z=(R[b]+x.offsetX)*x.scaleX,Q=(R[b+1]+x.offsetY)*x.scaleY,z=(R[d]+x.offsetX)*x.scaleX,V=(R[d+1]+x.offsetY)*x.scaleY,X=(R[i]+x.offsetX)*x.scaleX,ne=(R[i+1]+x.offsetY)*x.scaleY;if(Q>=ne)return;const le=G[l],fe=G[l+1],$=G[l+2],p=G[n],u=G[n+1],D=G[n+2],U=G[E],B=G[E+1],W=G[E+2],s=Math.round(Q),g=Math.round(ne);let P,v,F,j,M,m,N,te;for(let H=s;H<=g;H++){if(H<V){let re;H<Q?re=0:re=(Q-H)/(Q-V),P=Z-(Z-z)*re,v=le-(le-p)*re,F=fe-(fe-u)*re,j=$-($-D)*re}else{let re;H>ne?re=1:V===ne?re=0:re=(V-H)/(V-ne),P=z-(z-X)*re,v=p-(p-U)*re,F=u-(u-B)*re,j=D-(D-W)*re}let J;H<Q?J=0:H>ne?J=1:J=(Q-H)/(Q-ne),M=Z-(Z-X)*J,m=le-(le-U)*J,N=fe-(fe-B)*J,te=$-($-W)*J;const ee=Math.round(Math.min(P,M)),oe=Math.round(Math.max(P,M));let de=se*H+ee*4;for(let re=ee;re<=oe;re++)J=(P-re)/(P-M),J<0?J=0:J>1&&(J=1),q[de++]=v-(v-m)*J|0,q[de++]=F-(F-N)*J|0,q[de++]=j-(j-te)*J|0,q[de++]=255}}function L(c,x,b){const d=x.coords,i=x.colors;let l,n;switch(x.type){case"lattice":const E=x.verticesPerRow,R=Math.floor(d.length/E)-1,G=E-1;for(l=0;l<R;l++){let q=l*E;for(let se=0;se<G;se++,q++)C(c,b,d[q],d[q+1],d[q+E],i[q],i[q+1],i[q+E]),C(c,b,d[q+E+1],d[q+1],d[q+E],i[q+E+1],i[q+1],i[q+E])}break;case"triangles":for(l=0,n=d.length;l<n;l+=3)C(c,b,d[l],d[l+1],d[l+2],i[l],i[l+1],i[l+2]);break;default:throw new Error("illegal figure")}}class w extends _{constructor(x){super(),this._coords=x[2],this._colors=x[3],this._figures=x[4],this._bounds=x[5],this._bbox=x[7],this._background=x[8],this.matrix=null}_createMeshCanvas(x,b,d){const E=Math.floor(this._bounds[0]),R=Math.floor(this._bounds[1]),G=Math.ceil(this._bounds[2])-E,q=Math.ceil(this._bounds[3])-R,se=Math.min(Math.ceil(Math.abs(G*x[0]*1.1)),3e3),ae=Math.min(Math.ceil(Math.abs(q*x[1]*1.1)),3e3),Z=G/se,Q=q/ae,z={coords:this._coords,colors:this._colors,offsetX:-E,offsetY:-R,scaleX:1/Z,scaleY:1/Q},V=se+2*2,X=ae+2*2,ne=d.getCanvas("mesh",V,X,!1),le=ne.context,fe=le.createImageData(se,ae);if(b){const p=fe.data;for(let u=0,D=p.length;u<D;u+=4)p[u]=b[0],p[u+1]=b[1],p[u+2]=b[2],p[u+3]=255}for(const p of this._figures)L(fe,p,z);return le.putImageData(fe,2,2),{canvas:ne.canvas,offsetX:E-2*Z,offsetY:R-2*Q,scaleX:Z,scaleY:Q}}getPattern(x,b,d,i){S(x,this._bbox);let l;if(i===O.SHADING)l=e.Util.singularValueDecompose2dScale((0,a.getCurrentTransform)(x));else if(l=e.Util.singularValueDecompose2dScale(b.baseTransform),this.matrix){const E=e.Util.singularValueDecompose2dScale(this.matrix);l=[l[0]*E[0],l[1]*E[1]]}const n=this._createMeshCanvas(l,i===O.SHADING?null:this._background,b.cachedCanvases);return i!==O.SHADING&&(x.setTransform(...b.baseTransform),this.matrix&&x.transform(...this.matrix)),x.translate(n.offsetX,n.offsetY),x.scale(n.scaleX,n.scaleY),x.createPattern(n.canvas,"no-repeat")}}class T extends _{getPattern(){return"hotpink"}}function h(c){switch(c[0]){case"RadialAxial":return new f(c);case"Mesh":return new w(c);case"Dummy":return new T}throw new Error(`Unknown IR type: ${c[0]}`)}const t={COLORED:1,UNCOLORED:2};class o{static get MAX_PATTERN_SIZE(){return(0,e.shadow)(this,"MAX_PATTERN_SIZE",3e3)}constructor(x,b,d,i,l){this.operatorList=x[2],this.matrix=x[3]||[1,0,0,1,0,0],this.bbox=x[4],this.xstep=x[5],this.ystep=x[6],this.paintType=x[7],this.tilingType=x[8],this.color=b,this.ctx=d,this.canvasGraphicsFactory=i,this.baseTransform=l}createPatternCanvas(x){const b=this.operatorList,d=this.bbox,i=this.xstep,l=this.ystep,n=this.paintType,E=this.tilingType,R=this.color,G=this.canvasGraphicsFactory;(0,e.info)("TilingType: "+E);const q=d[0],se=d[1],ae=d[2],Z=d[3],Q=e.Util.singularValueDecompose2dScale(this.matrix),z=e.Util.singularValueDecompose2dScale(this.baseTransform),V=[Q[0]*z[0],Q[1]*z[1]],X=this.getSizeAndScale(i,this.ctx.canvas.width,V[0]),ne=this.getSizeAndScale(l,this.ctx.canvas.height,V[1]),le=x.cachedCanvases.getCanvas("pattern",X.size,ne.size,!0),fe=le.context,$=G.createCanvasGraphics(fe);$.groupLevel=x.groupLevel,this.setFillAndStrokeStyleToContext($,n,R);let p=q,u=se,D=ae,U=Z;return q<0&&(p=0,D+=Math.abs(q)),se<0&&(u=0,U+=Math.abs(se)),fe.translate(-(X.scale*p),-(ne.scale*u)),$.transform(X.scale,0,0,ne.scale,0,0),fe.save(),this.clipBbox($,p,u,D,U),$.baseTransform=(0,a.getCurrentTransform)($.ctx),$.executeOperatorList(b),$.endDrawing(),{canvas:le.canvas,scaleX:X.scale,scaleY:ne.scale,offsetX:p,offsetY:u}}getSizeAndScale(x,b,d){x=Math.abs(x);const i=Math.max(o.MAX_PATTERN_SIZE,b);let l=Math.ceil(x*d);return l>=i?l=i:d=l/x,{scale:d,size:l}}clipBbox(x,b,d,i,l){const n=i-b,E=l-d;x.ctx.rect(b,d,n,E),x.current.updateRectMinMax((0,a.getCurrentTransform)(x.ctx),[b,d,i,l]),x.clip(),x.endPath()}setFillAndStrokeStyleToContext(x,b,d){const i=x.ctx,l=x.current;switch(b){case t.COLORED:const n=this.ctx;i.fillStyle=n.fillStyle,i.strokeStyle=n.strokeStyle,l.fillColor=n.fillStyle,l.strokeColor=n.strokeStyle;break;case t.UNCOLORED:const E=e.Util.makeHexColor(d[0],d[1],d[2]);i.fillStyle=E,i.strokeStyle=E,l.fillColor=E,l.strokeColor=E;break;default:throw new e.FormatError(`Unsupported paint type: ${b}`)}}getPattern(x,b,d,i){let l=d;i!==O.SHADING&&(l=e.Util.transform(l,b.baseTransform),this.matrix&&(l=e.Util.transform(l,this.matrix)));const n=this.createPatternCanvas(b);let E=new DOMMatrix(l);E=E.translate(n.offsetX,n.offsetY),E=E.scale(1/n.scaleX,1/n.scaleY);const R=x.createPattern(n.canvas,"repeat");try{R.setTransform(E)}catch(G){(0,e.warn)(`TilingPattern.getPattern: "${G==null?void 0:G.message}".`)}return R}}r.TilingPattern=o},(A,r,y)=>{Object.defineProperty(r,"__esModule",{value:!0}),r.applyMaskImageData=a;var e=y(1);function a({src:k,srcPos:O=0,dest:S,destPos:_=0,width:f,height:C,inverseDecode:L=!1}){const w=e.FeatureTest.isLittleEndian?4278190080:255,[T,h]=L?[0,w]:[w,0],t=f>>3,o=f&7,c=k.length;S=new Uint32Array(S.buffer);for(let x=0;x<C;x++){for(const d=O+t;O<d;O++){const i=O<c?k[O]:255;S[_++]=i&128?h:T,S[_++]=i&64?h:T,S[_++]=i&32?h:T,S[_++]=i&16?h:T,S[_++]=i&8?h:T,S[_++]=i&4?h:T,S[_++]=i&2?h:T,S[_++]=i&1?h:T}if(o===0)continue;const b=O<c?k[O++]:255;for(let d=0;d<o;d++)S[_++]=b&1<<7-d?h:T}return{srcPos:O,destPos:_}}},(A,r)=>{Object.defineProperty(r,"__esModule",{value:!0}),r.GlobalWorkerOptions=void 0;const y=Object.create(null);r.GlobalWorkerOptions=y,y.workerPort=y.workerPort===void 0?null:y.workerPort,y.workerSrc=y.workerSrc===void 0?"":y.workerSrc},(A,r,y)=>{Object.defineProperty(r,"__esModule",{value:!0}),r.MessageHandler=void 0;var e=y(1);const a={DATA:1,ERROR:2},k={CANCEL:1,CANCEL_COMPLETE:2,CLOSE:3,ENQUEUE:4,ERROR:5,PULL:6,PULL_COMPLETE:7,START_COMPLETE:8};function O(_){switch(_ instanceof Error||typeof _=="object"&&_!==null||(0,e.unreachable)('wrapReason: Expected "reason" to be a (possibly cloned) Error.'),_.name){case"AbortException":return new e.AbortException(_.message);case"MissingPDFException":return new e.MissingPDFException(_.message);case"PasswordException":return new e.PasswordException(_.message,_.code);case"UnexpectedResponseException":return new e.UnexpectedResponseException(_.message,_.status);case"UnknownErrorException":return new e.UnknownErrorException(_.message,_.details);default:return new e.UnknownErrorException(_.message,_.toString())}}class S{constructor(f,C,L){this.sourceName=f,this.targetName=C,this.comObj=L,this.callbackId=1,this.streamId=1,this.streamSinks=Object.create(null),this.streamControllers=Object.create(null),this.callbackCapabilities=Object.create(null),this.actionHandler=Object.create(null),this._onComObjOnMessage=w=>{const T=w.data;if(T.targetName!==this.sourceName)return;if(T.stream){this._processStreamMessage(T);return}if(T.callback){const t=T.callbackId,o=this.callbackCapabilities[t];if(!o)throw new Error(`Cannot resolve callback ${t}`);if(delete this.callbackCapabilities[t],T.callback===a.DATA)o.resolve(T.data);else if(T.callback===a.ERROR)o.reject(O(T.reason));else throw new Error("Unexpected callback case");return}const h=this.actionHandler[T.action];if(!h)throw new Error(`Unknown action from worker: ${T.action}`);if(T.callbackId){const t=this.sourceName,o=T.sourceName;new Promise(function(c){c(h(T.data))}).then(function(c){L.postMessage({sourceName:t,targetName:o,callback:a.DATA,callbackId:T.callbackId,data:c})},function(c){L.postMessage({sourceName:t,targetName:o,callback:a.ERROR,callbackId:T.callbackId,reason:O(c)})});return}if(T.streamId){this._createStreamSink(T);return}h(T.data)},L.addEventListener("message",this._onComObjOnMessage)}on(f,C){const L=this.actionHandler;if(L[f])throw new Error(`There is already an actionName called "${f}"`);L[f]=C}send(f,C,L){this.comObj.postMessage({sourceName:this.sourceName,targetName:this.targetName,action:f,data:C},L)}sendWithPromise(f,C,L){const w=this.callbackId++,T=(0,e.createPromiseCapability)();this.callbackCapabilities[w]=T;try{this.comObj.postMessage({sourceName:this.sourceName,targetName:this.targetName,action:f,callbackId:w,data:C},L)}catch(h){T.reject(h)}return T.promise}sendWithStream(f,C,L,w){const T=this.streamId++,h=this.sourceName,t=this.targetName,o=this.comObj;return new ReadableStream({start:c=>{const x=(0,e.createPromiseCapability)();return this.streamControllers[T]={controller:c,startCall:x,pullCall:null,cancelCall:null,isClosed:!1},o.postMessage({sourceName:h,targetName:t,action:f,streamId:T,data:C,desiredSize:c.desiredSize},w),x.promise},pull:c=>{const x=(0,e.createPromiseCapability)();return this.streamControllers[T].pullCall=x,o.postMessage({sourceName:h,targetName:t,stream:k.PULL,streamId:T,desiredSize:c.desiredSize}),x.promise},cancel:c=>{(0,e.assert)(c instanceof Error,"cancel must have a valid reason");const x=(0,e.createPromiseCapability)();return this.streamControllers[T].cancelCall=x,this.streamControllers[T].isClosed=!0,o.postMessage({sourceName:h,targetName:t,stream:k.CANCEL,streamId:T,reason:O(c)}),x.promise}},L)}_createStreamSink(f){const C=f.streamId,L=this.sourceName,w=f.sourceName,T=this.comObj,h=this,t=this.actionHandler[f.action],o={enqueue(c,x=1,b){if(this.isCancelled)return;const d=this.desiredSize;this.desiredSize-=x,d>0&&this.desiredSize<=0&&(this.sinkCapability=(0,e.createPromiseCapability)(),this.ready=this.sinkCapability.promise),T.postMessage({sourceName:L,targetName:w,stream:k.ENQUEUE,streamId:C,chunk:c},b)},close(){this.isCancelled||(this.isCancelled=!0,T.postMessage({sourceName:L,targetName:w,stream:k.CLOSE,streamId:C}),delete h.streamSinks[C])},error(c){(0,e.assert)(c instanceof Error,"error must have a valid reason"),!this.isCancelled&&(this.isCancelled=!0,T.postMessage({sourceName:L,targetName:w,stream:k.ERROR,streamId:C,reason:O(c)}))},sinkCapability:(0,e.createPromiseCapability)(),onPull:null,onCancel:null,isCancelled:!1,desiredSize:f.desiredSize,ready:null};o.sinkCapability.resolve(),o.ready=o.sinkCapability.promise,this.streamSinks[C]=o,new Promise(function(c){c(t(f.data,o))}).then(function(){T.postMessage({sourceName:L,targetName:w,stream:k.START_COMPLETE,streamId:C,success:!0})},function(c){T.postMessage({sourceName:L,targetName:w,stream:k.START_COMPLETE,streamId:C,reason:O(c)})})}_processStreamMessage(f){const C=f.streamId,L=this.sourceName,w=f.sourceName,T=this.comObj,h=this.streamControllers[C],t=this.streamSinks[C];switch(f.stream){case k.START_COMPLETE:f.success?h.startCall.resolve():h.startCall.reject(O(f.reason));break;case k.PULL_COMPLETE:f.success?h.pullCall.resolve():h.pullCall.reject(O(f.reason));break;case k.PULL:if(!t){T.postMessage({sourceName:L,targetName:w,stream:k.PULL_COMPLETE,streamId:C,success:!0});break}t.desiredSize<=0&&f.desiredSize>0&&t.sinkCapability.resolve(),t.desiredSize=f.desiredSize,new Promise(function(o){o(t.onPull&&t.onPull())}).then(function(){T.postMessage({sourceName:L,targetName:w,stream:k.PULL_COMPLETE,streamId:C,success:!0})},function(o){T.postMessage({sourceName:L,targetName:w,stream:k.PULL_COMPLETE,streamId:C,reason:O(o)})});break;case k.ENQUEUE:if((0,e.assert)(h,"enqueue should have stream controller"),h.isClosed)break;h.controller.enqueue(f.chunk);break;case k.CLOSE:if((0,e.assert)(h,"close should have stream controller"),h.isClosed)break;h.isClosed=!0,h.controller.close(),this._deleteStreamController(h,C);break;case k.ERROR:(0,e.assert)(h,"error should have stream controller"),h.controller.error(O(f.reason)),this._deleteStreamController(h,C);break;case k.CANCEL_COMPLETE:f.success?h.cancelCall.resolve():h.cancelCall.reject(O(f.reason)),this._deleteStreamController(h,C);break;case k.CANCEL:if(!t)break;new Promise(function(o){o(t.onCancel&&t.onCancel(O(f.reason)))}).then(function(){T.postMessage({sourceName:L,targetName:w,stream:k.CANCEL_COMPLETE,streamId:C,success:!0})},function(o){T.postMessage({sourceName:L,targetName:w,stream:k.CANCEL_COMPLETE,streamId:C,reason:O(o)})}),t.sinkCapability.reject(O(f.reason)),t.isCancelled=!0,delete this.streamSinks[C];break;default:throw new Error("Unexpected stream case")}}async _deleteStreamController(f,C){await Promise.allSettled([f.startCall&&f.startCall.promise,f.pullCall&&f.pullCall.promise,f.cancelCall&&f.cancelCall.promise]),delete this.streamControllers[C]}destroy(){this.comObj.removeEventListener("message",this._onComObjOnMessage)}}r.MessageHandler=S},(A,r,y)=>{var k,O;Object.defineProperty(r,"__esModule",{value:!0}),r.Metadata=void 0;var e=y(1);class a{constructor({parsedData:_,rawData:f}){ue(this,k);ue(this,O);he(this,k,_),he(this,O,f)}getRaw(){return I(this,O)}get(_){return I(this,k).get(_)??null}getAll(){return(0,e.objectFromMap)(I(this,k))}has(_){return I(this,k).has(_)}}k=new WeakMap,O=new WeakMap,r.Metadata=a},(A,r,y)=>{var S,_,f,C,L,w,ht;Object.defineProperty(r,"__esModule",{value:!0}),r.OptionalContentConfig=void 0;var e=y(1);const a=Symbol("INTERNAL");class k{constructor(t,o){ue(this,S,!0);this.name=t,this.intent=o}get visible(){return I(this,S)}_setVisible(t,o){t!==a&&(0,e.unreachable)("Internal method `_setVisible` called."),he(this,S,o)}}S=new WeakMap;class O{constructor(t){ue(this,w);ue(this,_,!0);ue(this,f,new Map);ue(this,C,null);ue(this,L,null);if(this.name=null,this.creator=null,t!==null){this.name=t.name,this.creator=t.creator,he(this,L,t.order);for(const o of t.groups)I(this,f).set(o.id,new k(o.name,o.intent));if(t.baseState==="OFF")for(const o of I(this,f).values())o._setVisible(a,!1);for(const o of t.on)I(this,f).get(o)._setVisible(a,!0);for(const o of t.off)I(this,f).get(o)._setVisible(a,!1);he(this,C,new Map);for(const[o,c]of I(this,f))I(this,C).set(o,c.visible)}}isVisible(t){if(I(this,f).size===0)return!0;if(!t)return(0,e.warn)("Optional content group not defined."),!0;if(t.type==="OCG")return I(this,f).has(t.id)?I(this,f).get(t.id).visible:((0,e.warn)(`Optional content group not found: ${t.id}`),!0);if(t.type==="OCMD"){if(t.expression)return ce(this,w,ht).call(this,t.expression);if(!t.policy||t.policy==="AnyOn"){for(const o of t.ids){if(!I(this,f).has(o))return(0,e.warn)(`Optional content group not found: ${o}`),!0;if(I(this,f).get(o).visible)return!0}return!1}else if(t.policy==="AllOn"){for(const o of t.ids){if(!I(this,f).has(o))return(0,e.warn)(`Optional content group not found: ${o}`),!0;if(!I(this,f).get(o).visible)return!1}return!0}else if(t.policy==="AnyOff"){for(const o of t.ids){if(!I(this,f).has(o))return(0,e.warn)(`Optional content group not found: ${o}`),!0;if(!I(this,f).get(o).visible)return!0}return!1}else if(t.policy==="AllOff"){for(const o of t.ids){if(!I(this,f).has(o))return(0,e.warn)(`Optional content group not found: ${o}`),!0;if(I(this,f).get(o).visible)return!1}return!0}return(0,e.warn)(`Unknown optional content policy ${t.policy}.`),!0}return(0,e.warn)(`Unknown group type ${t.type}.`),!0}setVisibility(t,o=!0){if(!I(this,f).has(t)){(0,e.warn)(`Optional content group not found: ${t}`);return}I(this,f).get(t)._setVisible(a,!!o),he(this,_,null)}get hasInitialVisibility(){if(I(this,_)!==null)return I(this,_);for(const[t,o]of I(this,f)){const c=I(this,C).get(t);if(o.visible!==c)return he(this,_,!1)}return he(this,_,!0)}getOrder(){return I(this,f).size?I(this,L)?I(this,L).slice():[...I(this,f).keys()]:null}getGroups(){return I(this,f).size>0?(0,e.objectFromMap)(I(this,f)):null}getGroup(t){return I(this,f).get(t)||null}}_=new WeakMap,f=new WeakMap,C=new WeakMap,L=new WeakMap,w=new WeakSet,ht=function(t){const o=t.length;if(o<2)return!0;const c=t[0];for(let x=1;x<o;x++){const b=t[x];let d;if(Array.isArray(b))d=ce(this,w,ht).call(this,b);else if(I(this,f).has(b))d=I(this,f).get(b).visible;else return(0,e.warn)(`Optional content group not found: ${b}`),!0;switch(c){case"And":if(!d)return!1;break;case"Or":if(d)return!0;break;case"Not":return!d;default:return!0}}return c==="And"},r.OptionalContentConfig=O},(A,r,y)=>{Object.defineProperty(r,"__esModule",{value:!0}),r.PDFDataTransportStream=void 0;var e=y(1),a=y(8);class k{constructor(f,C){(0,e.assert)(C,'PDFDataTransportStream - missing required "pdfDataRangeTransport" argument.'),this._queuedChunks=[],this._progressiveDone=f.progressiveDone||!1,this._contentDispositionFilename=f.contentDispositionFilename||null;const L=f.initialData;if((L==null?void 0:L.length)>0){const w=new Uint8Array(L).buffer;this._queuedChunks.push(w)}this._pdfDataRangeTransport=C,this._isStreamingSupported=!f.disableStream,this._isRangeSupported=!f.disableRange,this._contentLength=f.length,this._fullRequestReader=null,this._rangeReaders=[],this._pdfDataRangeTransport.addRangeListener((w,T)=>{this._onReceiveData({begin:w,chunk:T})}),this._pdfDataRangeTransport.addProgressListener((w,T)=>{this._onProgress({loaded:w,total:T})}),this._pdfDataRangeTransport.addProgressiveReadListener(w=>{this._onReceiveData({chunk:w})}),this._pdfDataRangeTransport.addProgressiveDoneListener(()=>{this._onProgressiveDone()}),this._pdfDataRangeTransport.transportReady()}_onReceiveData(f){const C=new Uint8Array(f.chunk).buffer;if(f.begin===void 0)this._fullRequestReader?this._fullRequestReader._enqueue(C):this._queuedChunks.push(C);else{const L=this._rangeReaders.some(function(w){return w._begin!==f.begin?!1:(w._enqueue(C),!0)});(0,e.assert)(L,"_onReceiveData - no `PDFDataTransportStreamRangeReader` instance found.")}}get _progressiveDataLength(){var f;return((f=this._fullRequestReader)==null?void 0:f._loaded)??0}_onProgress(f){if(f.total===void 0){const C=this._rangeReaders[0];C!=null&&C.onProgress&&C.onProgress({loaded:f.loaded})}else{const C=this._fullRequestReader;C!=null&&C.onProgress&&C.onProgress({loaded:f.loaded,total:f.total})}}_onProgressiveDone(){this._fullRequestReader&&this._fullRequestReader.progressiveDone(),this._progressiveDone=!0}_removeRangeReader(f){const C=this._rangeReaders.indexOf(f);C>=0&&this._rangeReaders.splice(C,1)}getFullReader(){(0,e.assert)(!this._fullRequestReader,"PDFDataTransportStream.getFullReader can only be called once.");const f=this._queuedChunks;return this._queuedChunks=null,new O(this,f,this._progressiveDone,this._contentDispositionFilename)}getRangeReader(f,C){if(C<=this._progressiveDataLength)return null;const L=new S(this,f,C);return this._pdfDataRangeTransport.requestDataRange(f,C),this._rangeReaders.push(L),L}cancelAllRequests(f){this._fullRequestReader&&this._fullRequestReader.cancel(f);for(const C of this._rangeReaders.slice(0))C.cancel(f);this._pdfDataRangeTransport.abort()}}r.PDFDataTransportStream=k;class O{constructor(f,C,L=!1,w=null){this._stream=f,this._done=L||!1,this._filename=(0,a.isPdfFile)(w)?w:null,this._queuedChunks=C||[],this._loaded=0;for(const T of this._queuedChunks)this._loaded+=T.byteLength;this._requests=[],this._headersReady=Promise.resolve(),f._fullRequestReader=this,this.onProgress=null}_enqueue(f){this._done||(this._requests.length>0?this._requests.shift().resolve({value:f,done:!1}):this._queuedChunks.push(f),this._loaded+=f.byteLength)}get headersReady(){return this._headersReady}get filename(){return this._filename}get isRangeSupported(){return this._stream._isRangeSupported}get isStreamingSupported(){return this._stream._isStreamingSupported}get contentLength(){return this._stream._contentLength}async read(){if(this._queuedChunks.length>0)return{value:this._queuedChunks.shift(),done:!1};if(this._done)return{value:void 0,done:!0};const f=(0,e.createPromiseCapability)();return this._requests.push(f),f.promise}cancel(f){this._done=!0;for(const C of this._requests)C.resolve({value:void 0,done:!0});this._requests.length=0}progressiveDone(){this._done||(this._done=!0)}}class S{constructor(f,C,L){this._stream=f,this._begin=C,this._end=L,this._queuedChunk=null,this._requests=[],this._done=!1,this.onProgress=null}_enqueue(f){if(!this._done){if(this._requests.length===0)this._queuedChunk=f;else{this._requests.shift().resolve({value:f,done:!1});for(const L of this._requests)L.resolve({value:void 0,done:!0});this._requests.length=0}this._done=!0,this._stream._removeRangeReader(this)}}get isStreamingSupported(){return!1}async read(){if(this._queuedChunk){const C=this._queuedChunk;return this._queuedChunk=null,{value:C,done:!1}}if(this._done)return{value:void 0,done:!0};const f=(0,e.createPromiseCapability)();return this._requests.push(f),f.promise}cancel(f){this._done=!0;for(const C of this._requests)C.resolve({value:void 0,done:!0});this._requests.length=0,this._stream._removeRangeReader(this)}}},(A,r)=>{Object.defineProperty(r,"__esModule",{value:!0}),r.XfaText=void 0;class y{static textContent(a){const k=[],O={items:k,styles:Object.create(null)};function S(_){var L;if(!_)return;let f=null;const C=_.name;if(C==="#text")f=_.value;else if(y.shouldBuildText(C))(L=_==null?void 0:_.attributes)!=null&&L.textContent?f=_.attributes.textContent:_.value&&(f=_.value);else return;if(f!==null&&k.push({str:f}),!!_.children)for(const w of _.children)S(w)}return S(a),O}static shouldBuildText(a){return!(a==="textarea"||a==="input"||a==="option"||a==="select")}}r.XfaText=y},(A,r,y)=>{Object.defineProperty(r,"__esModule",{value:!0}),r.NodeStandardFontDataFactory=r.NodeCanvasFactory=r.NodeCMapReaderFactory=void 0;var e=y(9);const a=function(_){return new Promise((f,C)=>{require$$5.readFile(_,(w,T)=>{if(w||!T){C(new Error(w));return}f(new Uint8Array(T))})})};class k extends e.BaseCanvasFactory{_createCanvas(f,C){return require$$5.createCanvas(f,C)}}r.NodeCanvasFactory=k;class O extends e.BaseCMapReaderFactory{_fetchData(f,C){return a(f).then(L=>({cMapData:L,compressionType:C}))}}r.NodeCMapReaderFactory=O;class S extends e.BaseStandardFontDataFactory{_fetchData(f){return a(f)}}r.NodeStandardFontDataFactory=S},(A,r,y)=>{var _,f,C,L,w,T,h,t,o,dt,kt,ft,Ft;Object.defineProperty(r,"__esModule",{value:!0}),r.AnnotationEditorLayer=void 0;var e=y(7),a=y(1),k=y(23),O=y(24);const i=class i{constructor(n){ue(this,o);ue(this,_);ue(this,f,!1);ue(this,C,this.pointerup.bind(this));ue(this,L,this.pointerdown.bind(this));ue(this,w,new Map);ue(this,T,!1);ue(this,h,!1);ue(this,t);i._initialized||(i._initialized=!0,k.FreeTextEditor.initialize(n.l10n),O.InkEditor.initialize(n.l10n),n.uiManager.registerEditorTypes([k.FreeTextEditor,O.InkEditor])),he(this,t,n.uiManager),this.annotationStorage=n.annotationStorage,this.pageIndex=n.pageIndex,this.div=n.div,he(this,_,n.accessibilityManager),I(this,t).addLayer(this)}updateToolbar(n){I(this,t).updateToolbar(n)}updateMode(n=I(this,t).getMode()){ce(this,o,Ft).call(this),n===a.AnnotationEditorType.INK?(this.addInkEditorIfNeeded(!1),this.disableClick()):this.enableClick(),I(this,t).unselectAll()}addInkEditorIfNeeded(n){if(!n&&I(this,t).getMode()!==a.AnnotationEditorType.INK)return;if(!n){for(const R of I(this,w).values())if(R.isEmpty()){R.setInBackground();return}}ce(this,o,ft).call(this,{offsetX:0,offsetY:0}).setInBackground()}setEditingState(n){I(this,t).setEditingState(n)}addCommands(n){I(this,t).addCommands(n)}enable(){this.div.style.pointerEvents="auto";for(const n of I(this,w).values())n.enableEditing()}disable(){this.div.style.pointerEvents="none";for(const n of I(this,w).values())n.disableEditing()}setActiveEditor(n){I(this,t).getActive()!==n&&I(this,t).setActiveEditor(n)}enableClick(){this.div.addEventListener("pointerdown",I(this,L)),this.div.addEventListener("pointerup",I(this,C))}disableClick(){this.div.removeEventListener("pointerdown",I(this,L)),this.div.removeEventListener("pointerup",I(this,C))}attach(n){I(this,w).set(n.id,n)}detach(n){var E;I(this,w).delete(n.id),(E=I(this,_))==null||E.removePointerInTextLayer(n.contentDiv)}remove(n){I(this,t).removeEditor(n),this.detach(n),this.annotationStorage.remove(n.id),n.div.style.display="none",setTimeout(()=>{n.div.style.display="",n.div.remove(),n.isAttachedToDOM=!1,document.activeElement===document.body&&I(this,t).focusMainContainer()},0),I(this,h)||this.addInkEditorIfNeeded(!1)}add(n){if(ce(this,o,dt).call(this,n),I(this,t).addEditor(n),this.attach(n),!n.isAttachedToDOM){const E=n.render();this.div.append(E),n.isAttachedToDOM=!0}this.moveEditorInDOM(n),n.onceAdded(),this.addToAnnotationStorage(n)}moveEditorInDOM(n){var E;(E=I(this,_))==null||E.moveElementInDOM(this.div,n.div,n.contentDiv,!0)}addToAnnotationStorage(n){!n.isEmpty()&&!this.annotationStorage.has(n.id)&&this.annotationStorage.setValue(n.id,n)}addOrRebuild(n){n.needsToBeRebuilt()?n.rebuild():this.add(n)}addANewEditor(n){const E=()=>{this.addOrRebuild(n)},R=()=>{n.remove()};this.addCommands({cmd:E,undo:R,mustExec:!0})}addUndoableEditor(n){const E=()=>{this.addOrRebuild(n)},R=()=>{n.remove()};this.addCommands({cmd:E,undo:R,mustExec:!1})}getNextId(){return I(this,t).getId()}deserialize(n){switch(n.annotationType){case a.AnnotationEditorType.FREETEXT:return k.FreeTextEditor.deserialize(n,this);case a.AnnotationEditorType.INK:return O.InkEditor.deserialize(n,this)}return null}setSelected(n){I(this,t).setSelected(n)}toggleSelected(n){I(this,t).toggleSelected(n)}isSelected(n){return I(this,t).isSelected(n)}unselect(n){I(this,t).unselect(n)}pointerup(n){const E=e.KeyboardManager.platform.isMac;if(!(n.button!==0||n.ctrlKey&&E)&&n.target===this.div&&I(this,T)){if(he(this,T,!1),!I(this,f)){he(this,f,!0);return}ce(this,o,ft).call(this,n)}}pointerdown(n){const E=e.KeyboardManager.platform.isMac;if(n.button!==0||n.ctrlKey&&E||n.target!==this.div)return;he(this,T,!0);const R=I(this,t).getActive();he(this,f,!R||R.isEmpty())}drop(n){const E=n.dataTransfer.getData("text/plain"),R=I(this,t).getEditor(E);if(!R)return;n.preventDefault(),n.dataTransfer.dropEffect="move",ce(this,o,dt).call(this,R);const G=this.div.getBoundingClientRect(),q=n.clientX-G.x,se=n.clientY-G.y;R.translate(q-R.startX,se-R.startY),this.moveEditorInDOM(R),R.div.focus()}dragover(n){n.preventDefault()}destroy(){var n,E;((n=I(this,t).getActive())==null?void 0:n.parent)===this&&I(this,t).setActiveEditor(null);for(const R of I(this,w).values())(E=I(this,_))==null||E.removePointerInTextLayer(R.contentDiv),R.isAttachedToDOM=!1,R.div.remove(),R.parent=null;this.div=null,I(this,w).clear(),I(this,t).removeLayer(this)}render(n){this.viewport=n.viewport,(0,e.bindEvents)(this,this.div,["dragover","drop"]),this.setDimensions();for(const E of I(this,t).getEditors(this.pageIndex))this.add(E);this.updateMode()}update(n){this.viewport=n.viewport,this.setDimensions(),this.updateMode()}get scaleFactor(){return this.viewport.scale}get pageDimensions(){const[n,E,R,G]=this.viewport.viewBox,q=R-n,se=G-E;return[q,se]}get viewportBaseDimensions(){const{width:n,height:E,rotation:R}=this.viewport;return R%180===0?[n,E]:[E,n]}setDimensions(){const{width:n,height:E,rotation:R}=this.viewport,G=R%180!==0,q=Math.floor(n)+"px",se=Math.floor(E)+"px";this.div.style.width=G?se:q,this.div.style.height=G?q:se,this.div.setAttribute("data-main-rotation",R)}};_=new WeakMap,f=new WeakMap,C=new WeakMap,L=new WeakMap,w=new WeakMap,T=new WeakMap,h=new WeakMap,t=new WeakMap,o=new WeakSet,dt=function(n){var E;n.parent!==this&&(this.attach(n),n.pageIndex=this.pageIndex,(E=n.parent)==null||E.detach(n),n.parent=this,n.div&&n.isAttachedToDOM&&(n.div.remove(),this.div.append(n.div)))},kt=function(n){switch(I(this,t).getMode()){case a.AnnotationEditorType.FREETEXT:return new k.FreeTextEditor(n);case a.AnnotationEditorType.INK:return new O.InkEditor(n)}return null},ft=function(n){const E=this.getNextId(),R=ce(this,o,kt).call(this,{parent:this,id:E,x:n.offsetX,y:n.offsetY});return R&&this.add(R),R},Ft=function(){he(this,h,!0);for(const n of I(this,w).values())n.isEmpty()&&n.remove();he(this,h,!1)},we(i,"_initialized",!1);let S=i;r.AnnotationEditorLayer=S},(A,r,y)=>{var S,_,f,C,L,w,T,h,Ot,Mt,It,pt;Object.defineProperty(r,"__esModule",{value:!0}),r.FreeTextEditor=void 0;var e=y(1),a=y(7),k=y(6);const b=class b extends k.AnnotationEditor{constructor(l){super({...l,name:"freeTextEditor"});ue(this,h);ue(this,S,this.editorDivBlur.bind(this));ue(this,_,this.editorDivFocus.bind(this));ue(this,f,this.editorDivKeydown.bind(this));ue(this,C);ue(this,L,"");ue(this,w,!1);ue(this,T);he(this,C,l.color||b._defaultColor||k.AnnotationEditor._defaultLineColor),he(this,T,l.fontSize||b._defaultFontSize)}static initialize(l){this._l10nPromise=new Map(["free_text_default_content","editor_free_text_aria_label"].map(E=>[E,l.get(E)]));const n=getComputedStyle(document.documentElement);this._internalPadding=parseFloat(n.getPropertyValue("--freetext-padding"))}static updateDefaultParams(l,n){switch(l){case e.AnnotationEditorParamsType.FREETEXT_SIZE:b._defaultFontSize=n;break;case e.AnnotationEditorParamsType.FREETEXT_COLOR:b._defaultColor=n;break}}updateParams(l,n){switch(l){case e.AnnotationEditorParamsType.FREETEXT_SIZE:ce(this,h,Ot).call(this,n);break;case e.AnnotationEditorParamsType.FREETEXT_COLOR:ce(this,h,Mt).call(this,n);break}}static get defaultPropertiesToUpdate(){return[[e.AnnotationEditorParamsType.FREETEXT_SIZE,b._defaultFontSize],[e.AnnotationEditorParamsType.FREETEXT_COLOR,b._defaultColor||k.AnnotationEditor._defaultLineColor]]}get propertiesToUpdate(){return[[e.AnnotationEditorParamsType.FREETEXT_SIZE,I(this,T)],[e.AnnotationEditorParamsType.FREETEXT_COLOR,I(this,C)]]}getInitialTranslation(){return[-b._internalPadding*this.parent.scaleFactor,-(b._internalPadding+I(this,T))*this.parent.scaleFactor]}rebuild(){super.rebuild(),this.div!==null&&(this.isAttachedToDOM||this.parent.add(this))}enableEditMode(){this.isInEditMode()||(this.parent.setEditingState(!1),this.parent.updateToolbar(e.AnnotationEditorType.FREETEXT),super.enableEditMode(),this.enableEditing(),this.overlayDiv.classList.remove("enabled"),this.editorDiv.contentEditable=!0,this.div.draggable=!1,this.editorDiv.addEventListener("keydown",I(this,f)),this.editorDiv.addEventListener("focus",I(this,_)),this.editorDiv.addEventListener("blur",I(this,S)))}disableEditMode(){this.isInEditMode()&&(this.parent.setEditingState(!0),super.disableEditMode(),this.disableEditing(),this.overlayDiv.classList.add("enabled"),this.editorDiv.contentEditable=!1,this.div.draggable=!0,this.editorDiv.removeEventListener("keydown",I(this,f)),this.editorDiv.removeEventListener("focus",I(this,_)),this.editorDiv.removeEventListener("blur",I(this,S)),this.div.focus(),this.isEditing=!1)}focusin(l){super.focusin(l),l.target!==this.editorDiv&&this.editorDiv.focus()}onceAdded(){this.width||(this.enableEditMode(),this.editorDiv.focus())}isEmpty(){return!this.editorDiv||this.editorDiv.innerText.trim()===""}remove(){this.isEditing=!1,this.parent.setEditingState(!0),super.remove()}commit(){super.commit(),I(this,w)||(he(this,w,!0),this.parent.addUndoableEditor(this)),this.disableEditMode(),he(this,L,ce(this,h,It).call(this).trimEnd()),ce(this,h,pt).call(this)}shouldGetKeyboardEvents(){return this.isInEditMode()}dblclick(l){this.enableEditMode(),this.editorDiv.focus()}keydown(l){l.target===this.div&&l.key==="Enter"&&(this.enableEditMode(),this.editorDiv.focus())}editorDivKeydown(l){b._keyboardManager.exec(this,l)}editorDivFocus(l){this.isEditing=!0}editorDivBlur(l){this.isEditing=!1}disableEditing(){this.editorDiv.setAttribute("role","comment"),this.editorDiv.removeAttribute("aria-multiline")}enableEditing(){this.editorDiv.setAttribute("role","textbox"),this.editorDiv.setAttribute("aria-multiline",!0)}render(){if(this.div)return this.div;let l,n;this.width&&(l=this.x,n=this.y),super.render(),this.editorDiv=document.createElement("div"),this.editorDiv.className="internal",this.editorDiv.setAttribute("id",`${this.id}-editor`),this.enableEditing(),b._l10nPromise.get("editor_free_text_aria_label").then(R=>{var G;return(G=this.editorDiv)==null?void 0:G.setAttribute("aria-label",R)}),b._l10nPromise.get("free_text_default_content").then(R=>{var G;return(G=this.editorDiv)==null?void 0:G.setAttribute("default-content",R)}),this.editorDiv.contentEditable=!0;const{style:E}=this.editorDiv;if(E.fontSize=`calc(${I(this,T)}px * var(--scale-factor))`,E.color=I(this,C),this.div.append(this.editorDiv),this.overlayDiv=document.createElement("div"),this.overlayDiv.classList.add("overlay","enabled"),this.div.append(this.overlayDiv),(0,a.bindEvents)(this,this.div,["dblclick","keydown"]),this.width){const[R,G]=this.parent.viewportBaseDimensions;this.setAt(l*R,n*G,this.width*R,this.height*G);for(const q of I(this,L).split(`
`)){const se=document.createElement("div");se.append(q?document.createTextNode(q):document.createElement("br")),this.editorDiv.append(se)}this.div.draggable=!0,this.editorDiv.contentEditable=!1}else this.div.draggable=!1,this.editorDiv.contentEditable=!0;return this.div}get contentDiv(){return this.editorDiv}static deserialize(l,n){const E=super.deserialize(l,n);return he(E,T,l.fontSize),he(E,C,e.Util.makeHexColor(...l.color)),he(E,L,l.value),E}serialize(){if(this.isEmpty())return null;const l=b._internalPadding*this.parent.scaleFactor,n=this.getRect(l,l),E=k.AnnotationEditor._colorManager.convert(getComputedStyle(this.editorDiv).color);return{annotationType:e.AnnotationEditorType.FREETEXT,color:E,fontSize:I(this,T),value:I(this,L),pageIndex:this.parent.pageIndex,rect:n,rotation:this.rotation}}};S=new WeakMap,_=new WeakMap,f=new WeakMap,C=new WeakMap,L=new WeakMap,w=new WeakMap,T=new WeakMap,h=new WeakSet,Ot=function(l){const n=R=>{this.editorDiv.style.fontSize=`calc(${R}px * var(--scale-factor))`,this.translate(0,-(R-I(this,T))*this.parent.scaleFactor),he(this,T,R),ce(this,h,pt).call(this)},E=I(this,T);this.parent.addCommands({cmd:()=>{n(l)},undo:()=>{n(E)},mustExec:!0,type:e.AnnotationEditorParamsType.FREETEXT_SIZE,overwriteIfSameType:!0,keepUndo:!0})},Mt=function(l){const n=I(this,C);this.parent.addCommands({cmd:()=>{he(this,C,l),this.editorDiv.style.color=l},undo:()=>{he(this,C,n),this.editorDiv.style.color=n},mustExec:!0,type:e.AnnotationEditorParamsType.FREETEXT_COLOR,overwriteIfSameType:!0,keepUndo:!0})},It=function(){const l=this.editorDiv.getElementsByTagName("div");if(l.length===0)return this.editorDiv.innerText;const n=[];for(let E=0,R=l.length;E<R;E++){const q=l[E].firstChild;(q==null?void 0:q.nodeName)==="#text"?n.push(q.data):n.push("")}return n.join(`
`)},pt=function(){const[l,n]=this.parent.viewportBaseDimensions,E=this.div.getBoundingClientRect();this.width=E.width/l,this.height=E.height/n},we(b,"_freeTextDefaultContent",""),we(b,"_l10nPromise"),we(b,"_internalPadding",0),we(b,"_defaultColor",null),we(b,"_defaultFontSize",10),we(b,"_keyboardManager",new a.KeyboardManager([[["ctrl+Enter","mac+meta+Enter","Escape","mac+Escape"],b.prototype.commitOrRemove]])),we(b,"_type","freetext");let O=b;r.FreeTextEditor=O},(A,r,y)=>{var f,C,L,w,T,h,t,o,c,x,b,d,i,l,n,Dt,Lt,Nt,jt,gt,Ut,Bt,Wt,Me,mt,Qe,Ze,qe,yt,et,p,_t,qt,Gt,Ht,bt,tt,Ge,vt;Object.defineProperty(r,"__esModule",{value:!0}),r.InkEditor=void 0,Object.defineProperty(r,"fitCurve",{enumerable:!0,get:function(){return k.fitCurve}});var e=y(1),a=y(6),k=y(25),O=y(7);const S=16,v=class v extends a.AnnotationEditor{constructor(M){super({...M,name:"inkEditor"});ue(this,n);ue(this,f,0);ue(this,C,0);ue(this,L,0);ue(this,w,this.canvasPointermove.bind(this));ue(this,T,this.canvasPointerleave.bind(this));ue(this,h,this.canvasPointerup.bind(this));ue(this,t,this.canvasPointerdown.bind(this));ue(this,o,!1);ue(this,c,!1);ue(this,x,null);ue(this,b,null);ue(this,d,0);ue(this,i,0);ue(this,l,null);this.color=M.color||null,this.thickness=M.thickness||null,this.opacity=M.opacity||null,this.paths=[],this.bezierPath2D=[],this.currentPath=[],this.scaleFactor=1,this.translationX=this.translationY=0,this.x=0,this.y=0}static initialize(M){this._l10nPromise=new Map(["editor_ink_canvas_aria_label","editor_ink_aria_label"].map(m=>[m,M.get(m)]))}static updateDefaultParams(M,m){switch(M){case e.AnnotationEditorParamsType.INK_THICKNESS:v._defaultThickness=m;break;case e.AnnotationEditorParamsType.INK_COLOR:v._defaultColor=m;break;case e.AnnotationEditorParamsType.INK_OPACITY:v._defaultOpacity=m/100;break}}updateParams(M,m){switch(M){case e.AnnotationEditorParamsType.INK_THICKNESS:ce(this,n,Dt).call(this,m);break;case e.AnnotationEditorParamsType.INK_COLOR:ce(this,n,Lt).call(this,m);break;case e.AnnotationEditorParamsType.INK_OPACITY:ce(this,n,Nt).call(this,m);break}}static get defaultPropertiesToUpdate(){return[[e.AnnotationEditorParamsType.INK_THICKNESS,v._defaultThickness],[e.AnnotationEditorParamsType.INK_COLOR,v._defaultColor||a.AnnotationEditor._defaultLineColor],[e.AnnotationEditorParamsType.INK_OPACITY,Math.round(v._defaultOpacity*100)]]}get propertiesToUpdate(){return[[e.AnnotationEditorParamsType.INK_THICKNESS,this.thickness||v._defaultThickness],[e.AnnotationEditorParamsType.INK_COLOR,this.color||v._defaultColor||a.AnnotationEditor._defaultLineColor],[e.AnnotationEditorParamsType.INK_OPACITY,Math.round(100*(this.opacity??v._defaultOpacity))]]}rebuild(){super.rebuild(),this.div!==null&&(this.canvas||(ce(this,n,Qe).call(this),ce(this,n,Ze).call(this)),this.isAttachedToDOM||(this.parent.add(this),ce(this,n,qe).call(this)),ce(this,n,Ge).call(this))}remove(){this.canvas!==null&&(this.isEmpty()||this.commit(),this.canvas.width=this.canvas.height=0,this.canvas.remove(),this.canvas=null,I(this,b).disconnect(),he(this,b,null),super.remove())}enableEditMode(){I(this,o)||this.canvas===null||(super.enableEditMode(),this.div.draggable=!1,this.canvas.addEventListener("pointerdown",I(this,t)),this.canvas.addEventListener("pointerup",I(this,h)))}disableEditMode(){!this.isInEditMode()||this.canvas===null||(super.disableEditMode(),this.div.draggable=!this.isEmpty(),this.div.classList.remove("editing"),this.canvas.removeEventListener("pointerdown",I(this,t)),this.canvas.removeEventListener("pointerup",I(this,h)))}onceAdded(){this.div.draggable=!this.isEmpty()}isEmpty(){return this.paths.length===0||this.paths.length===1&&this.paths[0].length===0}commit(){I(this,o)||(super.commit(),this.isEditing=!1,this.disableEditMode(),this.setInForeground(),he(this,o,!0),this.div.classList.add("disabled"),ce(this,n,Ge).call(this,!0),this.parent.addInkEditorIfNeeded(!0),this.parent.moveEditorInDOM(this),this.div.focus())}focusin(M){super.focusin(M),this.enableEditMode()}canvasPointerdown(M){M.button!==0||!this.isInEditMode()||I(this,o)||(this.setInForeground(),M.type!=="mouse"&&this.div.focus(),M.stopPropagation(),this.canvas.addEventListener("pointerleave",I(this,T)),this.canvas.addEventListener("pointermove",I(this,w)),ce(this,n,Ut).call(this,M.offsetX,M.offsetY))}canvasPointermove(M){M.stopPropagation(),ce(this,n,Bt).call(this,M.offsetX,M.offsetY)}canvasPointerup(M){M.button===0&&this.isInEditMode()&&this.currentPath.length!==0&&(M.stopPropagation(),ce(this,n,mt).call(this,M),this.setInBackground())}canvasPointerleave(M){ce(this,n,mt).call(this,M),this.setInBackground()}render(){if(this.div)return this.div;let M,m;this.width&&(M=this.x,m=this.y),super.render(),v._l10nPromise.get("editor_ink_aria_label").then(ee=>{var oe;return(oe=this.div)==null?void 0:oe.setAttribute("aria-label",ee)});const[N,te,H,J]=ce(this,n,jt).call(this);if(this.setAt(N,te,0,0),this.setDims(H,J),ce(this,n,Qe).call(this),this.width){const[ee,oe]=this.parent.viewportBaseDimensions;this.setAt(M*ee,m*oe,this.width*ee,this.height*oe),he(this,c,!0),ce(this,n,qe).call(this),this.setDims(this.width*ee,this.height*oe),ce(this,n,Me).call(this),ce(this,n,vt).call(this),this.div.classList.add("disabled")}else this.div.classList.add("editing"),this.enableEditMode();return ce(this,n,Ze).call(this),this.div}setDimensions(M,m){const N=Math.round(M),te=Math.round(m);if(I(this,d)===N&&I(this,i)===te)return;he(this,d,N),he(this,i,te),this.canvas.style.visibility="hidden",I(this,f)&&Math.abs(I(this,f)-M/m)>.01&&(m=Math.ceil(M/I(this,f)),this.setDims(M,m));const[H,J]=this.parent.viewportBaseDimensions;this.width=M/H,this.height=m/J,I(this,o)&&ce(this,n,yt).call(this,M,m),ce(this,n,qe).call(this),ce(this,n,Me).call(this),this.canvas.style.visibility="visible"}static deserialize(M,m){var _e,me;const N=super.deserialize(M,m);N.thickness=M.thickness,N.color=e.Util.makeHexColor(...M.color),N.opacity=M.opacity;const[te,H]=m.pageDimensions,J=N.width*te,ee=N.height*H,oe=m.scaleFactor,de=M.thickness/2;he(N,f,J/ee),he(N,o,!0),he(N,d,Math.round(J)),he(N,i,Math.round(ee));for(const{bezier:ge}of M.paths){const be=[];N.paths.push(be);let ve=oe*(ge[0]-de),xe=oe*(ee-ge[1]-de);for(let Ce=2,Ee=ge.length;Ce<Ee;Ce+=6){const Pe=oe*(ge[Ce]-de),Ie=oe*(ee-ge[Ce+1]-de),je=oe*(ge[Ce+2]-de),Ue=oe*(ee-ge[Ce+3]-de),ie=oe*(ge[Ce+4]-de),Y=oe*(ee-ge[Ce+5]-de);be.push([[ve,xe],[Pe,Ie],[je,Ue],[ie,Y]]),ve=ie,xe=Y}const Ae=ce(this,p,_t).call(this,be);N.bezierPath2D.push(Ae)}const re=ce(_e=N,n,bt).call(_e);return he(N,L,Math.max(S,re[2]-re[0])),he(N,C,Math.max(S,re[3]-re[1])),ce(me=N,n,yt).call(me,J,ee),N}serialize(){if(this.isEmpty())return null;const M=this.getRect(0,0),m=this.rotation%180===0?M[3]-M[1]:M[2]-M[0],N=a.AnnotationEditor._colorManager.convert(this.ctx.strokeStyle);return{annotationType:e.AnnotationEditorType.INK,color:N,thickness:this.thickness,opacity:this.opacity,paths:ce(this,n,qt).call(this,this.scaleFactor/this.parent.scaleFactor,this.translationX,this.translationY,m),pageIndex:this.parent.pageIndex,rect:M,rotation:this.rotation}}};f=new WeakMap,C=new WeakMap,L=new WeakMap,w=new WeakMap,T=new WeakMap,h=new WeakMap,t=new WeakMap,o=new WeakMap,c=new WeakMap,x=new WeakMap,b=new WeakMap,d=new WeakMap,i=new WeakMap,l=new WeakMap,n=new WeakSet,Dt=function(M){const m=this.thickness;this.parent.addCommands({cmd:()=>{this.thickness=M,ce(this,n,Ge).call(this)},undo:()=>{this.thickness=m,ce(this,n,Ge).call(this)},mustExec:!0,type:e.AnnotationEditorParamsType.INK_THICKNESS,overwriteIfSameType:!0,keepUndo:!0})},Lt=function(M){const m=this.color;this.parent.addCommands({cmd:()=>{this.color=M,ce(this,n,Me).call(this)},undo:()=>{this.color=m,ce(this,n,Me).call(this)},mustExec:!0,type:e.AnnotationEditorParamsType.INK_COLOR,overwriteIfSameType:!0,keepUndo:!0})},Nt=function(M){M/=100;const m=this.opacity;this.parent.addCommands({cmd:()=>{this.opacity=M,ce(this,n,Me).call(this)},undo:()=>{this.opacity=m,ce(this,n,Me).call(this)},mustExec:!0,type:e.AnnotationEditorParamsType.INK_OPACITY,overwriteIfSameType:!0,keepUndo:!0})},jt=function(){const{width:M,height:m,rotation:N}=this.parent.viewport;switch(N){case 90:return[0,M,M,m];case 180:return[M,m,M,m];case 270:return[m,0,M,m];default:return[0,0,M,m]}},gt=function(){this.ctx.lineWidth=this.thickness*this.parent.scaleFactor/this.scaleFactor,this.ctx.lineCap="round",this.ctx.lineJoin="round",this.ctx.miterLimit=10,this.ctx.strokeStyle=`${this.color}${(0,O.opacityToHex)(this.opacity)}`},Ut=function(M,m){this.isEditing=!0,I(this,c)||(he(this,c,!0),ce(this,n,qe).call(this),this.thickness||(this.thickness=v._defaultThickness),this.color||(this.color=v._defaultColor||a.AnnotationEditor._defaultLineColor),this.opacity??(this.opacity=v._defaultOpacity)),this.currentPath.push([M,m]),he(this,x,null),ce(this,n,gt).call(this),this.ctx.beginPath(),this.ctx.moveTo(M,m),he(this,l,()=>{I(this,l)&&(I(this,x)&&(this.isEmpty()?(this.ctx.setTransform(1,0,0,1,0,0),this.ctx.clearRect(0,0,this.canvas.width,this.canvas.height)):ce(this,n,Me).call(this),this.ctx.lineTo(...I(this,x)),he(this,x,null),this.ctx.stroke()),window.requestAnimationFrame(I(this,l)))}),window.requestAnimationFrame(I(this,l))},Bt=function(M,m){const[N,te]=this.currentPath.at(-1);M===N&&m===te||(this.currentPath.push([M,m]),he(this,x,[M,m]))},Wt=function(M,m){var de;this.ctx.closePath(),he(this,l,null),M=Math.min(Math.max(M,0),this.canvas.width),m=Math.min(Math.max(m,0),this.canvas.height);const[N,te]=this.currentPath.at(-1);(M!==N||m!==te)&&this.currentPath.push([M,m]);let H;if(this.currentPath.length!==1)H=(0,k.fitCurve)(this.currentPath,30,null);else{const re=[M,m];H=[[re,re.slice(),re.slice(),re]]}const J=ce(de=v,p,_t).call(de,H);this.currentPath.length=0;const ee=()=>{this.paths.push(H),this.bezierPath2D.push(J),this.rebuild()},oe=()=>{this.paths.pop(),this.bezierPath2D.pop(),this.paths.length===0?this.remove():(this.canvas||(ce(this,n,Qe).call(this),ce(this,n,Ze).call(this)),ce(this,n,Ge).call(this))};this.parent.addCommands({cmd:ee,undo:oe,mustExec:!0})},Me=function(){if(this.isEmpty()){ce(this,n,et).call(this);return}ce(this,n,gt).call(this);const{canvas:M,ctx:m}=this;m.setTransform(1,0,0,1,0,0),m.clearRect(0,0,M.width,M.height),ce(this,n,et).call(this);for(const N of this.bezierPath2D)m.stroke(N)},mt=function(M){ce(this,n,Wt).call(this,M.offsetX,M.offsetY),this.canvas.removeEventListener("pointerleave",I(this,T)),this.canvas.removeEventListener("pointermove",I(this,w)),this.parent.addToAnnotationStorage(this)},Qe=function(){this.canvas=document.createElement("canvas"),this.canvas.width=this.canvas.height=0,this.canvas.className="inkEditorCanvas",v._l10nPromise.get("editor_ink_canvas_aria_label").then(M=>{var m;return(m=this.canvas)==null?void 0:m.setAttribute("aria-label",M)}),this.div.append(this.canvas),this.ctx=this.canvas.getContext("2d")},Ze=function(){he(this,b,new ResizeObserver(M=>{const m=M[0].contentRect;m.width&&m.height&&this.setDimensions(m.width,m.height)})),I(this,b).observe(this.div)},qe=function(){if(!I(this,c))return;const[M,m]=this.parent.viewportBaseDimensions;this.canvas.width=Math.ceil(this.width*M),this.canvas.height=Math.ceil(this.height*m),ce(this,n,et).call(this)},yt=function(M,m){const N=ce(this,n,tt).call(this),te=(M-N)/I(this,L),H=(m-N)/I(this,C);this.scaleFactor=Math.min(te,H)},et=function(){const M=ce(this,n,tt).call(this)/2;this.ctx.setTransform(this.scaleFactor,0,0,this.scaleFactor,this.translationX*this.scaleFactor+M,this.translationY*this.scaleFactor+M)},p=new WeakSet,_t=function(M){const m=new Path2D;for(let N=0,te=M.length;N<te;N++){const[H,J,ee,oe]=M[N];N===0&&m.moveTo(...H),m.bezierCurveTo(J[0],J[1],ee[0],ee[1],oe[0],oe[1])}return m},qt=function(M,m,N,te){const J=[],ee=this.thickness/2;let oe,de;for(const re of this.paths){oe=[],de=[];for(let _e=0,me=re.length;_e<me;_e++){const[ge,be,ve,xe]=re[_e],Ae=M*(ge[0]+m)+ee,Ce=te-M*(ge[1]+N)-ee,Ee=M*(be[0]+m)+ee,Pe=te-M*(be[1]+N)-ee,Ie=M*(ve[0]+m)+ee,je=te-M*(ve[1]+N)-ee,Ue=M*(xe[0]+m)+ee,ie=te-M*(xe[1]+N)-ee;_e===0&&(oe.push(Ae,Ce),de.push(Ae,Ce)),oe.push(Ee,Pe,Ie,je,Ue,ie),ce(this,n,Gt).call(this,Ae,Ce,Ee,Pe,Ie,je,Ue,ie,4,de)}J.push({bezier:oe,points:de})}return J},Gt=function(M,m,N,te,H,J,ee,oe,de,re){if(ce(this,n,Ht).call(this,M,m,N,te,H,J,ee,oe)){re.push(ee,oe);return}for(let _e=1;_e<de-1;_e++){const me=_e/de,ge=1-me;let be=me*M+ge*N,ve=me*m+ge*te,xe=me*N+ge*H,Ae=me*te+ge*J;const Ce=me*H+ge*ee,Ee=me*J+ge*oe;be=me*be+ge*xe,ve=me*ve+ge*Ae,xe=me*xe+ge*Ce,Ae=me*Ae+ge*Ee,be=me*be+ge*xe,ve=me*ve+ge*Ae,re.push(be,ve)}re.push(ee,oe)},Ht=function(M,m,N,te,H,J,ee,oe){const re=(3*N-2*M-ee)**2,_e=(3*te-2*m-oe)**2,me=(3*H-M-2*ee)**2,ge=(3*J-m-2*oe)**2;return Math.max(re,me)+Math.max(_e,ge)<=10},bt=function(){let M=1/0,m=-1/0,N=1/0,te=-1/0;for(const H of this.paths)for(const[J,ee,oe,de]of H){const re=e.Util.bezierBoundingBox(...J,...ee,...oe,...de);M=Math.min(M,re[0]),N=Math.min(N,re[1]),m=Math.max(m,re[2]),te=Math.max(te,re[3])}return[M,N,m,te]},tt=function(){return I(this,o)?Math.ceil(this.thickness*this.parent.scaleFactor):0},Ge=function(M=!1){if(this.isEmpty())return;if(!I(this,o)){ce(this,n,Me).call(this);return}const m=ce(this,n,bt).call(this),N=ce(this,n,tt).call(this);he(this,L,Math.max(S,m[2]-m[0])),he(this,C,Math.max(S,m[3]-m[1]));const te=Math.ceil(N+I(this,L)*this.scaleFactor),H=Math.ceil(N+I(this,C)*this.scaleFactor),[J,ee]=this.parent.viewportBaseDimensions;this.width=te/J,this.height=H/ee,he(this,f,te/H),ce(this,n,vt).call(this);const oe=this.translationX,de=this.translationY;this.translationX=-m[0],this.translationY=-m[1],ce(this,n,qe).call(this),ce(this,n,Me).call(this),he(this,d,te),he(this,i,H),this.setDims(te,H);const re=M?N/this.scaleFactor/2:0;this.translate(oe-this.translationX-re,de-this.translationY-re)},vt=function(){const{style:M}=this.div;I(this,f)>=1?(M.minHeight=`${S}px`,M.minWidth=`${Math.round(I(this,f)*S)}px`):(M.minWidth=`${S}px`,M.minHeight=`${Math.round(S/I(this,f))}px`)},ue(v,p),we(v,"_defaultColor",null),we(v,"_defaultOpacity",1),we(v,"_defaultThickness",1),we(v,"_l10nPromise"),we(v,"_type","ink");let _=v;r.InkEditor=_},(A,r,y)=>{Object.defineProperty(r,"__esModule",{value:!0}),r.fitCurve=void 0;const e=y(26);r.fitCurve=e},A=>{function r(h,t,o){if(!Array.isArray(h))throw new TypeError("First argument should be an array");if(h.forEach(d=>{if(!Array.isArray(d)||d.some(i=>typeof i!="number")||d.length!==h[0].length)throw Error("Each point should be an array of numbers. Each point should have the same amount of numbers.")}),h=h.filter((d,i)=>i===0||!d.every((l,n)=>l===h[i-1][n])),h.length<2)return[];const c=h.length,x=L(h[1],h[0]),b=L(h[c-2],h[c-1]);return y(h,x,b,t,o)}function y(h,t,o,c,x){var d,i,l,n,E,R,G,q,se,ae,Z,Q,z;if(h.length===2)return Q=w.vectorLen(w.subtract(h[0],h[1]))/3,d=[h[0],w.addArrays(h[0],w.mulItems(t,Q)),w.addArrays(h[1],w.mulItems(o,Q)),h[1]],[d];if(i=S(h),[d,n,R]=e(h,i,i,t,o,x),n===0||n<c)return[d];if(n<c*c)for(l=i,E=n,G=R,z=0;z<20;z++){if(l=k(d,h,l),[d,n,R]=e(h,i,l,t,o,x),n<c)return[d];if(R===G){let V=n/E;if(V>.9999&&V<1.0001)break}E=n,G=R}return Z=[],q=w.subtract(h[R-1],h[R+1]),q.every(V=>V===0)&&(q=w.subtract(h[R-1],h[R]),[q[0],q[1]]=[-q[1],q[0]]),se=w.normalize(q),ae=w.mulItems(se,-1),Z=Z.concat(y(h.slice(0,R+1),t,se,c,x)),Z=Z.concat(y(h.slice(R),ae,o,c,x)),Z}function e(h,t,o,c,x,b){var d,i,l;return d=a(h,o,c,x),[i,l]=_(h,d,t),b&&b({bez:d,points:h,params:t,maxErr:i,maxPoint:l}),[d,i,l]}function a(h,t,o,c){var x,b,d,i,l,n,E,R,G,q,se,ae,Z,Q,z,V,X,ne=h[0],le=h[h.length-1];for(x=[ne,null,null,le],b=w.zeros_Xx2x2(t.length),Z=0,Q=t.length;Z<Q;Z++)V=t[Z],X=1-V,d=b[Z],d[0]=w.mulItems(o,3*V*(X*X)),d[1]=w.mulItems(c,3*X*(V*V));for(i=[[0,0],[0,0]],l=[0,0],Z=0,Q=h.length;Z<Q;Z++)V=t[Z],d=b[Z],i[0][0]+=w.dot(d[0],d[0]),i[0][1]+=w.dot(d[0],d[1]),i[1][0]+=w.dot(d[0],d[1]),i[1][1]+=w.dot(d[1],d[1]),z=w.subtract(h[Z],T.q([ne,ne,le,le],V)),l[0]+=w.dot(d[0],z),l[1]+=w.dot(d[1],z);return n=i[0][0]*i[1][1]-i[1][0]*i[0][1],E=i[0][0]*l[1]-i[1][0]*l[0],R=l[0]*i[1][1]-l[1]*i[0][1],G=n===0?0:R/n,q=n===0?0:E/n,ae=w.vectorLen(w.subtract(ne,le)),se=1e-6*ae,G<se||q<se?(x[1]=w.addArrays(ne,w.mulItems(o,ae/3)),x[2]=w.addArrays(le,w.mulItems(c,ae/3))):(x[1]=w.addArrays(ne,w.mulItems(o,G)),x[2]=w.addArrays(le,w.mulItems(c,q))),x}function k(h,t,o){return o.map((c,x)=>O(h,t[x],c))}function O(h,t,o){var c=w.subtract(T.q(h,o),t),x=T.qprime(h,o),b=w.mulMatrix(c,x),d=w.sum(w.squareItems(x))+2*w.mulMatrix(c,T.qprimeprime(h,o));return d===0?o:o-b/d}function S(h){var t=[],o,c,x;return h.forEach((b,d)=>{o=d?c+w.vectorLen(w.subtract(b,x)):0,t.push(o),c=o,x=b}),t=t.map(b=>b/c),t}function _(h,t,o){var c,x,b,d,i,l,n,E;x=0,b=Math.floor(h.length/2);const R=f(t,10);for(i=0,l=h.length;i<l;i++)n=h[i],E=C(t,o[i],R,10),d=w.subtract(T.q(t,E),n),c=d[0]*d[0]+d[1]*d[1],c>x&&(x=c,b=i);return[x,b]}var f=function(h,t){for(var o,c=[0],x=h[0],b=0,d=1;d<=t;d++)o=T.q(h,d/t),b+=w.vectorLen(w.subtract(o,x)),c.push(b),x=o;return c=c.map(i=>i/b),c};function C(h,t,o,c){if(t<0)return 0;if(t>1)return 1;for(var x,b,d,i,l,n=1;n<=c;n++)if(t<=o[n]){i=(n-1)/c,d=n/c,b=o[n-1],x=o[n],l=(t-b)/(x-b)*(d-i)+i;break}return l}function L(h,t){return w.normalize(w.subtract(h,t))}class w{static zeros_Xx2x2(t){for(var o=[];t--;)o.push([0,0]);return o}static mulItems(t,o){return t.map(c=>c*o)}static mulMatrix(t,o){return t.reduce((c,x,b)=>c+x*o[b],0)}static subtract(t,o){return t.map((c,x)=>c-o[x])}static addArrays(t,o){return t.map((c,x)=>c+o[x])}static addItems(t,o){return t.map(c=>c+o)}static sum(t){return t.reduce((o,c)=>o+c)}static dot(t,o){return w.mulMatrix(t,o)}static vectorLen(t){return Math.hypot(...t)}static divItems(t,o){return t.map(c=>c/o)}static squareItems(t){return t.map(o=>o*o)}static normalize(t){return this.divItems(t,this.vectorLen(t))}}class T{static q(t,o){var c=1-o,x=w.mulItems(t[0],c*c*c),b=w.mulItems(t[1],3*c*c*o),d=w.mulItems(t[2],3*c*o*o),i=w.mulItems(t[3],o*o*o);return w.addArrays(w.addArrays(x,b),w.addArrays(d,i))}static qprime(t,o){var c=1-o,x=w.mulItems(w.subtract(t[1],t[0]),3*c*c),b=w.mulItems(w.subtract(t[2],t[1]),6*c*o),d=w.mulItems(w.subtract(t[3],t[2]),3*o*o);return w.addArrays(w.addArrays(x,b),d)}static qprimeprime(t,o){return w.addArrays(w.mulItems(w.addArrays(w.subtract(t[2],w.mulItems(t[1],2)),t[0]),6*(1-o)),w.mulItems(w.addArrays(w.subtract(t[3],w.mulItems(t[2],2)),t[1]),6*o))}}A.exports=r,A.exports.fitCubic=y,A.exports.createTangent=L},(A,r,y)=>{var p,At,St,Et;Object.defineProperty(r,"__esModule",{value:!0}),r.AnnotationLayer=void 0;var e=y(1),a=y(8),k=y(5),O=y(28),S=y(29);const _=1e3,f=9,C=new WeakSet;function L(W){return{width:W[2]-W[0],height:W[3]-W[1]}}class w{static create(s){switch(s.data.annotationType){case e.AnnotationType.LINK:return new h(s);case e.AnnotationType.TEXT:return new t(s);case e.AnnotationType.WIDGET:switch(s.data.fieldType){case"Tx":return new c(s);case"Btn":return s.data.radioButton?new b(s):s.data.checkBox?new x(s):new d(s);case"Ch":return new i(s)}return new o(s);case e.AnnotationType.POPUP:return new l(s);case e.AnnotationType.FREETEXT:return new E(s);case e.AnnotationType.LINE:return new R(s);case e.AnnotationType.SQUARE:return new G(s);case e.AnnotationType.CIRCLE:return new q(s);case e.AnnotationType.POLYLINE:return new se(s);case e.AnnotationType.CARET:return new Z(s);case e.AnnotationType.INK:return new Q(s);case e.AnnotationType.POLYGON:return new ae(s);case e.AnnotationType.HIGHLIGHT:return new z(s);case e.AnnotationType.UNDERLINE:return new V(s);case e.AnnotationType.SQUIGGLY:return new X(s);case e.AnnotationType.STRIKEOUT:return new ne(s);case e.AnnotationType.STAMP:return new le(s);case e.AnnotationType.FILEATTACHMENT:return new fe(s);default:return new T(s)}}}class T{constructor(s,{isRenderable:g=!1,ignoreBorder:P=!1,createQuadrilaterals:v=!1}={}){this.isRenderable=g,this.data=s.data,this.layer=s.layer,this.page=s.page,this.viewport=s.viewport,this.linkService=s.linkService,this.downloadManager=s.downloadManager,this.imageResourcesPath=s.imageResourcesPath,this.renderForms=s.renderForms,this.svgFactory=s.svgFactory,this.annotationStorage=s.annotationStorage,this.enableScripting=s.enableScripting,this.hasJSActions=s.hasJSActions,this._fieldObjects=s.fieldObjects,this._mouseState=s.mouseState,g&&(this.container=this._createContainer(P)),v&&(this.quadrilaterals=this._createQuadrilaterals(P))}_createContainer(s=!1){const g=this.data,P=this.page,v=this.viewport,F=document.createElement("section"),{width:j,height:M}=L(g.rect),[m,N,te,H]=v.viewBox,J=te-m,ee=H-N;F.setAttribute("data-annotation-id",g.id);const oe=e.Util.normalizeRect([g.rect[0],P.view[3]-g.rect[1]+P.view[1],g.rect[2],P.view[3]-g.rect[3]+P.view[1]]);if(!s&&g.borderStyle.width>0){F.style.borderWidth=`${g.borderStyle.width}px`;const re=g.borderStyle.horizontalCornerRadius,_e=g.borderStyle.verticalCornerRadius;if(re>0||_e>0){const ge=`calc(${re}px * var(--scale-factor)) / calc(${_e}px * var(--scale-factor))`;F.style.borderRadius=ge}else if(this instanceof b){const ge=`calc(${j}px * var(--scale-factor)) / calc(${M}px * var(--scale-factor))`;F.style.borderRadius=ge}switch(g.borderStyle.style){case e.AnnotationBorderStyleType.SOLID:F.style.borderStyle="solid";break;case e.AnnotationBorderStyleType.DASHED:F.style.borderStyle="dashed";break;case e.AnnotationBorderStyleType.BEVELED:(0,e.warn)("Unimplemented border style: beveled");break;case e.AnnotationBorderStyleType.INSET:(0,e.warn)("Unimplemented border style: inset");break;case e.AnnotationBorderStyleType.UNDERLINE:F.style.borderBottomStyle="solid";break}const me=g.borderColor||null;me?F.style.borderColor=e.Util.makeHexColor(me[0]|0,me[1]|0,me[2]|0):F.style.borderWidth=0}F.style.left=`${100*(oe[0]-m)/J}%`,F.style.top=`${100*(oe[1]-N)/ee}%`;const{rotation:de}=g;return g.hasOwnCanvas||de===0?(F.style.width=`${100*j/J}%`,F.style.height=`${100*M/ee}%`):this.setRotation(de,F),F}setRotation(s,g=this.container){const[P,v,F,j]=this.viewport.viewBox,M=F-P,m=j-v,{width:N,height:te}=L(this.data.rect);let H,J;s%180===0?(H=100*N/M,J=100*te/m):(H=100*te/M,J=100*N/m),g.style.width=`${H}%`,g.style.height=`${J}%`,g.setAttribute("data-main-rotation",(360-s)%360)}get _commonActions(){const s=(g,P,v)=>{const F=v.detail[g];v.target.style[P]=O.ColorConverters[`${F[0]}_HTML`](F.slice(1))};return(0,e.shadow)(this,"_commonActions",{display:g=>{const P=g.detail.display%2===1;this.container.style.visibility=P?"hidden":"visible",this.annotationStorage.setValue(this.data.id,{hidden:P,print:g.detail.display===0||g.detail.display===3})},print:g=>{this.annotationStorage.setValue(this.data.id,{print:g.detail.print})},hidden:g=>{this.container.style.visibility=g.detail.hidden?"hidden":"visible",this.annotationStorage.setValue(this.data.id,{hidden:g.detail.hidden})},focus:g=>{setTimeout(()=>g.target.focus({preventScroll:!1}),0)},userName:g=>{g.target.title=g.detail.userName},readonly:g=>{g.detail.readonly?g.target.setAttribute("readonly",""):g.target.removeAttribute("readonly")},required:g=>{this._setRequired(g.target,g.detail.required)},bgColor:g=>{s("bgColor","backgroundColor",g)},fillColor:g=>{s("fillColor","backgroundColor",g)},fgColor:g=>{s("fgColor","color",g)},textColor:g=>{s("textColor","color",g)},borderColor:g=>{s("borderColor","borderColor",g)},strokeColor:g=>{s("strokeColor","borderColor",g)},rotation:g=>{const P=g.detail.rotation;this.setRotation(P),this.annotationStorage.setValue(this.data.id,{rotation:P})}})}_dispatchEventFromSandbox(s,g){const P=this._commonActions;for(const v of Object.keys(g.detail)){const F=s[v]||P[v];F&&F(g)}}_setDefaultPropertiesFromJS(s){if(!this.enableScripting)return;const g=this.annotationStorage.getRawValue(this.data.id);if(!g)return;const P=this._commonActions;for(const[v,F]of Object.entries(g)){const j=P[v];if(j){const M={detail:{[v]:F},target:s};j(M),delete g[v]}}}_createQuadrilaterals(s=!1){if(!this.data.quadPoints)return null;const g=[],P=this.data.rect;for(const v of this.data.quadPoints)this.data.rect=[v[2].x,v[2].y,v[1].x,v[1].y],g.push(this._createContainer(s));return this.data.rect=P,g}_createPopup(s,g){let P=this.container;this.quadrilaterals&&(s=s||this.quadrilaterals,P=this.quadrilaterals[0]),s||(s=document.createElement("div"),s.className="popupTriggerArea",P.append(s));const F=new n({container:P,trigger:s,color:g.color,titleObj:g.titleObj,modificationDate:g.modificationDate,contentsObj:g.contentsObj,richText:g.richText,hideWrapper:!0}).render();F.style.left="100%",P.append(F)}_renderQuadrilaterals(s){for(const g of this.quadrilaterals)g.className=s;return this.quadrilaterals}render(){(0,e.unreachable)("Abstract method `AnnotationElement.render` called")}_getElementsByName(s,g=null){const P=[];if(this._fieldObjects){const v=this._fieldObjects[s];if(v)for(const{page:F,id:j,exportValues:M}of v){if(F===-1||j===g)continue;const m=typeof M=="string"?M:null,N=document.querySelector(`[data-element-id="${j}"]`);if(N&&!C.has(N)){(0,e.warn)(`_getElementsByName - element not allowed: ${j}`);continue}P.push({id:j,exportValue:m,domElement:N})}return P}for(const v of document.getElementsByName(s)){const{id:F,exportValue:j}=v;F!==g&&C.has(v)&&P.push({id:F,exportValue:j,domElement:v})}return P}static get platform(){const s=typeof navigator<"u"?navigator.platform:"";return(0,e.shadow)(this,"platform",{isWin:s.includes("Win"),isMac:s.includes("Mac")})}}class h extends T{constructor(s,g=null){super(s,{isRenderable:!0,ignoreBorder:!!(g!=null&&g.ignoreBorder),createQuadrilaterals:!0}),this.isTooltipOnly=s.data.isTooltipOnly}render(){const{data:s,linkService:g}=this,P=document.createElement("a");P.setAttribute("data-element-id",s.id);let v=!1;return s.url?(g.addLinkAttributes(P,s.url,s.newWindow),v=!0):s.action?(this._bindNamedAction(P,s.action),v=!0):s.dest?(this._bindLink(P,s.dest),v=!0):(s.actions&&(s.actions.Action||s.actions["Mouse Up"]||s.actions["Mouse Down"])&&this.enableScripting&&this.hasJSActions&&(this._bindJSAction(P,s),v=!0),s.resetForm?(this._bindResetFormAction(P,s.resetForm),v=!0):this.isTooltipOnly&&!v&&(this._bindLink(P,""),v=!0)),this.quadrilaterals?this._renderQuadrilaterals("linkAnnotation").map((F,j)=>{const M=j===0?P:P.cloneNode();return F.append(M),F}):(this.container.className="linkAnnotation",v&&this.container.append(P),this.container)}_bindLink(s,g){s.href=this.linkService.getDestinationHash(g),s.onclick=()=>(g&&this.linkService.goToDestination(g),!1),(g||g==="")&&(s.className="internalLink")}_bindNamedAction(s,g){s.href=this.linkService.getAnchorUrl(""),s.onclick=()=>(this.linkService.executeNamedAction(g),!1),s.className="internalLink"}_bindJSAction(s,g){s.href=this.linkService.getAnchorUrl("");const P=new Map([["Action","onclick"],["Mouse Up","onmouseup"],["Mouse Down","onmousedown"]]);for(const v of Object.keys(g.actions)){const F=P.get(v);F&&(s[F]=()=>{var j;return(j=this.linkService.eventBus)==null||j.dispatch("dispatcheventinsandbox",{source:this,detail:{id:g.id,name:v}}),!1})}s.onclick||(s.onclick=()=>!1),s.className="internalLink"}_bindResetFormAction(s,g){const P=s.onclick;if(P||(s.href=this.linkService.getAnchorUrl("")),s.className="internalLink",!this._fieldObjects){(0,e.warn)('_bindResetFormAction - "resetForm" action not supported, ensure that the `fieldObjects` parameter is provided.'),P||(s.onclick=()=>!1);return}s.onclick=()=>{var te;P&&P();const{fields:v,refs:F,include:j}=g,M=[];if(v.length!==0||F.length!==0){const H=new Set(F);for(const J of v){const ee=this._fieldObjects[J]||[];for(const{id:oe}of ee)H.add(oe)}for(const J of Object.values(this._fieldObjects))for(const ee of J)H.has(ee.id)===j&&M.push(ee)}else for(const H of Object.values(this._fieldObjects))M.push(...H);const m=this.annotationStorage,N=[];for(const H of M){const{id:J}=H;switch(N.push(J),H.type){case"text":{const oe=H.defaultValue||"";m.setValue(J,{value:oe});break}case"checkbox":case"radiobutton":{const oe=H.defaultValue===H.exportValues;m.setValue(J,{value:oe});break}case"combobox":case"listbox":{const oe=H.defaultValue||"";m.setValue(J,{value:oe});break}default:continue}const ee=document.querySelector(`[data-element-id="${J}"]`);if(ee){if(!C.has(ee)){(0,e.warn)(`_bindResetFormAction - element not allowed: ${J}`);continue}}else continue;ee.dispatchEvent(new Event("resetform"))}return this.enableScripting&&((te=this.linkService.eventBus)==null||te.dispatch("dispatcheventinsandbox",{source:this,detail:{id:"app",ids:N,name:"ResetForm"}})),!1}}}class t extends T{constructor(s){var P,v,F;const g=!!(s.data.hasPopup||(P=s.data.titleObj)!=null&&P.str||(v=s.data.contentsObj)!=null&&v.str||(F=s.data.richText)!=null&&F.str);super(s,{isRenderable:g})}render(){this.container.className="textAnnotation";const s=document.createElement("img");return s.src=this.imageResourcesPath+"annotation-"+this.data.name.toLowerCase()+".svg",s.alt="[{{type}} Annotation]",s.dataset.l10nId="text_annotation_type",s.dataset.l10nArgs=JSON.stringify({type:this.data.name}),this.data.hasPopup||this._createPopup(s,this.data),this.container.append(s),this.container}}class o extends T{render(){return this.data.alternativeText&&(this.container.title=this.data.alternativeText),this.container}_getKeyModifier(s){const{isWin:g,isMac:P}=T.platform;return g&&s.ctrlKey||P&&s.metaKey}_setEventListener(s,g,P,v){g.includes("mouse")?s.addEventListener(g,F=>{var j;(j=this.linkService.eventBus)==null||j.dispatch("dispatcheventinsandbox",{source:this,detail:{id:this.data.id,name:P,value:v(F),shift:F.shiftKey,modifier:this._getKeyModifier(F)}})}):s.addEventListener(g,F=>{var j;(j=this.linkService.eventBus)==null||j.dispatch("dispatcheventinsandbox",{source:this,detail:{id:this.data.id,name:P,value:v(F)}})})}_setEventListeners(s,g,P){var v;for(const[F,j]of g)(j==="Action"||(v=this.data.actions)!=null&&v[j])&&this._setEventListener(s,F,j,P)}_setBackgroundColor(s){const g=this.data.backgroundColor||null;s.style.backgroundColor=g===null?"transparent":e.Util.makeHexColor(g[0],g[1],g[2])}_setTextStyle(s){const g=["left","center","right"],{fontColor:P}=this.data.defaultAppearanceData,v=this.data.defaultAppearanceData.fontSize||f,F=s.style;let j;if(this.data.multiLine){const M=Math.abs(this.data.rect[3]-this.data.rect[1]),m=Math.round(M/(e.LINE_FACTOR*v))||1,N=M/m;j=Math.min(v,Math.round(N/e.LINE_FACTOR))}else{const M=Math.abs(this.data.rect[3]-this.data.rect[1]);j=Math.min(v,Math.round(M/e.LINE_FACTOR))}F.fontSize=`calc(${j}px * var(--scale-factor))`,F.color=e.Util.makeHexColor(P[0],P[1],P[2]),this.data.textAlignment!==null&&(F.textAlign=g[this.data.textAlignment])}_setRequired(s,g){g?s.setAttribute("required",!0):s.removeAttribute("required"),s.setAttribute("aria-required",g)}}class c extends o{constructor(s){const g=s.renderForms||!s.data.hasAppearance&&!!s.data.fieldValue;super(s,{isRenderable:g})}setPropertyOnSiblings(s,g,P,v){const F=this.annotationStorage;for(const j of this._getElementsByName(s.name,s.id))j.domElement&&(j.domElement[g]=P),F.setValue(j.id,{[v]:P})}render(){var v;const s=this.annotationStorage,g=this.data.id;this.container.className="textWidgetAnnotation";let P=null;if(this.renderForms){const F=s.getValue(g,{value:this.data.fieldValue});let j=F.formattedValue||F.value||"";const M=s.getValue(g,{charLimit:this.data.maxLen}).charLimit;M&&j.length>M&&(j=j.slice(0,M));const m={userValue:j,formattedValue:null,valueOnFocus:""};this.data.multiLine?(P=document.createElement("textarea"),P.textContent=j,this.data.doNotScroll&&(P.style.overflowY="hidden")):(P=document.createElement("input"),P.type="text",P.setAttribute("value",j),this.data.doNotScroll&&(P.style.overflowX="hidden")),C.add(P),P.setAttribute("data-element-id",g),P.disabled=this.data.readOnly,P.name=this.data.fieldName,P.tabIndex=_,this._setRequired(P,this.data.required),M&&(P.maxLength=M),P.addEventListener("input",te=>{s.setValue(g,{value:te.target.value}),this.setPropertyOnSiblings(P,"value",te.target.value,"value")}),P.addEventListener("resetform",te=>{const H=this.data.defaultFieldValue??"";P.value=m.userValue=H,m.formattedValue=null});let N=te=>{const{formattedValue:H}=m;H!=null&&(te.target.value=H),te.target.scrollLeft=0};if(this.enableScripting&&this.hasJSActions){P.addEventListener("focus",H=>{m.userValue&&(H.target.value=m.userValue),m.valueOnFocus=H.target.value}),P.addEventListener("updatefromsandbox",H=>{const J={value(ee){m.userValue=ee.detail.value??"",s.setValue(g,{value:m.userValue.toString()}),ee.target.value=m.userValue},formattedValue(ee){const{formattedValue:oe}=ee.detail;m.formattedValue=oe,oe!=null&&ee.target!==document.activeElement&&(ee.target.value=oe),s.setValue(g,{formattedValue:oe})},selRange(ee){ee.target.setSelectionRange(...ee.detail.selRange)},charLimit:ee=>{var _e;const{charLimit:oe}=ee.detail,{target:de}=ee;if(oe===0){de.removeAttribute("maxLength");return}de.setAttribute("maxLength",oe);let re=m.userValue;!re||re.length<=oe||(re=re.slice(0,oe),de.value=m.userValue=re,s.setValue(g,{value:re}),(_e=this.linkService.eventBus)==null||_e.dispatch("dispatcheventinsandbox",{source:this,detail:{id:g,name:"Keystroke",value:re,willCommit:!0,commitKey:1,selStart:de.selectionStart,selEnd:de.selectionEnd}}))}};this._dispatchEventFromSandbox(J,H)}),P.addEventListener("keydown",H=>{var oe;let J=-1;if(H.key==="Escape"?J=0:H.key==="Enter"?J=2:H.key==="Tab"&&(J=3),J===-1)return;const{value:ee}=H.target;m.valueOnFocus!==ee&&(m.userValue=ee,(oe=this.linkService.eventBus)==null||oe.dispatch("dispatcheventinsandbox",{source:this,detail:{id:g,name:"Keystroke",value:ee,willCommit:!0,commitKey:J,selStart:H.target.selectionStart,selEnd:H.target.selectionEnd}}))});const te=N;N=null,P.addEventListener("blur",H=>{var ee;const{value:J}=H.target;m.userValue=J,this._mouseState.isDown&&m.valueOnFocus!==J&&((ee=this.linkService.eventBus)==null||ee.dispatch("dispatcheventinsandbox",{source:this,detail:{id:g,name:"Keystroke",value:J,willCommit:!0,commitKey:1,selStart:H.target.selectionStart,selEnd:H.target.selectionEnd}})),te(H)}),(v=this.data.actions)!=null&&v.Keystroke&&P.addEventListener("beforeinput",H=>{var ge;const{data:J,target:ee}=H,{value:oe,selectionStart:de,selectionEnd:re}=ee;let _e=de,me=re;switch(H.inputType){case"deleteWordBackward":{const be=oe.substring(0,de).match(/\w*[^\w]*$/);be&&(_e-=be[0].length);break}case"deleteWordForward":{const be=oe.substring(de).match(/^[^\w]*\w*/);be&&(me+=be[0].length);break}case"deleteContentBackward":de===re&&(_e-=1);break;case"deleteContentForward":de===re&&(me+=1);break}H.preventDefault(),(ge=this.linkService.eventBus)==null||ge.dispatch("dispatcheventinsandbox",{source:this,detail:{id:g,name:"Keystroke",value:oe,change:J||"",willCommit:!1,selStart:_e,selEnd:me}})}),this._setEventListeners(P,[["focus","Focus"],["blur","Blur"],["mousedown","Mouse Down"],["mouseenter","Mouse Enter"],["mouseleave","Mouse Exit"],["mouseup","Mouse Up"]],H=>H.target.value)}if(N&&P.addEventListener("blur",N),this.data.comb){const H=(this.data.rect[2]-this.data.rect[0])/M;P.classList.add("comb"),P.style.letterSpacing=`calc(${H}px * var(--scale-factor) - 1ch)`}}else P=document.createElement("div"),P.textContent=this.data.fieldValue,P.style.verticalAlign="middle",P.style.display="table-cell";return this._setTextStyle(P),this._setBackgroundColor(P),this._setDefaultPropertiesFromJS(P),this.container.append(P),this.container}}class x extends o{constructor(s){super(s,{isRenderable:s.renderForms})}render(){const s=this.annotationStorage,g=this.data,P=g.id;let v=s.getValue(P,{value:g.exportValue===g.fieldValue}).value;typeof v=="string"&&(v=v!=="Off",s.setValue(P,{value:v})),this.container.className="buttonWidgetAnnotation checkBox";const F=document.createElement("input");return C.add(F),F.setAttribute("data-element-id",P),F.disabled=g.readOnly,this._setRequired(F,this.data.required),F.type="checkbox",F.name=g.fieldName,v&&F.setAttribute("checked",!0),F.setAttribute("exportValue",g.exportValue),F.tabIndex=_,F.addEventListener("change",j=>{const{name:M,checked:m}=j.target;for(const N of this._getElementsByName(M,P)){const te=m&&N.exportValue===g.exportValue;N.domElement&&(N.domElement.checked=te),s.setValue(N.id,{value:te})}s.setValue(P,{value:m})}),F.addEventListener("resetform",j=>{const M=g.defaultFieldValue||"Off";j.target.checked=M===g.exportValue}),this.enableScripting&&this.hasJSActions&&(F.addEventListener("updatefromsandbox",j=>{const M={value(m){m.target.checked=m.detail.value!=="Off",s.setValue(P,{value:m.target.checked})}};this._dispatchEventFromSandbox(M,j)}),this._setEventListeners(F,[["change","Validate"],["change","Action"],["focus","Focus"],["blur","Blur"],["mousedown","Mouse Down"],["mouseenter","Mouse Enter"],["mouseleave","Mouse Exit"],["mouseup","Mouse Up"]],j=>j.target.checked)),this._setBackgroundColor(F),this._setDefaultPropertiesFromJS(F),this.container.append(F),this.container}}class b extends o{constructor(s){super(s,{isRenderable:s.renderForms})}render(){this.container.className="buttonWidgetAnnotation radioButton";const s=this.annotationStorage,g=this.data,P=g.id;let v=s.getValue(P,{value:g.fieldValue===g.buttonValue}).value;typeof v=="string"&&(v=v!==g.buttonValue,s.setValue(P,{value:v}));const F=document.createElement("input");if(C.add(F),F.setAttribute("data-element-id",P),F.disabled=g.readOnly,this._setRequired(F,this.data.required),F.type="radio",F.name=g.fieldName,v&&F.setAttribute("checked",!0),F.tabIndex=_,F.addEventListener("change",j=>{const{name:M,checked:m}=j.target;for(const N of this._getElementsByName(M,P))s.setValue(N.id,{value:!1});s.setValue(P,{value:m})}),F.addEventListener("resetform",j=>{const M=g.defaultFieldValue;j.target.checked=M!=null&&M===g.buttonValue}),this.enableScripting&&this.hasJSActions){const j=g.buttonValue;F.addEventListener("updatefromsandbox",M=>{const m={value:N=>{const te=j===N.detail.value;for(const H of this._getElementsByName(N.target.name)){const J=te&&H.id===P;H.domElement&&(H.domElement.checked=J),s.setValue(H.id,{value:J})}}};this._dispatchEventFromSandbox(m,M)}),this._setEventListeners(F,[["change","Validate"],["change","Action"],["focus","Focus"],["blur","Blur"],["mousedown","Mouse Down"],["mouseenter","Mouse Enter"],["mouseleave","Mouse Exit"],["mouseup","Mouse Up"]],M=>M.target.checked)}return this._setBackgroundColor(F),this._setDefaultPropertiesFromJS(F),this.container.append(F),this.container}}class d extends h{constructor(s){super(s,{ignoreBorder:s.data.hasAppearance})}render(){const s=super.render();s.className="buttonWidgetAnnotation pushButton",this.data.alternativeText&&(s.title=this.data.alternativeText);const g=s.lastChild;return this.enableScripting&&this.hasJSActions&&g&&(this._setDefaultPropertiesFromJS(g),g.addEventListener("updatefromsandbox",P=>{this._dispatchEventFromSandbox({},P)})),s}}class i extends o{constructor(s){super(s,{isRenderable:s.renderForms})}render(){this.container.className="choiceWidgetAnnotation";const s=this.annotationStorage,g=this.data.id,P=s.getValue(g,{value:this.data.fieldValue}),v=document.createElement("select");C.add(v),v.setAttribute("data-element-id",g),v.disabled=this.data.readOnly,this._setRequired(v,this.data.required),v.name=this.data.fieldName,v.tabIndex=_;let F=this.data.combo&&this.data.options.length>0;this.data.combo||(v.size=this.data.options.length,this.data.multiSelect&&(v.multiple=!0)),v.addEventListener("resetform",N=>{const te=this.data.defaultFieldValue;for(const H of v.options)H.selected=H.value===te});for(const N of this.data.options){const te=document.createElement("option");te.textContent=N.displayValue,te.value=N.exportValue,P.value.includes(N.exportValue)&&(te.setAttribute("selected",!0),F=!1),v.append(te)}let j=null;if(F){const N=document.createElement("option");N.value=" ",N.setAttribute("hidden",!0),N.setAttribute("selected",!0),v.prepend(N),j=()=>{N.remove(),v.removeEventListener("input",j),j=null},v.addEventListener("input",j)}const M=(N,te)=>{const H=te?"value":"textContent",J=N.target.options;return N.target.multiple?Array.prototype.filter.call(J,ee=>ee.selected).map(ee=>ee[H]):J.selectedIndex===-1?null:J[J.selectedIndex][H]},m=N=>{const te=N.target.options;return Array.prototype.map.call(te,H=>({displayValue:H.textContent,exportValue:H.value}))};return this.enableScripting&&this.hasJSActions?(v.addEventListener("updatefromsandbox",N=>{const te={value(H){j==null||j();const J=H.detail.value,ee=new Set(Array.isArray(J)?J:[J]);for(const oe of v.options)oe.selected=ee.has(oe.value);s.setValue(g,{value:M(H,!0)})},multipleSelection(H){v.multiple=!0},remove(H){const J=v.options,ee=H.detail.remove;J[ee].selected=!1,v.remove(ee),J.length>0&&Array.prototype.findIndex.call(J,de=>de.selected)===-1&&(J[0].selected=!0),s.setValue(g,{value:M(H,!0),items:m(H)})},clear(H){for(;v.length!==0;)v.remove(0);s.setValue(g,{value:null,items:[]})},insert(H){const{index:J,displayValue:ee,exportValue:oe}=H.detail.insert,de=v.children[J],re=document.createElement("option");re.textContent=ee,re.value=oe,de?de.before(re):v.append(re),s.setValue(g,{value:M(H,!0),items:m(H)})},items(H){const{items:J}=H.detail;for(;v.length!==0;)v.remove(0);for(const ee of J){const{displayValue:oe,exportValue:de}=ee,re=document.createElement("option");re.textContent=oe,re.value=de,v.append(re)}v.options.length>0&&(v.options[0].selected=!0),s.setValue(g,{value:M(H,!0),items:m(H)})},indices(H){const J=new Set(H.detail.indices);for(const ee of H.target.options)ee.selected=J.has(ee.index);s.setValue(g,{value:M(H,!0)})},editable(H){H.target.disabled=!H.detail.editable}};this._dispatchEventFromSandbox(te,N)}),v.addEventListener("input",N=>{var J;const te=M(N,!0),H=M(N,!1);s.setValue(g,{value:te}),(J=this.linkService.eventBus)==null||J.dispatch("dispatcheventinsandbox",{source:this,detail:{id:g,name:"Keystroke",value:H,changeEx:te,willCommit:!0,commitKey:1,keyDown:!1}})}),this._setEventListeners(v,[["focus","Focus"],["blur","Blur"],["mousedown","Mouse Down"],["mouseenter","Mouse Enter"],["mouseleave","Mouse Exit"],["mouseup","Mouse Up"],["input","Action"]],N=>N.target.checked)):v.addEventListener("input",function(N){s.setValue(g,{value:M(N,!0)})}),this.data.combo&&this._setTextStyle(v),this._setBackgroundColor(v),this._setDefaultPropertiesFromJS(v),this.container.append(v),this.container}}class l extends T{constructor(s){var P,v,F;const g=!!((P=s.data.titleObj)!=null&&P.str||(v=s.data.contentsObj)!=null&&v.str||(F=s.data.richText)!=null&&F.str);super(s,{isRenderable:g})}render(){const s=["Line","Square","Circle","PolyLine","Polygon","Ink"];if(this.container.className="popupAnnotation",s.includes(this.data.parentType))return this.container;const g=`[data-annotation-id="${this.data.parentId}"]`,P=this.layer.querySelectorAll(g);if(P.length===0)return this.container;const v=new n({container:this.container,trigger:Array.from(P),color:this.data.color,titleObj:this.data.titleObj,modificationDate:this.data.modificationDate,contentsObj:this.data.contentsObj,richText:this.data.richText}),F=this.page,j=e.Util.normalizeRect([this.data.parentRect[0],F.view[3]-this.data.parentRect[1]+F.view[1],this.data.parentRect[2],F.view[3]-this.data.parentRect[3]+F.view[1]]),M=j[0]+this.data.parentRect[2]-this.data.parentRect[0],m=j[1],[N,te,H,J]=this.viewport.viewBox,ee=H-N,oe=J-te;return this.container.style.left=`${100*(M-N)/ee}%`,this.container.style.top=`${100*(m-te)/oe}%`,this.container.append(v.render()),this.container}}class n{constructor(s){this.container=s.container,this.trigger=s.trigger,this.color=s.color,this.titleObj=s.titleObj,this.modificationDate=s.modificationDate,this.contentsObj=s.contentsObj,this.richText=s.richText,this.hideWrapper=s.hideWrapper||!1,this.pinned=!1}render(){var M,m;const g=document.createElement("div");g.className="popupWrapper",this.hideElement=this.hideWrapper?g:this.container,this.hideElement.hidden=!0;const P=document.createElement("div");P.className="popup";const v=this.color;if(v){const N=.7*(255-v[0])+v[0],te=.7*(255-v[1])+v[1],H=.7*(255-v[2])+v[2];P.style.backgroundColor=e.Util.makeHexColor(N|0,te|0,H|0)}const F=document.createElement("h1");F.dir=this.titleObj.dir,F.textContent=this.titleObj.str,P.append(F);const j=a.PDFDateString.toDateObject(this.modificationDate);if(j){const N=document.createElement("span");N.className="popupDate",N.textContent="{{date}}, {{time}}",N.dataset.l10nId="annotation_date_string",N.dataset.l10nArgs=JSON.stringify({date:j.toLocaleDateString(),time:j.toLocaleTimeString()}),P.append(N)}if((M=this.richText)!=null&&M.str&&(!((m=this.contentsObj)!=null&&m.str)||this.contentsObj.str===this.richText.str))S.XfaLayer.render({xfaHtml:this.richText.html,intent:"richText",div:P}),P.lastChild.className="richText popupContent";else{const N=this._formatContents(this.contentsObj);P.append(N)}Array.isArray(this.trigger)||(this.trigger=[this.trigger]);for(const N of this.trigger)N.addEventListener("click",this._toggle.bind(this)),N.addEventListener("mouseover",this._show.bind(this,!1)),N.addEventListener("mouseout",this._hide.bind(this,!1));return P.addEventListener("click",this._hide.bind(this,!0)),g.append(P),g}_formatContents({str:s,dir:g}){const P=document.createElement("p");P.className="popupContent",P.dir=g;const v=s.split(/(?:\r\n?|\n)/);for(let F=0,j=v.length;F<j;++F){const M=v[F];P.append(document.createTextNode(M)),F<j-1&&P.append(document.createElement("br"))}return P}_toggle(){this.pinned?this._hide(!0):this._show(!0)}_show(s=!1){s&&(this.pinned=!0),this.hideElement.hidden&&(this.hideElement.hidden=!1,this.container.style.zIndex=parseInt(this.container.style.zIndex)+1e3)}_hide(s=!0){s&&(this.pinned=!1),!this.hideElement.hidden&&!this.pinned&&(this.hideElement.hidden=!0,this.container.style.zIndex=parseInt(this.container.style.zIndex)-1e3)}}class E extends T{constructor(s){var P,v,F;const g=!!(s.data.hasPopup||(P=s.data.titleObj)!=null&&P.str||(v=s.data.contentsObj)!=null&&v.str||(F=s.data.richText)!=null&&F.str);super(s,{isRenderable:g,ignoreBorder:!0}),this.textContent=s.data.textContent}render(){if(this.container.className="freeTextAnnotation",this.textContent){const s=document.createElement("div");s.className="annotationTextContent",s.setAttribute("role","comment");for(const g of this.textContent){const P=document.createElement("span");P.textContent=g,s.append(P)}this.container.append(s)}return this.data.hasPopup||this._createPopup(null,this.data),this.container}}class R extends T{constructor(s){var P,v,F;const g=!!(s.data.hasPopup||(P=s.data.titleObj)!=null&&P.str||(v=s.data.contentsObj)!=null&&v.str||(F=s.data.richText)!=null&&F.str);super(s,{isRenderable:g,ignoreBorder:!0})}render(){this.container.className="lineAnnotation";const s=this.data,{width:g,height:P}=L(s.rect),v=this.svgFactory.create(g,P,!0),F=this.svgFactory.createElement("svg:line");return F.setAttribute("x1",s.rect[2]-s.lineCoordinates[0]),F.setAttribute("y1",s.rect[3]-s.lineCoordinates[1]),F.setAttribute("x2",s.rect[2]-s.lineCoordinates[2]),F.setAttribute("y2",s.rect[3]-s.lineCoordinates[3]),F.setAttribute("stroke-width",s.borderStyle.width||1),F.setAttribute("stroke","transparent"),F.setAttribute("fill","transparent"),v.append(F),this.container.append(v),this._createPopup(F,s),this.container}}class G extends T{constructor(s){var P,v,F;const g=!!(s.data.hasPopup||(P=s.data.titleObj)!=null&&P.str||(v=s.data.contentsObj)!=null&&v.str||(F=s.data.richText)!=null&&F.str);super(s,{isRenderable:g,ignoreBorder:!0})}render(){this.container.className="squareAnnotation";const s=this.data,{width:g,height:P}=L(s.rect),v=this.svgFactory.create(g,P,!0),F=s.borderStyle.width,j=this.svgFactory.createElement("svg:rect");return j.setAttribute("x",F/2),j.setAttribute("y",F/2),j.setAttribute("width",g-F),j.setAttribute("height",P-F),j.setAttribute("stroke-width",F||1),j.setAttribute("stroke","transparent"),j.setAttribute("fill","transparent"),v.append(j),this.container.append(v),this._createPopup(j,s),this.container}}class q extends T{constructor(s){var P,v,F;const g=!!(s.data.hasPopup||(P=s.data.titleObj)!=null&&P.str||(v=s.data.contentsObj)!=null&&v.str||(F=s.data.richText)!=null&&F.str);super(s,{isRenderable:g,ignoreBorder:!0})}render(){this.container.className="circleAnnotation";const s=this.data,{width:g,height:P}=L(s.rect),v=this.svgFactory.create(g,P,!0),F=s.borderStyle.width,j=this.svgFactory.createElement("svg:ellipse");return j.setAttribute("cx",g/2),j.setAttribute("cy",P/2),j.setAttribute("rx",g/2-F/2),j.setAttribute("ry",P/2-F/2),j.setAttribute("stroke-width",F||1),j.setAttribute("stroke","transparent"),j.setAttribute("fill","transparent"),v.append(j),this.container.append(v),this._createPopup(j,s),this.container}}class se extends T{constructor(s){var P,v,F;const g=!!(s.data.hasPopup||(P=s.data.titleObj)!=null&&P.str||(v=s.data.contentsObj)!=null&&v.str||(F=s.data.richText)!=null&&F.str);super(s,{isRenderable:g,ignoreBorder:!0}),this.containerClassName="polylineAnnotation",this.svgElementName="svg:polyline"}render(){this.container.className=this.containerClassName;const s=this.data,{width:g,height:P}=L(s.rect),v=this.svgFactory.create(g,P,!0);let F=[];for(const M of s.vertices){const m=M.x-s.rect[0],N=s.rect[3]-M.y;F.push(m+","+N)}F=F.join(" ");const j=this.svgFactory.createElement(this.svgElementName);return j.setAttribute("points",F),j.setAttribute("stroke-width",s.borderStyle.width||1),j.setAttribute("stroke","transparent"),j.setAttribute("fill","transparent"),v.append(j),this.container.append(v),this._createPopup(j,s),this.container}}class ae extends se{constructor(s){super(s),this.containerClassName="polygonAnnotation",this.svgElementName="svg:polygon"}}class Z extends T{constructor(s){var P,v,F;const g=!!(s.data.hasPopup||(P=s.data.titleObj)!=null&&P.str||(v=s.data.contentsObj)!=null&&v.str||(F=s.data.richText)!=null&&F.str);super(s,{isRenderable:g,ignoreBorder:!0})}render(){return this.container.className="caretAnnotation",this.data.hasPopup||this._createPopup(null,this.data),this.container}}class Q extends T{constructor(s){var P,v,F;const g=!!(s.data.hasPopup||(P=s.data.titleObj)!=null&&P.str||(v=s.data.contentsObj)!=null&&v.str||(F=s.data.richText)!=null&&F.str);super(s,{isRenderable:g,ignoreBorder:!0}),this.containerClassName="inkAnnotation",this.svgElementName="svg:polyline"}render(){this.container.className=this.containerClassName;const s=this.data,{width:g,height:P}=L(s.rect),v=this.svgFactory.create(g,P,!0);for(const F of s.inkLists){let j=[];for(const m of F){const N=m.x-s.rect[0],te=s.rect[3]-m.y;j.push(`${N},${te}`)}j=j.join(" ");const M=this.svgFactory.createElement(this.svgElementName);M.setAttribute("points",j),M.setAttribute("stroke-width",s.borderStyle.width||1),M.setAttribute("stroke","transparent"),M.setAttribute("fill","transparent"),this._createPopup(M,s),v.append(M)}return this.container.append(v),this.container}}class z extends T{constructor(s){var P,v,F;const g=!!(s.data.hasPopup||(P=s.data.titleObj)!=null&&P.str||(v=s.data.contentsObj)!=null&&v.str||(F=s.data.richText)!=null&&F.str);super(s,{isRenderable:g,ignoreBorder:!0,createQuadrilaterals:!0})}render(){return this.data.hasPopup||this._createPopup(null,this.data),this.quadrilaterals?this._renderQuadrilaterals("highlightAnnotation"):(this.container.className="highlightAnnotation",this.container)}}class V extends T{constructor(s){var P,v,F;const g=!!(s.data.hasPopup||(P=s.data.titleObj)!=null&&P.str||(v=s.data.contentsObj)!=null&&v.str||(F=s.data.richText)!=null&&F.str);super(s,{isRenderable:g,ignoreBorder:!0,createQuadrilaterals:!0})}render(){return this.data.hasPopup||this._createPopup(null,this.data),this.quadrilaterals?this._renderQuadrilaterals("underlineAnnotation"):(this.container.className="underlineAnnotation",this.container)}}class X extends T{constructor(s){var P,v,F;const g=!!(s.data.hasPopup||(P=s.data.titleObj)!=null&&P.str||(v=s.data.contentsObj)!=null&&v.str||(F=s.data.richText)!=null&&F.str);super(s,{isRenderable:g,ignoreBorder:!0,createQuadrilaterals:!0})}render(){return this.data.hasPopup||this._createPopup(null,this.data),this.quadrilaterals?this._renderQuadrilaterals("squigglyAnnotation"):(this.container.className="squigglyAnnotation",this.container)}}class ne extends T{constructor(s){var P,v,F;const g=!!(s.data.hasPopup||(P=s.data.titleObj)!=null&&P.str||(v=s.data.contentsObj)!=null&&v.str||(F=s.data.richText)!=null&&F.str);super(s,{isRenderable:g,ignoreBorder:!0,createQuadrilaterals:!0})}render(){return this.data.hasPopup||this._createPopup(null,this.data),this.quadrilaterals?this._renderQuadrilaterals("strikeoutAnnotation"):(this.container.className="strikeoutAnnotation",this.container)}}class le extends T{constructor(s){var P,v,F;const g=!!(s.data.hasPopup||(P=s.data.titleObj)!=null&&P.str||(v=s.data.contentsObj)!=null&&v.str||(F=s.data.richText)!=null&&F.str);super(s,{isRenderable:g,ignoreBorder:!0})}render(){return this.container.className="stampAnnotation",this.data.hasPopup||this._createPopup(null,this.data),this.container}}class fe extends T{constructor(s){var v;super(s,{isRenderable:!0});const{filename:g,content:P}=this.data.file;this.filename=(0,a.getFilenameFromUrl)(g),this.content=P,(v=this.linkService.eventBus)==null||v.dispatch("fileattachmentannotation",{source:this,filename:g,content:P})}render(){var g,P;this.container.className="fileAttachmentAnnotation";const s=document.createElement("div");return s.className="popupTriggerArea",s.addEventListener("dblclick",this._download.bind(this)),!this.data.hasPopup&&((g=this.data.titleObj)!=null&&g.str||(P=this.data.contentsObj)!=null&&P.str||this.data.richText)&&this._createPopup(s,this.data),this.container.append(s),this.container}_download(){var s;(s=this.downloadManager)==null||s.openOrDownloadData(this.container,this.content,this.filename)}}const B=class B{static render(s){var M,m;const{annotations:g,div:P,viewport:v,accessibilityManager:F}=s;ce(this,p,St).call(this,P,v);let j=0;for(const N of g){if(N.annotationType!==e.AnnotationType.POPUP){const{width:H,height:J}=L(N.rect);if(H<=0||J<=0)continue}const te=w.create({data:N,layer:P,page:s.page,viewport:v,linkService:s.linkService,downloadManager:s.downloadManager,imageResourcesPath:s.imageResourcesPath||"",renderForms:s.renderForms!==!1,svgFactory:new a.DOMSVGFactory,annotationStorage:s.annotationStorage||new k.AnnotationStorage,enableScripting:s.enableScripting,hasJSActions:s.hasJSActions,fieldObjects:s.fieldObjects,mouseState:s.mouseState||{isDown:!1}});if(te.isRenderable){const H=te.render();if(N.hidden&&(H.style.visibility="hidden"),Array.isArray(H))for(const J of H)J.style.zIndex=j++,ce(M=B,p,At).call(M,J,N.id,P,F);else H.style.zIndex=j++,te instanceof l?P.prepend(H):ce(m=B,p,At).call(m,H,N.id,P,F)}}ce(this,p,Et).call(this,P,s.annotationCanvasMap)}static update(s){const{annotationCanvasMap:g,div:P,viewport:v}=s;ce(this,p,St).call(this,P,v),ce(this,p,Et).call(this,P,g),P.hidden=!1}};p=new WeakSet,At=function(s,g,P,v){const F=s.firstChild||s;F.id=`${a.AnnotationPrefix}${g}`,P.append(s),v==null||v.moveElementInDOM(P,s,F,!1)},St=function(s,{width:g,height:P,rotation:v}){const{style:F}=s,j=v%180!==0,M=Math.floor(g)+"px",m=Math.floor(P)+"px";F.width=j?m:M,F.height=j?M:m,s.setAttribute("data-main-rotation",v)},Et=function(s,g){if(g){for(const[P,v]of g){const F=s.querySelector(`[data-annotation-id="${P}"]`);if(!F)continue;const{firstChild:j}=F;j?j.nodeName==="CANVAS"?j.replaceWith(v):j.before(v):F.append(v)}g.clear()}},ue(B,p);let $=B;r.AnnotationLayer=$},(A,r)=>{Object.defineProperty(r,"__esModule",{value:!0}),r.ColorConverters=void 0;function y(a){return Math.floor(Math.max(0,Math.min(1,a))*255).toString(16).padStart(2,"0")}class e{static CMYK_G([k,O,S,_]){return["G",1-Math.min(1,.3*k+.59*S+.11*O+_)]}static G_CMYK([k]){return["CMYK",0,0,0,1-k]}static G_RGB([k]){return["RGB",k,k,k]}static G_HTML([k]){const O=y(k);return`#${O}${O}${O}`}static RGB_G([k,O,S]){return["G",.3*k+.59*O+.11*S]}static RGB_HTML([k,O,S]){const _=y(k),f=y(O),C=y(S);return`#${_}${f}${C}`}static T_HTML(){return"#00000000"}static CMYK_RGB([k,O,S,_]){return["RGB",1-Math.min(1,k+_),1-Math.min(1,S+_),1-Math.min(1,O+_)]}static CMYK_HTML(k){const O=this.CMYK_RGB(k).slice(1);return this.RGB_HTML(O)}static RGB_CMYK([k,O,S]){const _=1-k,f=1-O,C=1-S,L=Math.min(_,f,C);return["CMYK",_,f,C,L]}}r.ColorConverters=e},(A,r,y)=>{Object.defineProperty(r,"__esModule",{value:!0}),r.XfaLayer=void 0;var e=y(20);class a{static setupStorage(O,S,_,f,C){const L=f.getValue(S,{value:null});switch(_.name){case"textarea":if(L.value!==null&&(O.textContent=L.value),C==="print")break;O.addEventListener("input",w=>{f.setValue(S,{value:w.target.value})});break;case"input":if(_.attributes.type==="radio"||_.attributes.type==="checkbox"){if(L.value===_.attributes.xfaOn?O.setAttribute("checked",!0):L.value===_.attributes.xfaOff&&O.removeAttribute("checked"),C==="print")break;O.addEventListener("change",w=>{f.setValue(S,{value:w.target.checked?w.target.getAttribute("xfaOn"):w.target.getAttribute("xfaOff")})})}else{if(L.value!==null&&O.setAttribute("value",L.value),C==="print")break;O.addEventListener("input",w=>{f.setValue(S,{value:w.target.value})})}break;case"select":if(L.value!==null)for(const w of _.children)w.attributes.value===L.value&&(w.attributes.selected=!0);O.addEventListener("input",w=>{const T=w.target.options,h=T.selectedIndex===-1?"":T[T.selectedIndex].value;f.setValue(S,{value:h})});break}}static setAttributes({html:O,element:S,storage:_=null,intent:f,linkService:C}){const{attributes:L}=S,w=O instanceof HTMLAnchorElement;L.type==="radio"&&(L.name=`${L.name}-${f}`);for(const[T,h]of Object.entries(L))if(h!=null)switch(T){case"class":h.length&&O.setAttribute(T,h.join(" "));break;case"dataId":break;case"id":O.setAttribute("data-element-id",h);break;case"style":Object.assign(O.style,h);break;case"textContent":O.textContent=h;break;default:(!w||T!=="href"&&T!=="newWindow")&&O.setAttribute(T,h)}w&&C.addLinkAttributes(O,L.href,L.newWindow),_&&L.dataId&&this.setupStorage(O,L.dataId,S,_)}static render(O){var t;const S=O.annotationStorage,_=O.linkService,f=O.xfaHtml,C=O.intent||"display",L=document.createElement(f.name);f.attributes&&this.setAttributes({html:L,element:f,intent:C,linkService:_});const w=[[f,-1,L]],T=O.div;if(T.append(L),O.viewport){const o=`matrix(${O.viewport.transform.join(",")})`;T.style.transform=o}C!=="richText"&&T.setAttribute("class","xfaLayer xfaFont");const h=[];for(;w.length>0;){const[o,c,x]=w.at(-1);if(c+1===o.children.length){w.pop();continue}const b=o.children[++w.at(-1)[1]];if(b===null)continue;const{name:d}=b;if(d==="#text"){const l=document.createTextNode(b.value);h.push(l),x.append(l);continue}let i;if((t=b==null?void 0:b.attributes)!=null&&t.xmlns?i=document.createElementNS(b.attributes.xmlns,d):i=document.createElement(d),x.append(i),b.attributes&&this.setAttributes({html:i,element:b,storage:S,intent:C,linkService:_}),b.children&&b.children.length>0)w.push([b,-1,i]);else if(b.value){const l=document.createTextNode(b.value);e.XfaText.shouldBuildText(d)&&h.push(l),i.append(l)}}for(const o of T.querySelectorAll(".xfaNonInteractive input, .xfaNonInteractive textarea"))o.setAttribute("readOnly",!0);return{textDivs:h}}static update(O){const S=`matrix(${O.viewport.transform.join(",")})`;O.div.style.transform=S,O.div.hidden=!1}}r.XfaLayer=a},(A,r,y)=>{Object.defineProperty(r,"__esModule",{value:!0}),r.TextLayerRenderTask=void 0,r.renderTextLayer=x;var e=y(1),a=y(8);const k=1e5,O=30,S=.8,_=new Map,f=/^\s+$/g;function C(b,d){const i=_.get(b);if(i)return i;d.save(),d.font=`${O}px ${b}`;const l=d.measureText("");let n=l.fontBoundingBoxAscent,E=Math.abs(l.fontBoundingBoxDescent);if(n){d.restore();const G=n/(n+E);return _.set(b,G),G}d.strokeStyle="red",d.clearRect(0,0,O,O),d.strokeText("g",0,0);let R=d.getImageData(0,0,O,O).data;E=0;for(let G=R.length-1-3;G>=0;G-=4)if(R[G]>0){E=Math.ceil(G/4/O);break}d.clearRect(0,0,O,O),d.strokeText("A",0,O),R=d.getImageData(0,0,O,O).data,n=0;for(let G=0,q=R.length;G<q;G+=4)if(R[G]>0){n=O-Math.floor(G/4/O);break}if(d.restore(),n){const G=n/(n+E);return _.set(b,G),G}return _.set(b,S),S}function L(b,d,i,l){const n=document.createElement("span"),E=b._enhanceTextSelection?{angle:0,canvasWidth:0,hasText:d.str!=="",hasEOL:d.hasEOL,originalTransform:null,paddingBottom:0,paddingLeft:0,paddingRight:0,paddingTop:0,scale:1,fontSize:0}:{angle:0,canvasWidth:0,hasText:d.str!=="",hasEOL:d.hasEOL,fontSize:0};b._textDivs.push(n);const R=e.Util.transform(b._viewport.transform,d.transform);let G=Math.atan2(R[1],R[0]);const q=i[d.fontName];q.vertical&&(G+=Math.PI/2);const se=Math.hypot(R[2],R[3]),ae=se*C(q.fontFamily,l);let Z,Q;G===0?(Z=R[4],Q=R[5]-ae):(Z=R[4]+ae*Math.sin(G),Q=R[5]-ae*Math.cos(G)),n.style.left=`${Z}px`,n.style.top=`${Q}px`,n.style.fontSize=`${se}px`,n.style.fontFamily=q.fontFamily,E.fontSize=se,n.setAttribute("role","presentation"),n.textContent=d.str,n.dir=d.dir,b._fontInspectorEnabled&&(n.dataset.fontName=d.fontName),G!==0&&(E.angle=G*(180/Math.PI));let z=!1;if(d.str.length>1||b._enhanceTextSelection&&f.test(d.str))z=!0;else if(d.str!==" "&&d.transform[0]!==d.transform[3]){const V=Math.abs(d.transform[0]),X=Math.abs(d.transform[3]);V!==X&&Math.max(V,X)/Math.min(V,X)>1.5&&(z=!0)}if(z&&(q.vertical?E.canvasWidth=d.height*b._viewport.scale:E.canvasWidth=d.width*b._viewport.scale),b._textDivProperties.set(n,E),b._textContentStream&&b._layoutText(n),b._enhanceTextSelection&&E.hasText){let V=1,X=0;G!==0&&(V=Math.cos(G),X=Math.sin(G));const ne=(q.vertical?d.height:d.width)*b._viewport.scale,le=se;let fe,$;G!==0?(fe=[V,X,-X,V,Z,Q],$=e.Util.getAxialAlignedBoundingBox([0,0,ne,le],fe)):$=[Z,Q,Z+ne,Q+le],b._bounds.push({left:$[0],top:$[1],right:$[2],bottom:$[3],div:n,size:[ne,le],m:fe})}}function w(b){if(b._canceled)return;const d=b._textDivs,i=b._capability,l=d.length;if(l>k){b._renderingDone=!0,i.resolve();return}if(!b._textContentStream)for(let n=0;n<l;n++)b._layoutText(d[n]);b._renderingDone=!0,i.resolve()}function T(b,d,i){let l=0;for(let n=0;n<i;n++){const E=b[d++];E>0&&(l=l?Math.min(E,l):E)}return l}function h(b){const d=b._bounds,i=b._viewport,l=t(i.width,i.height,d);for(let n=0;n<l.length;n++){const E=d[n].div,R=b._textDivProperties.get(E);if(R.angle===0){R.paddingLeft=d[n].left-l[n].left,R.paddingTop=d[n].top-l[n].top,R.paddingRight=l[n].right-d[n].right,R.paddingBottom=l[n].bottom-d[n].bottom,b._textDivProperties.set(E,R);continue}const G=l[n],q=d[n],se=q.m,ae=se[0],Z=se[1],Q=[[0,0],[0,q.size[1]],[q.size[0],0],q.size],z=new Float64Array(64);for(let X=0,ne=Q.length;X<ne;X++){const le=e.Util.applyTransform(Q[X],se);z[X+0]=ae&&(G.left-le[0])/ae,z[X+4]=Z&&(G.top-le[1])/Z,z[X+8]=ae&&(G.right-le[0])/ae,z[X+12]=Z&&(G.bottom-le[1])/Z,z[X+16]=Z&&(G.left-le[0])/-Z,z[X+20]=ae&&(G.top-le[1])/ae,z[X+24]=Z&&(G.right-le[0])/-Z,z[X+28]=ae&&(G.bottom-le[1])/ae,z[X+32]=ae&&(G.left-le[0])/-ae,z[X+36]=Z&&(G.top-le[1])/-Z,z[X+40]=ae&&(G.right-le[0])/-ae,z[X+44]=Z&&(G.bottom-le[1])/-Z,z[X+48]=Z&&(G.left-le[0])/Z,z[X+52]=ae&&(G.top-le[1])/-ae,z[X+56]=Z&&(G.right-le[0])/Z,z[X+60]=ae&&(G.bottom-le[1])/-ae}const V=1+Math.min(Math.abs(ae),Math.abs(Z));R.paddingLeft=T(z,32,16)/V,R.paddingTop=T(z,48,16)/V,R.paddingRight=T(z,0,16)/V,R.paddingBottom=T(z,16,16)/V,b._textDivProperties.set(E,R)}}function t(b,d,i){const l=i.map(function(E,R){return{x1:E.left,y1:E.top,x2:E.right,y2:E.bottom,index:R,x1New:void 0,x2New:void 0}});o(b,l);const n=new Array(i.length);for(const E of l){const R=E.index;n[R]={left:E.x1New,top:0,right:E.x2New,bottom:0}}i.map(function(E,R){const G=n[R],q=l[R];q.x1=E.top,q.y1=b-G.right,q.x2=E.bottom,q.y2=b-G.left,q.index=R,q.x1New=void 0,q.x2New=void 0}),o(d,l);for(const E of l){const R=E.index;n[R].top=E.x1New,n[R].bottom=E.x2New}return n}function o(b,d){d.sort(function(n,E){return n.x1-E.x1||n.index-E.index});const l=[{start:-1/0,end:1/0,boundary:{x1:-1/0,y1:-1/0,x2:0,y2:1/0,index:-1,x1New:0,x2New:0}}];for(const n of d){let E=0;for(;E<l.length&&l[E].end<=n.y1;)E++;let R=l.length-1;for(;R>=0&&l[R].start>=n.y2;)R--;let G,q,se,ae,Z=-1/0;for(se=E;se<=R;se++){G=l[se],q=G.boundary;let V;q.x2>n.x1?V=q.index>n.index?q.x1New:n.x1:q.x2New===void 0?V=(q.x2+n.x1)/2:V=q.x2New,V>Z&&(Z=V)}for(n.x1New=Z,se=E;se<=R;se++)G=l[se],q=G.boundary,q.x2New===void 0?q.x2>n.x1?q.index>n.index&&(q.x2New=q.x2):q.x2New=Z:q.x2New>Z&&(q.x2New=Math.max(Z,q.x2));const Q=[];let z=null;for(se=E;se<=R;se++){G=l[se],q=G.boundary;const V=q.x2>n.x2?q:n;z===V?Q.at(-1).end=G.end:(Q.push({start:G.start,end:G.end,boundary:V}),z=V)}for(l[E].start<n.y1&&(Q[0].start=n.y1,Q.unshift({start:l[E].start,end:n.y1,boundary:l[E].boundary})),n.y2<l[R].end&&(Q.at(-1).end=n.y2,Q.push({start:n.y2,end:l[R].end,boundary:l[R].boundary})),se=E;se<=R;se++){if(G=l[se],q=G.boundary,q.x2New!==void 0)continue;let V=!1;for(ae=E-1;!V&&ae>=0&&l[ae].start>=q.y1;ae--)V=l[ae].boundary===q;for(ae=R+1;!V&&ae<l.length&&l[ae].end<=q.y2;ae++)V=l[ae].boundary===q;for(ae=0;!V&&ae<Q.length;ae++)V=Q[ae].boundary===q;V||(q.x2New=Z)}Array.prototype.splice.apply(l,[E,R-E+1,...Q])}for(const n of l){const E=n.boundary;E.x2New===void 0&&(E.x2New=Math.max(b,E.x2))}}class c{constructor({textContent:d,textContentStream:i,container:l,viewport:n,textDivs:E,textContentItemsStr:R,enhanceTextSelection:G}){var q;G&&(0,a.deprecated)("The `enhanceTextSelection` functionality will be removed in the future."),this._textContent=d,this._textContentStream=i,this._container=l,this._document=l.ownerDocument,this._viewport=n,this._textDivs=E||[],this._textContentItemsStr=R||[],this._enhanceTextSelection=!!G,this._fontInspectorEnabled=!!((q=globalThis.FontInspector)!=null&&q.enabled),this._reader=null,this._layoutTextLastFontSize=null,this._layoutTextLastFontFamily=null,this._layoutTextCtx=null,this._textDivProperties=new WeakMap,this._renderingDone=!1,this._canceled=!1,this._capability=(0,e.createPromiseCapability)(),this._renderTimer=null,this._bounds=[],this._devicePixelRatio=globalThis.devicePixelRatio||1,this._capability.promise.finally(()=>{this._enhanceTextSelection||(this._textDivProperties=null),this._layoutTextCtx&&(this._layoutTextCtx.canvas.width=0,this._layoutTextCtx.canvas.height=0,this._layoutTextCtx=null)}).catch(()=>{})}get promise(){return this._capability.promise}cancel(){this._canceled=!0,this._reader&&(this._reader.cancel(new e.AbortException("TextLayer task cancelled.")).catch(()=>{}),this._reader=null),this._renderTimer!==null&&(clearTimeout(this._renderTimer),this._renderTimer=null),this._capability.reject(new Error("TextLayer task cancelled."))}_processItems(d,i){for(let l=0,n=d.length;l<n;l++){if(d[l].str===void 0){if(d[l].type==="beginMarkedContentProps"||d[l].type==="beginMarkedContent"){const E=this._container;this._container=document.createElement("span"),this._container.classList.add("markedContent"),d[l].id!==null&&this._container.setAttribute("id",`${d[l].id}`),E.append(this._container)}else d[l].type==="endMarkedContent"&&(this._container=this._container.parentNode);continue}this._textContentItemsStr.push(d[l].str),L(this,d[l],i,this._layoutTextCtx)}}_layoutText(d){const i=this._textDivProperties.get(d);let l="";if(i.canvasWidth!==0&&i.hasText){const{fontFamily:n}=d.style,{fontSize:E}=i;(E!==this._layoutTextLastFontSize||n!==this._layoutTextLastFontFamily)&&(this._layoutTextCtx.font=`${E*this._devicePixelRatio}px ${n}`,this._layoutTextLastFontSize=E,this._layoutTextLastFontFamily=n);const{width:R}=this._layoutTextCtx.measureText(d.textContent);if(R>0){const G=this._devicePixelRatio*i.canvasWidth/R;this._enhanceTextSelection&&(i.scale=G),l=`scaleX(${G})`}}if(i.angle!==0&&(l=`rotate(${i.angle}deg) ${l}`),l.length>0&&(this._enhanceTextSelection&&(i.originalTransform=l),d.style.transform=l),i.hasText&&this._container.append(d),i.hasEOL){const n=document.createElement("br");n.setAttribute("role","presentation"),this._container.append(n)}}_render(d=0){const i=(0,e.createPromiseCapability)();let l=Object.create(null);const n=this._document.createElement("canvas");if(n.height=n.width=O,this._layoutTextCtx=n.getContext("2d",{alpha:!1}),this._textContent){const E=this._textContent.items,R=this._textContent.styles;this._processItems(E,R),i.resolve()}else if(this._textContentStream){const E=()=>{this._reader.read().then(({value:R,done:G})=>{if(G){i.resolve();return}Object.assign(l,R.styles),this._processItems(R.items,l),E()},i.reject)};this._reader=this._textContentStream.getReader(),E()}else throw new Error('Neither "textContent" nor "textContentStream" parameters specified.');i.promise.then(()=>{l=null,d?this._renderTimer=setTimeout(()=>{w(this),this._renderTimer=null},d):w(this)},this._capability.reject)}expandTextDivs(d=!1){if(!this._enhanceTextSelection||!this._renderingDone)return;this._bounds!==null&&(h(this),this._bounds=null);const i=[],l=[];for(let n=0,E=this._textDivs.length;n<E;n++){const R=this._textDivs[n],G=this._textDivProperties.get(R);G.hasText&&(d?(i.length=0,l.length=0,G.originalTransform&&i.push(G.originalTransform),G.paddingTop>0?(l.push(`${G.paddingTop}px`),i.push(`translateY(${-G.paddingTop}px)`)):l.push(0),G.paddingRight>0?l.push(`${G.paddingRight/G.scale}px`):l.push(0),G.paddingBottom>0?l.push(`${G.paddingBottom}px`):l.push(0),G.paddingLeft>0?(l.push(`${G.paddingLeft/G.scale}px`),i.push(`translateX(${-G.paddingLeft/G.scale}px)`)):l.push(0),R.style.padding=l.join(" "),i.length&&(R.style.transform=i.join(" "))):(R.style.padding=null,R.style.transform=G.originalTransform))}}}r.TextLayerRenderTask=c;function x(b){const d=new c({textContent:b.textContent,textContentStream:b.textContentStream,container:b.container,viewport:b.viewport,textDivs:b.textDivs,textContentItemsStr:b.textContentItemsStr,enhanceTextSelection:b.enhanceTextSelection});return d._render(b.timeout),d}},(A,r,y)=>{Object.defineProperty(r,"__esModule",{value:!0}),r.SVGGraphics=void 0;var e=y(8),a=y(1),k=y(3);let O=class{constructor(){(0,a.unreachable)("Not implemented: SVGGraphics")}};r.SVGGraphics=O;{let t=function(i){let l=[];const n=[];for(const E of i){if(E.fn==="save"){l.push({fnId:92,fn:"group",items:[]}),n.push(l),l=l.at(-1).items;continue}E.fn==="restore"?l=n.pop():l.push(E)}return l},o=function(i){if(Number.isInteger(i))return i.toString();const l=i.toFixed(10);let n=l.length-1;if(l[n]!=="0")return l;do n--;while(l[n]==="0");return l.substring(0,l[n]==="."?n:n+1)},c=function(i){if(i[4]===0&&i[5]===0){if(i[1]===0&&i[2]===0)return i[0]===1&&i[3]===1?"":`scale(${o(i[0])} ${o(i[3])})`;if(i[0]===i[3]&&i[1]===-i[2]){const l=Math.acos(i[0])*180/Math.PI;return`rotate(${o(l)})`}}else if(i[0]===1&&i[1]===0&&i[2]===0&&i[3]===1)return`translate(${o(i[4])} ${o(i[5])})`;return`matrix(${o(i[0])} ${o(i[1])} ${o(i[2])} ${o(i[3])} ${o(i[4])} ${o(i[5])})`};const S={fontStyle:"normal",fontWeight:"normal",fillColor:"#000000"},_="http://www.w3.org/XML/1998/namespace",f="http://www.w3.org/1999/xlink",C=["butt","round","square"],L=["miter","round","bevel"],w=function(i,l="",n=!1){if(URL.createObjectURL&&typeof Blob<"u"&&!n)return URL.createObjectURL(new Blob([i],{type:l}));const E="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=";let R=`data:${l};base64,`;for(let G=0,q=i.length;G<q;G+=3){const se=i[G]&255,ae=i[G+1]&255,Z=i[G+2]&255,Q=se>>2,z=(se&3)<<4|ae>>4,V=G+1<q?(ae&15)<<2|Z>>6:64,X=G+2<q?Z&63:64;R+=E[Q]+E[z]+E[V]+E[X]}return R},T=function(){const i=new Uint8Array([137,80,78,71,13,10,26,10]),l=12,n=new Int32Array(256);for(let Z=0;Z<256;Z++){let Q=Z;for(let z=0;z<8;z++)Q&1?Q=3988292384^Q>>1&2147483647:Q=Q>>1&2147483647;n[Z]=Q}function E(Z,Q,z){let V=-1;for(let X=Q;X<z;X++){const ne=(V^Z[X])&255,le=n[ne];V=V>>>8^le}return V^-1}function R(Z,Q,z,V){let X=V;const ne=Q.length;z[X]=ne>>24&255,z[X+1]=ne>>16&255,z[X+2]=ne>>8&255,z[X+3]=ne&255,X+=4,z[X]=Z.charCodeAt(0)&255,z[X+1]=Z.charCodeAt(1)&255,z[X+2]=Z.charCodeAt(2)&255,z[X+3]=Z.charCodeAt(3)&255,X+=4,z.set(Q,X),X+=Q.length;const le=E(z,V+4,X);z[X]=le>>24&255,z[X+1]=le>>16&255,z[X+2]=le>>8&255,z[X+3]=le&255}function G(Z,Q,z){let V=1,X=0;for(let ne=Q;ne<z;++ne)V=(V+(Z[ne]&255))%65521,X=(X+V)%65521;return X<<16|V}function q(Z){if(!k.isNodeJS)return se(Z);try{let Q;parseInt(process.versions.node)>=8?Q=Z:Q=Buffer.from(Z);const z=require$$5.deflateSync(Q,{level:9});return z instanceof Uint8Array?z:new Uint8Array(z)}catch(Q){(0,a.warn)("Not compressing PNG because zlib.deflateSync is unavailable: "+Q)}return se(Z)}function se(Z){let Q=Z.length;const z=65535,V=Math.ceil(Q/z),X=new Uint8Array(2+Q+V*5+4);let ne=0;X[ne++]=120,X[ne++]=156;let le=0;for(;Q>z;)X[ne++]=0,X[ne++]=255,X[ne++]=255,X[ne++]=0,X[ne++]=0,X.set(Z.subarray(le,le+z),ne),ne+=z,le+=z,Q-=z;X[ne++]=1,X[ne++]=Q&255,X[ne++]=Q>>8&255,X[ne++]=~Q&65535&255,X[ne++]=(~Q&65535)>>8&255,X.set(Z.subarray(le),ne),ne+=Z.length-le;const fe=G(Z,0,Z.length);return X[ne++]=fe>>24&255,X[ne++]=fe>>16&255,X[ne++]=fe>>8&255,X[ne++]=fe&255,X}function ae(Z,Q,z,V){const X=Z.width,ne=Z.height;let le,fe,$;const p=Z.data;switch(Q){case a.ImageKind.GRAYSCALE_1BPP:fe=0,le=1,$=X+7>>3;break;case a.ImageKind.RGB_24BPP:fe=2,le=8,$=X*3;break;case a.ImageKind.RGBA_32BPP:fe=6,le=8,$=X*4;break;default:throw new Error("invalid format")}const u=new Uint8Array((1+$)*ne);let D=0,U=0;for(let v=0;v<ne;++v)u[D++]=0,u.set(p.subarray(U,U+$),D),U+=$,D+=$;if(Q===a.ImageKind.GRAYSCALE_1BPP&&V){D=0;for(let v=0;v<ne;v++){D++;for(let F=0;F<$;F++)u[D++]^=255}}const B=new Uint8Array([X>>24&255,X>>16&255,X>>8&255,X&255,ne>>24&255,ne>>16&255,ne>>8&255,ne&255,le,fe,0,0,0]),W=q(u),s=i.length+l*3+B.length+W.length,g=new Uint8Array(s);let P=0;return g.set(i,P),P+=i.length,R("IHDR",B,g,P),P+=l+B.length,R("IDATA",W,g,P),P+=l+W.length,R("IEND",new Uint8Array(0),g,P),w(g,"image/png",z)}return function(Q,z,V){const X=Q.kind===void 0?a.ImageKind.GRAYSCALE_1BPP:Q.kind;return ae(Q,X,z,V)}}();class h{constructor(){this.fontSizeScale=1,this.fontWeight=S.fontWeight,this.fontSize=0,this.textMatrix=a.IDENTITY_MATRIX,this.fontMatrix=a.FONT_IDENTITY_MATRIX,this.leading=0,this.textRenderingMode=a.TextRenderingMode.FILL,this.textMatrixScale=1,this.x=0,this.y=0,this.lineX=0,this.lineY=0,this.charSpacing=0,this.wordSpacing=0,this.textHScale=1,this.textRise=0,this.fillColor=S.fillColor,this.strokeColor="#000000",this.fillAlpha=1,this.strokeAlpha=1,this.lineWidth=1,this.lineJoin="",this.lineCap="",this.miterLimit=0,this.dashArray=[],this.dashPhase=0,this.dependencies=[],this.activeClipUrl=null,this.clipGroup=null,this.maskId=""}clone(){return Object.create(this)}setCurrentPoint(l,n){this.x=l,this.y=n}}let x=0,b=0,d=0;r.SVGGraphics=O=class{constructor(i,l,n=!1){(0,e.deprecated)("The SVG back-end is no longer maintained and *may* be removed in the future."),this.svgFactory=new e.DOMSVGFactory,this.current=new h,this.transformMatrix=a.IDENTITY_MATRIX,this.transformStack=[],this.extraStack=[],this.commonObjs=i,this.objs=l,this.pendingClip=null,this.pendingEOFill=!1,this.embedFonts=!1,this.embeddedFonts=Object.create(null),this.cssStyle=null,this.forceDataSchema=!!n,this._operatorIdMapping=[];for(const E in a.OPS)this._operatorIdMapping[a.OPS[E]]=E}save(){this.transformStack.push(this.transformMatrix);const i=this.current;this.extraStack.push(i),this.current=i.clone()}restore(){this.transformMatrix=this.transformStack.pop(),this.current=this.extraStack.pop(),this.pendingClip=null,this.tgrp=null}group(i){this.save(),this.executeOpTree(i),this.restore()}loadDependencies(i){const l=i.fnArray,n=i.argsArray;for(let E=0,R=l.length;E<R;E++)if(l[E]===a.OPS.dependency)for(const G of n[E]){const q=G.startsWith("g_")?this.commonObjs:this.objs,se=new Promise(ae=>{q.get(G,ae)});this.current.dependencies.push(se)}return Promise.all(this.current.dependencies)}transform(i,l,n,E,R,G){const q=[i,l,n,E,R,G];this.transformMatrix=a.Util.transform(this.transformMatrix,q),this.tgrp=null}getSVG(i,l){this.viewport=l;const n=this._initialize(l);return this.loadDependencies(i).then(()=>(this.transformMatrix=a.IDENTITY_MATRIX,this.executeOpTree(this.convertOpList(i)),n))}convertOpList(i){const l=this._operatorIdMapping,n=i.argsArray,E=i.fnArray,R=[];for(let G=0,q=E.length;G<q;G++){const se=E[G];R.push({fnId:se,fn:l[se],args:n[G]})}return t(R)}executeOpTree(i){for(const l of i){const n=l.fn,E=l.fnId,R=l.args;switch(E|0){case a.OPS.beginText:this.beginText();break;case a.OPS.dependency:break;case a.OPS.setLeading:this.setLeading(R);break;case a.OPS.setLeadingMoveText:this.setLeadingMoveText(R[0],R[1]);break;case a.OPS.setFont:this.setFont(R);break;case a.OPS.showText:this.showText(R[0]);break;case a.OPS.showSpacedText:this.showText(R[0]);break;case a.OPS.endText:this.endText();break;case a.OPS.moveText:this.moveText(R[0],R[1]);break;case a.OPS.setCharSpacing:this.setCharSpacing(R[0]);break;case a.OPS.setWordSpacing:this.setWordSpacing(R[0]);break;case a.OPS.setHScale:this.setHScale(R[0]);break;case a.OPS.setTextMatrix:this.setTextMatrix(R[0],R[1],R[2],R[3],R[4],R[5]);break;case a.OPS.setTextRise:this.setTextRise(R[0]);break;case a.OPS.setTextRenderingMode:this.setTextRenderingMode(R[0]);break;case a.OPS.setLineWidth:this.setLineWidth(R[0]);break;case a.OPS.setLineJoin:this.setLineJoin(R[0]);break;case a.OPS.setLineCap:this.setLineCap(R[0]);break;case a.OPS.setMiterLimit:this.setMiterLimit(R[0]);break;case a.OPS.setFillRGBColor:this.setFillRGBColor(R[0],R[1],R[2]);break;case a.OPS.setStrokeRGBColor:this.setStrokeRGBColor(R[0],R[1],R[2]);break;case a.OPS.setStrokeColorN:this.setStrokeColorN(R);break;case a.OPS.setFillColorN:this.setFillColorN(R);break;case a.OPS.shadingFill:this.shadingFill(R[0]);break;case a.OPS.setDash:this.setDash(R[0],R[1]);break;case a.OPS.setRenderingIntent:this.setRenderingIntent(R[0]);break;case a.OPS.setFlatness:this.setFlatness(R[0]);break;case a.OPS.setGState:this.setGState(R[0]);break;case a.OPS.fill:this.fill();break;case a.OPS.eoFill:this.eoFill();break;case a.OPS.stroke:this.stroke();break;case a.OPS.fillStroke:this.fillStroke();break;case a.OPS.eoFillStroke:this.eoFillStroke();break;case a.OPS.clip:this.clip("nonzero");break;case a.OPS.eoClip:this.clip("evenodd");break;case a.OPS.paintSolidColorImageMask:this.paintSolidColorImageMask();break;case a.OPS.paintImageXObject:this.paintImageXObject(R[0]);break;case a.OPS.paintInlineImageXObject:this.paintInlineImageXObject(R[0]);break;case a.OPS.paintImageMaskXObject:this.paintImageMaskXObject(R[0]);break;case a.OPS.paintFormXObjectBegin:this.paintFormXObjectBegin(R[0],R[1]);break;case a.OPS.paintFormXObjectEnd:this.paintFormXObjectEnd();break;case a.OPS.closePath:this.closePath();break;case a.OPS.closeStroke:this.closeStroke();break;case a.OPS.closeFillStroke:this.closeFillStroke();break;case a.OPS.closeEOFillStroke:this.closeEOFillStroke();break;case a.OPS.nextLine:this.nextLine();break;case a.OPS.transform:this.transform(R[0],R[1],R[2],R[3],R[4],R[5]);break;case a.OPS.constructPath:this.constructPath(R[0],R[1]);break;case a.OPS.endPath:this.endPath();break;case 92:this.group(l.items);break;default:(0,a.warn)(`Unimplemented operator ${n}`);break}}}setWordSpacing(i){this.current.wordSpacing=i}setCharSpacing(i){this.current.charSpacing=i}nextLine(){this.moveText(0,this.current.leading)}setTextMatrix(i,l,n,E,R,G){const q=this.current;q.textMatrix=q.lineMatrix=[i,l,n,E,R,G],q.textMatrixScale=Math.hypot(i,l),q.x=q.lineX=0,q.y=q.lineY=0,q.xcoords=[],q.ycoords=[],q.tspan=this.svgFactory.createElement("svg:tspan"),q.tspan.setAttributeNS(null,"font-family",q.fontFamily),q.tspan.setAttributeNS(null,"font-size",`${o(q.fontSize)}px`),q.tspan.setAttributeNS(null,"y",o(-q.y)),q.txtElement=this.svgFactory.createElement("svg:text"),q.txtElement.append(q.tspan)}beginText(){const i=this.current;i.x=i.lineX=0,i.y=i.lineY=0,i.textMatrix=a.IDENTITY_MATRIX,i.lineMatrix=a.IDENTITY_MATRIX,i.textMatrixScale=1,i.tspan=this.svgFactory.createElement("svg:tspan"),i.txtElement=this.svgFactory.createElement("svg:text"),i.txtgrp=this.svgFactory.createElement("svg:g"),i.xcoords=[],i.ycoords=[]}moveText(i,l){const n=this.current;n.x=n.lineX+=i,n.y=n.lineY+=l,n.xcoords=[],n.ycoords=[],n.tspan=this.svgFactory.createElement("svg:tspan"),n.tspan.setAttributeNS(null,"font-family",n.fontFamily),n.tspan.setAttributeNS(null,"font-size",`${o(n.fontSize)}px`),n.tspan.setAttributeNS(null,"y",o(-n.y))}showText(i){const l=this.current,n=l.font,E=l.fontSize;if(E===0)return;const R=l.fontSizeScale,G=l.charSpacing,q=l.wordSpacing,se=l.fontDirection,ae=l.textHScale*se,Z=n.vertical,Q=Z?1:-1,z=n.defaultVMetrics,V=E*l.fontMatrix[0];let X=0;for(const fe of i){if(fe===null){X+=se*q;continue}else if(typeof fe=="number"){X+=Q*fe*E/1e3;continue}const $=(fe.isSpace?q:0)+G,p=fe.fontChar;let u,D,U=fe.width;if(Z){let W;const s=fe.vmetric||z;W=fe.vmetric?s[1]:U*.5,W=-W*V;const g=s[2]*V;U=s?-s[0]:U,u=W/R,D=(X+g)/R}else u=X/R,D=0;(fe.isInFont||n.missingFile)&&(l.xcoords.push(l.x+u),Z&&l.ycoords.push(-l.y+D),l.tspan.textContent+=p);let B;Z?B=U*V-$*se:B=U*V+$*se,X+=B}l.tspan.setAttributeNS(null,"x",l.xcoords.map(o).join(" ")),Z?l.tspan.setAttributeNS(null,"y",l.ycoords.map(o).join(" ")):l.tspan.setAttributeNS(null,"y",o(-l.y)),Z?l.y-=X:l.x+=X*ae,l.tspan.setAttributeNS(null,"font-family",l.fontFamily),l.tspan.setAttributeNS(null,"font-size",`${o(l.fontSize)}px`),l.fontStyle!==S.fontStyle&&l.tspan.setAttributeNS(null,"font-style",l.fontStyle),l.fontWeight!==S.fontWeight&&l.tspan.setAttributeNS(null,"font-weight",l.fontWeight);const ne=l.textRenderingMode&a.TextRenderingMode.FILL_STROKE_MASK;if(ne===a.TextRenderingMode.FILL||ne===a.TextRenderingMode.FILL_STROKE?(l.fillColor!==S.fillColor&&l.tspan.setAttributeNS(null,"fill",l.fillColor),l.fillAlpha<1&&l.tspan.setAttributeNS(null,"fill-opacity",l.fillAlpha)):l.textRenderingMode===a.TextRenderingMode.ADD_TO_PATH?l.tspan.setAttributeNS(null,"fill","transparent"):l.tspan.setAttributeNS(null,"fill","none"),ne===a.TextRenderingMode.STROKE||ne===a.TextRenderingMode.FILL_STROKE){const fe=1/(l.textMatrixScale||1);this._setStrokeAttributes(l.tspan,fe)}let le=l.textMatrix;l.textRise!==0&&(le=le.slice(),le[5]+=l.textRise),l.txtElement.setAttributeNS(null,"transform",`${c(le)} scale(${o(ae)}, -1)`),l.txtElement.setAttributeNS(_,"xml:space","preserve"),l.txtElement.append(l.tspan),l.txtgrp.append(l.txtElement),this._ensureTransformGroup().append(l.txtElement)}setLeadingMoveText(i,l){this.setLeading(-l),this.moveText(i,l)}addFontStyle(i){if(!i.data)throw new Error('addFontStyle: No font data available, ensure that the "fontExtraProperties" API parameter is set.');this.cssStyle||(this.cssStyle=this.svgFactory.createElement("svg:style"),this.cssStyle.setAttributeNS(null,"type","text/css"),this.defs.append(this.cssStyle));const l=w(i.data,i.mimetype,this.forceDataSchema);this.cssStyle.textContent+=`@font-face { font-family: "${i.loadedName}"; src: url(${l}); }
`}setFont(i){const l=this.current,n=this.commonObjs.get(i[0]);let E=i[1];l.font=n,this.embedFonts&&!n.missingFile&&!this.embeddedFonts[n.loadedName]&&(this.addFontStyle(n),this.embeddedFonts[n.loadedName]=n),l.fontMatrix=n.fontMatrix||a.FONT_IDENTITY_MATRIX;let R="normal";n.black?R="900":n.bold&&(R="bold");const G=n.italic?"italic":"normal";E<0?(E=-E,l.fontDirection=-1):l.fontDirection=1,l.fontSize=E,l.fontFamily=n.loadedName,l.fontWeight=R,l.fontStyle=G,l.tspan=this.svgFactory.createElement("svg:tspan"),l.tspan.setAttributeNS(null,"y",o(-l.y)),l.xcoords=[],l.ycoords=[]}endText(){var l;const i=this.current;i.textRenderingMode&a.TextRenderingMode.ADD_TO_PATH_FLAG&&((l=i.txtElement)!=null&&l.hasChildNodes())&&(i.element=i.txtElement,this.clip("nonzero"),this.endPath())}setLineWidth(i){i>0&&(this.current.lineWidth=i)}setLineCap(i){this.current.lineCap=C[i]}setLineJoin(i){this.current.lineJoin=L[i]}setMiterLimit(i){this.current.miterLimit=i}setStrokeAlpha(i){this.current.strokeAlpha=i}setStrokeRGBColor(i,l,n){this.current.strokeColor=a.Util.makeHexColor(i,l,n)}setFillAlpha(i){this.current.fillAlpha=i}setFillRGBColor(i,l,n){this.current.fillColor=a.Util.makeHexColor(i,l,n),this.current.tspan=this.svgFactory.createElement("svg:tspan"),this.current.xcoords=[],this.current.ycoords=[]}setStrokeColorN(i){this.current.strokeColor=this._makeColorN_Pattern(i)}setFillColorN(i){this.current.fillColor=this._makeColorN_Pattern(i)}shadingFill(i){const l=this.viewport.width,n=this.viewport.height,E=a.Util.inverseTransform(this.transformMatrix),R=a.Util.applyTransform([0,0],E),G=a.Util.applyTransform([0,n],E),q=a.Util.applyTransform([l,0],E),se=a.Util.applyTransform([l,n],E),ae=Math.min(R[0],G[0],q[0],se[0]),Z=Math.min(R[1],G[1],q[1],se[1]),Q=Math.max(R[0],G[0],q[0],se[0]),z=Math.max(R[1],G[1],q[1],se[1]),V=this.svgFactory.createElement("svg:rect");V.setAttributeNS(null,"x",ae),V.setAttributeNS(null,"y",Z),V.setAttributeNS(null,"width",Q-ae),V.setAttributeNS(null,"height",z-Z),V.setAttributeNS(null,"fill",this._makeShadingPattern(i)),this.current.fillAlpha<1&&V.setAttributeNS(null,"fill-opacity",this.current.fillAlpha),this._ensureTransformGroup().append(V)}_makeColorN_Pattern(i){return i[0]==="TilingPattern"?this._makeTilingPattern(i):this._makeShadingPattern(i)}_makeTilingPattern(i){const l=i[1],n=i[2],E=i[3]||a.IDENTITY_MATRIX,[R,G,q,se]=i[4],ae=i[5],Z=i[6],Q=i[7],z=`shading${d++}`,[V,X,ne,le]=a.Util.normalizeRect([...a.Util.applyTransform([R,G],E),...a.Util.applyTransform([q,se],E)]),[fe,$]=a.Util.singularValueDecompose2dScale(E),p=ae*fe,u=Z*$,D=this.svgFactory.createElement("svg:pattern");D.setAttributeNS(null,"id",z),D.setAttributeNS(null,"patternUnits","userSpaceOnUse"),D.setAttributeNS(null,"width",p),D.setAttributeNS(null,"height",u),D.setAttributeNS(null,"x",`${V}`),D.setAttributeNS(null,"y",`${X}`);const U=this.svg,B=this.transformMatrix,W=this.current.fillColor,s=this.current.strokeColor,g=this.svgFactory.create(ne-V,le-X);if(this.svg=g,this.transformMatrix=E,Q===2){const P=a.Util.makeHexColor(...l);this.current.fillColor=P,this.current.strokeColor=P}return this.executeOpTree(this.convertOpList(n)),this.svg=U,this.transformMatrix=B,this.current.fillColor=W,this.current.strokeColor=s,D.append(g.childNodes[0]),this.defs.append(D),`url(#${z})`}_makeShadingPattern(i){switch(typeof i=="string"&&(i=this.objs.get(i)),i[0]){case"RadialAxial":const l=`shading${d++}`,n=i[3];let E;switch(i[1]){case"axial":const R=i[4],G=i[5];E=this.svgFactory.createElement("svg:linearGradient"),E.setAttributeNS(null,"id",l),E.setAttributeNS(null,"gradientUnits","userSpaceOnUse"),E.setAttributeNS(null,"x1",R[0]),E.setAttributeNS(null,"y1",R[1]),E.setAttributeNS(null,"x2",G[0]),E.setAttributeNS(null,"y2",G[1]);break;case"radial":const q=i[4],se=i[5],ae=i[6],Z=i[7];E=this.svgFactory.createElement("svg:radialGradient"),E.setAttributeNS(null,"id",l),E.setAttributeNS(null,"gradientUnits","userSpaceOnUse"),E.setAttributeNS(null,"cx",se[0]),E.setAttributeNS(null,"cy",se[1]),E.setAttributeNS(null,"r",Z),E.setAttributeNS(null,"fx",q[0]),E.setAttributeNS(null,"fy",q[1]),E.setAttributeNS(null,"fr",ae);break;default:throw new Error(`Unknown RadialAxial type: ${i[1]}`)}for(const R of n){const G=this.svgFactory.createElement("svg:stop");G.setAttributeNS(null,"offset",R[0]),G.setAttributeNS(null,"stop-color",R[1]),E.append(G)}return this.defs.append(E),`url(#${l})`;case"Mesh":return(0,a.warn)("Unimplemented pattern Mesh"),null;case"Dummy":return"hotpink";default:throw new Error(`Unknown IR type: ${i[0]}`)}}setDash(i,l){this.current.dashArray=i,this.current.dashPhase=l}constructPath(i,l){const n=this.current;let E=n.x,R=n.y,G=[],q=0;for(const se of i)switch(se|0){case a.OPS.rectangle:E=l[q++],R=l[q++];const ae=l[q++],Z=l[q++],Q=E+ae,z=R+Z;G.push("M",o(E),o(R),"L",o(Q),o(R),"L",o(Q),o(z),"L",o(E),o(z),"Z");break;case a.OPS.moveTo:E=l[q++],R=l[q++],G.push("M",o(E),o(R));break;case a.OPS.lineTo:E=l[q++],R=l[q++],G.push("L",o(E),o(R));break;case a.OPS.curveTo:E=l[q+4],R=l[q+5],G.push("C",o(l[q]),o(l[q+1]),o(l[q+2]),o(l[q+3]),o(E),o(R)),q+=6;break;case a.OPS.curveTo2:G.push("C",o(E),o(R),o(l[q]),o(l[q+1]),o(l[q+2]),o(l[q+3])),E=l[q+2],R=l[q+3],q+=4;break;case a.OPS.curveTo3:E=l[q+2],R=l[q+3],G.push("C",o(l[q]),o(l[q+1]),o(E),o(R),o(E),o(R)),q+=4;break;case a.OPS.closePath:G.push("Z");break}G=G.join(" "),n.path&&i.length>0&&i[0]!==a.OPS.rectangle&&i[0]!==a.OPS.moveTo?G=n.path.getAttributeNS(null,"d")+G:(n.path=this.svgFactory.createElement("svg:path"),this._ensureTransformGroup().append(n.path)),n.path.setAttributeNS(null,"d",G),n.path.setAttributeNS(null,"fill","none"),n.element=n.path,n.setCurrentPoint(E,R)}endPath(){const i=this.current;if(i.path=null,!this.pendingClip)return;if(!i.element){this.pendingClip=null;return}const l=`clippath${x++}`,n=this.svgFactory.createElement("svg:clipPath");n.setAttributeNS(null,"id",l),n.setAttributeNS(null,"transform",c(this.transformMatrix));const E=i.element.cloneNode(!0);if(this.pendingClip==="evenodd"?E.setAttributeNS(null,"clip-rule","evenodd"):E.setAttributeNS(null,"clip-rule","nonzero"),this.pendingClip=null,n.append(E),this.defs.append(n),i.activeClipUrl){i.clipGroup=null;for(const R of this.extraStack)R.clipGroup=null;n.setAttributeNS(null,"clip-path",i.activeClipUrl)}i.activeClipUrl=`url(#${l})`,this.tgrp=null}clip(i){this.pendingClip=i}closePath(){const i=this.current;if(i.path){const l=`${i.path.getAttributeNS(null,"d")}Z`;i.path.setAttributeNS(null,"d",l)}}setLeading(i){this.current.leading=-i}setTextRise(i){this.current.textRise=i}setTextRenderingMode(i){this.current.textRenderingMode=i}setHScale(i){this.current.textHScale=i/100}setRenderingIntent(i){}setFlatness(i){}setGState(i){for(const[l,n]of i)switch(l){case"LW":this.setLineWidth(n);break;case"LC":this.setLineCap(n);break;case"LJ":this.setLineJoin(n);break;case"ML":this.setMiterLimit(n);break;case"D":this.setDash(n[0],n[1]);break;case"RI":this.setRenderingIntent(n);break;case"FL":this.setFlatness(n);break;case"Font":this.setFont(n);break;case"CA":this.setStrokeAlpha(n);break;case"ca":this.setFillAlpha(n);break;default:(0,a.warn)(`Unimplemented graphic state operator ${l}`);break}}fill(){const i=this.current;i.element&&(i.element.setAttributeNS(null,"fill",i.fillColor),i.element.setAttributeNS(null,"fill-opacity",i.fillAlpha),this.endPath())}stroke(){const i=this.current;i.element&&(this._setStrokeAttributes(i.element),i.element.setAttributeNS(null,"fill","none"),this.endPath())}_setStrokeAttributes(i,l=1){const n=this.current;let E=n.dashArray;l!==1&&E.length>0&&(E=E.map(function(R){return l*R})),i.setAttributeNS(null,"stroke",n.strokeColor),i.setAttributeNS(null,"stroke-opacity",n.strokeAlpha),i.setAttributeNS(null,"stroke-miterlimit",o(n.miterLimit)),i.setAttributeNS(null,"stroke-linecap",n.lineCap),i.setAttributeNS(null,"stroke-linejoin",n.lineJoin),i.setAttributeNS(null,"stroke-width",o(l*n.lineWidth)+"px"),i.setAttributeNS(null,"stroke-dasharray",E.map(o).join(" ")),i.setAttributeNS(null,"stroke-dashoffset",o(l*n.dashPhase)+"px")}eoFill(){this.current.element&&this.current.element.setAttributeNS(null,"fill-rule","evenodd"),this.fill()}fillStroke(){this.stroke(),this.fill()}eoFillStroke(){this.current.element&&this.current.element.setAttributeNS(null,"fill-rule","evenodd"),this.fillStroke()}closeStroke(){this.closePath(),this.stroke()}closeFillStroke(){this.closePath(),this.fillStroke()}closeEOFillStroke(){this.closePath(),this.eoFillStroke()}paintSolidColorImageMask(){const i=this.svgFactory.createElement("svg:rect");i.setAttributeNS(null,"x","0"),i.setAttributeNS(null,"y","0"),i.setAttributeNS(null,"width","1px"),i.setAttributeNS(null,"height","1px"),i.setAttributeNS(null,"fill",this.current.fillColor),this._ensureTransformGroup().append(i)}paintImageXObject(i){const l=i.startsWith("g_")?this.commonObjs.get(i):this.objs.get(i);if(!l){(0,a.warn)(`Dependent image with object ID ${i} is not ready yet`);return}this.paintInlineImageXObject(l)}paintInlineImageXObject(i,l){const n=i.width,E=i.height,R=T(i,this.forceDataSchema,!!l),G=this.svgFactory.createElement("svg:rect");G.setAttributeNS(null,"x","0"),G.setAttributeNS(null,"y","0"),G.setAttributeNS(null,"width",o(n)),G.setAttributeNS(null,"height",o(E)),this.current.element=G,this.clip("nonzero");const q=this.svgFactory.createElement("svg:image");q.setAttributeNS(f,"xlink:href",R),q.setAttributeNS(null,"x","0"),q.setAttributeNS(null,"y",o(-E)),q.setAttributeNS(null,"width",o(n)+"px"),q.setAttributeNS(null,"height",o(E)+"px"),q.setAttributeNS(null,"transform",`scale(${o(1/n)} ${o(-1/E)})`),l?l.append(q):this._ensureTransformGroup().append(q)}paintImageMaskXObject(i){const l=this.current,n=i.width,E=i.height,R=l.fillColor;l.maskId=`mask${b++}`;const G=this.svgFactory.createElement("svg:mask");G.setAttributeNS(null,"id",l.maskId);const q=this.svgFactory.createElement("svg:rect");q.setAttributeNS(null,"x","0"),q.setAttributeNS(null,"y","0"),q.setAttributeNS(null,"width",o(n)),q.setAttributeNS(null,"height",o(E)),q.setAttributeNS(null,"fill",R),q.setAttributeNS(null,"mask",`url(#${l.maskId})`),this.defs.append(G),this._ensureTransformGroup().append(q),this.paintInlineImageXObject(i,G)}paintFormXObjectBegin(i,l){if(Array.isArray(i)&&i.length===6&&this.transform(i[0],i[1],i[2],i[3],i[4],i[5]),l){const n=l[2]-l[0],E=l[3]-l[1],R=this.svgFactory.createElement("svg:rect");R.setAttributeNS(null,"x",l[0]),R.setAttributeNS(null,"y",l[1]),R.setAttributeNS(null,"width",o(n)),R.setAttributeNS(null,"height",o(E)),this.current.element=R,this.clip("nonzero"),this.endPath()}}paintFormXObjectEnd(){}_initialize(i){const l=this.svgFactory.create(i.width,i.height),n=this.svgFactory.createElement("svg:defs");l.append(n),this.defs=n;const E=this.svgFactory.createElement("svg:g");return E.setAttributeNS(null,"transform",c(i.transform)),l.append(E),this.svg=E,l}_ensureClipGroup(){if(!this.current.clipGroup){const i=this.svgFactory.createElement("svg:g");i.setAttributeNS(null,"clip-path",this.current.activeClipUrl),this.svg.append(i),this.current.clipGroup=i}return this.current.clipGroup}_ensureTransformGroup(){return this.tgrp||(this.tgrp=this.svgFactory.createElement("svg:g"),this.tgrp.setAttributeNS(null,"transform",c(this.transformMatrix)),this.current.activeClipUrl?this._ensureClipGroup().append(this.tgrp):this.svg.append(this.tgrp)),this.tgrp}}}},(A,r,y)=>{Object.defineProperty(r,"__esModule",{value:!0}),r.PDFNodeStream=void 0;var e=y(1),a=y(33);const k=require$$5,O=require$$5,S=require$$5,_=require$$5,f=/^file:\/\/\/[a-zA-Z]:\//;function C(b){const d=_.parse(b);return d.protocol==="file:"||d.host?d:/^[a-z]:[/\\]/i.test(b)?_.parse(`file:///${b}`):(d.host||(d.protocol="file:"),d)}class L{constructor(d){this.source=d,this.url=C(d.url),this.isHttp=this.url.protocol==="http:"||this.url.protocol==="https:",this.isFsUrl=this.url.protocol==="file:",this.httpHeaders=this.isHttp&&d.httpHeaders||{},this._fullRequestReader=null,this._rangeRequestReaders=[]}get _progressiveDataLength(){var d;return((d=this._fullRequestReader)==null?void 0:d._loaded)??0}getFullReader(){return(0,e.assert)(!this._fullRequestReader,"PDFNodeStream.getFullReader can only be called once."),this._fullRequestReader=this.isFsUrl?new c(this):new t(this),this._fullRequestReader}getRangeReader(d,i){if(i<=this._progressiveDataLength)return null;const l=this.isFsUrl?new x(this,d,i):new o(this,d,i);return this._rangeRequestReaders.push(l),l}cancelAllRequests(d){this._fullRequestReader&&this._fullRequestReader.cancel(d);for(const i of this._rangeRequestReaders.slice(0))i.cancel(d)}}r.PDFNodeStream=L;class w{constructor(d){this._url=d.url,this._done=!1,this._storedError=null,this.onProgress=null;const i=d.source;this._contentLength=i.length,this._loaded=0,this._filename=null,this._disableRange=i.disableRange||!1,this._rangeChunkSize=i.rangeChunkSize,!this._rangeChunkSize&&!this._disableRange&&(this._disableRange=!0),this._isStreamingSupported=!i.disableStream,this._isRangeSupported=!i.disableRange,this._readableStream=null,this._readCapability=(0,e.createPromiseCapability)(),this._headersCapability=(0,e.createPromiseCapability)()}get headersReady(){return this._headersCapability.promise}get filename(){return this._filename}get contentLength(){return this._contentLength}get isRangeSupported(){return this._isRangeSupported}get isStreamingSupported(){return this._isStreamingSupported}async read(){if(await this._readCapability.promise,this._done)return{value:void 0,done:!0};if(this._storedError)throw this._storedError;const d=this._readableStream.read();return d===null?(this._readCapability=(0,e.createPromiseCapability)(),this.read()):(this._loaded+=d.length,this.onProgress&&this.onProgress({loaded:this._loaded,total:this._contentLength}),{value:new Uint8Array(d).buffer,done:!1})}cancel(d){if(!this._readableStream){this._error(d);return}this._readableStream.destroy(d)}_error(d){this._storedError=d,this._readCapability.resolve()}_setReadableStream(d){this._readableStream=d,d.on("readable",()=>{this._readCapability.resolve()}),d.on("end",()=>{d.destroy(),this._done=!0,this._readCapability.resolve()}),d.on("error",i=>{this._error(i)}),!this._isStreamingSupported&&this._isRangeSupported&&this._error(new e.AbortException("streaming is disabled")),this._storedError&&this._readableStream.destroy(this._storedError)}}class T{constructor(d){this._url=d.url,this._done=!1,this._storedError=null,this.onProgress=null,this._loaded=0,this._readableStream=null,this._readCapability=(0,e.createPromiseCapability)();const i=d.source;this._isStreamingSupported=!i.disableStream}get isStreamingSupported(){return this._isStreamingSupported}async read(){if(await this._readCapability.promise,this._done)return{value:void 0,done:!0};if(this._storedError)throw this._storedError;const d=this._readableStream.read();return d===null?(this._readCapability=(0,e.createPromiseCapability)(),this.read()):(this._loaded+=d.length,this.onProgress&&this.onProgress({loaded:this._loaded}),{value:new Uint8Array(d).buffer,done:!1})}cancel(d){if(!this._readableStream){this._error(d);return}this._readableStream.destroy(d)}_error(d){this._storedError=d,this._readCapability.resolve()}_setReadableStream(d){this._readableStream=d,d.on("readable",()=>{this._readCapability.resolve()}),d.on("end",()=>{d.destroy(),this._done=!0,this._readCapability.resolve()}),d.on("error",i=>{this._error(i)}),this._storedError&&this._readableStream.destroy(this._storedError)}}function h(b,d){return{protocol:b.protocol,auth:b.auth,host:b.hostname,port:b.port,path:b.path,method:"GET",headers:d}}class t extends w{constructor(d){super(d);const i=l=>{if(l.statusCode===404){const G=new e.MissingPDFException(`Missing PDF "${this._url}".`);this._storedError=G,this._headersCapability.reject(G);return}this._headersCapability.resolve(),this._setReadableStream(l);const n=G=>this._readableStream.headers[G.toLowerCase()],{allowRangeRequests:E,suggestedLength:R}=(0,a.validateRangeRequestCapabilities)({getResponseHeader:n,isHttp:d.isHttp,rangeChunkSize:this._rangeChunkSize,disableRange:this._disableRange});this._isRangeSupported=E,this._contentLength=R||this._contentLength,this._filename=(0,a.extractFilenameFromHeader)(n)};this._request=null,this._url.protocol==="http:"?this._request=O.request(h(this._url,d.httpHeaders),i):this._request=S.request(h(this._url,d.httpHeaders),i),this._request.on("error",l=>{this._storedError=l,this._headersCapability.reject(l)}),this._request.end()}}class o extends T{constructor(d,i,l){super(d),this._httpHeaders={};for(const E in d.httpHeaders){const R=d.httpHeaders[E];typeof R>"u"||(this._httpHeaders[E]=R)}this._httpHeaders.Range=`bytes=${i}-${l-1}`;const n=E=>{if(E.statusCode===404){const R=new e.MissingPDFException(`Missing PDF "${this._url}".`);this._storedError=R;return}this._setReadableStream(E)};this._request=null,this._url.protocol==="http:"?this._request=O.request(h(this._url,this._httpHeaders),n):this._request=S.request(h(this._url,this._httpHeaders),n),this._request.on("error",E=>{this._storedError=E}),this._request.end()}}class c extends w{constructor(d){super(d);let i=decodeURIComponent(this._url.path);f.test(this._url.href)&&(i=i.replace(/^\//,"")),k.lstat(i,(l,n)=>{if(l){l.code==="ENOENT"&&(l=new e.MissingPDFException(`Missing PDF "${i}".`)),this._storedError=l,this._headersCapability.reject(l);return}this._contentLength=n.size,this._setReadableStream(k.createReadStream(i)),this._headersCapability.resolve()})}}class x extends T{constructor(d,i,l){super(d);let n=decodeURIComponent(this._url.path);f.test(this._url.href)&&(n=n.replace(/^\//,"")),this._setReadableStream(k.createReadStream(n,{start:i,end:l-1}))}}},(A,r,y)=>{Object.defineProperty(r,"__esModule",{value:!0}),r.createResponseStatusError=_,r.extractFilenameFromHeader=S,r.validateRangeRequestCapabilities=O,r.validateResponseStatus=f;var e=y(1),a=y(34),k=y(8);function O({getResponseHeader:C,isHttp:L,rangeChunkSize:w,disableRange:T}){const h={allowRangeRequests:!1,suggestedLength:void 0},t=parseInt(C("Content-Length"),10);return!Number.isInteger(t)||(h.suggestedLength=t,t<=2*w)||T||!L||C("Accept-Ranges")!=="bytes"||(C("Content-Encoding")||"identity")!=="identity"||(h.allowRangeRequests=!0),h}function S(C){const L=C("Content-Disposition");if(L){let w=(0,a.getFilenameFromContentDispositionHeader)(L);if(w.includes("%"))try{w=decodeURIComponent(w)}catch{}if((0,k.isPdfFile)(w))return w}return null}function _(C,L){return C===404||C===0&&L.startsWith("file:")?new e.MissingPDFException('Missing PDF "'+L+'".'):new e.UnexpectedResponseException(`Unexpected server response (${C}) while retrieving PDF "${L}".`,C)}function f(C){return C===200||C===206}},(A,r,y)=>{Object.defineProperty(r,"__esModule",{value:!0}),r.getFilenameFromContentDispositionHeader=a;var e=y(1);function a(k){let O=!0,S=_("filename\\*","i").exec(k);if(S){S=S[1];let t=w(S);return t=unescape(t),t=T(t),t=h(t),C(t)}if(S=L(k),S){const t=h(S);return C(t)}if(S=_("filename","i").exec(k),S){S=S[1];let t=w(S);return t=h(t),C(t)}function _(t,o){return new RegExp("(?:^|;)\\s*"+t+'\\s*=\\s*([^";\\s][^;\\s]*|"(?:[^"\\\\]|\\\\"?)+"?)',o)}function f(t,o){if(t){if(!/^[\x00-\xFF]+$/.test(o))return o;try{const c=new TextDecoder(t,{fatal:!0}),x=(0,e.stringToBytes)(o);o=c.decode(x),O=!1}catch{}}return o}function C(t){return O&&/[\x80-\xff]/.test(t)&&(t=f("utf-8",t),O&&(t=f("iso-8859-1",t))),t}function L(t){const o=[];let c;const x=_("filename\\*((?!0\\d)\\d+)(\\*?)","ig");for(;(c=x.exec(t))!==null;){let[,d,i,l]=c;if(d=parseInt(d,10),d in o){if(d===0)break;continue}o[d]=[i,l]}const b=[];for(let d=0;d<o.length&&d in o;++d){let[i,l]=o[d];l=w(l),i&&(l=unescape(l),d===0&&(l=T(l))),b.push(l)}return b.join("")}function w(t){if(t.startsWith('"')){const o=t.slice(1).split('\\"');for(let c=0;c<o.length;++c){const x=o[c].indexOf('"');x!==-1&&(o[c]=o[c].slice(0,x),o.length=c+1),o[c]=o[c].replace(/\\(.)/g,"$1")}t=o.join('"')}return t}function T(t){const o=t.indexOf("'");if(o===-1)return t;const c=t.slice(0,o),b=t.slice(o+1).replace(/^[^']*'/,"");return f(c,b)}function h(t){return!t.startsWith("=?")||/[\x00-\x19\x80-\xff]/.test(t)?t:t.replace(/=\?([\w-]*)\?([QqBb])\?((?:[^?]|\?(?!=))*)\?=/g,function(o,c,x,b){if(x==="q"||x==="Q")return b=b.replace(/_/g," "),b=b.replace(/=([0-9a-fA-F]{2})/g,function(d,i){return String.fromCharCode(parseInt(i,16))}),f(c,b);try{b=atob(b)}catch{}return f(c,b)})}return""}},(A,r,y)=>{Object.defineProperty(r,"__esModule",{value:!0}),r.PDFNetworkStream=void 0;var e=y(1),a=y(33);const k=200,O=206;function S(w){const T=w.response;return typeof T!="string"?T:(0,e.stringToBytes)(T).buffer}class _{constructor(T,h={}){this.url=T,this.isHttp=/^https?:/i.test(T),this.httpHeaders=this.isHttp&&h.httpHeaders||Object.create(null),this.withCredentials=h.withCredentials||!1,this.getXhr=h.getXhr||function(){return new XMLHttpRequest},this.currXhrId=0,this.pendingRequests=Object.create(null)}requestRange(T,h,t){const o={begin:T,end:h};for(const c in t)o[c]=t[c];return this.request(o)}requestFull(T){return this.request(T)}request(T){const h=this.getXhr(),t=this.currXhrId++,o=this.pendingRequests[t]={xhr:h};h.open("GET",this.url),h.withCredentials=this.withCredentials;for(const c in this.httpHeaders){const x=this.httpHeaders[c];typeof x>"u"||h.setRequestHeader(c,x)}return this.isHttp&&"begin"in T&&"end"in T?(h.setRequestHeader("Range",`bytes=${T.begin}-${T.end-1}`),o.expectedStatus=O):o.expectedStatus=k,h.responseType="arraybuffer",T.onError&&(h.onerror=function(c){T.onError(h.status)}),h.onreadystatechange=this.onStateChange.bind(this,t),h.onprogress=this.onProgress.bind(this,t),o.onHeadersReceived=T.onHeadersReceived,o.onDone=T.onDone,o.onError=T.onError,o.onProgress=T.onProgress,h.send(null),t}onProgress(T,h){var o;const t=this.pendingRequests[T];t&&((o=t.onProgress)==null||o.call(t,h))}onStateChange(T,h){var d,i,l;const t=this.pendingRequests[T];if(!t)return;const o=t.xhr;if(o.readyState>=2&&t.onHeadersReceived&&(t.onHeadersReceived(),delete t.onHeadersReceived),o.readyState!==4||!(T in this.pendingRequests))return;if(delete this.pendingRequests[T],o.status===0&&this.isHttp){(d=t.onError)==null||d.call(t,o.status);return}const c=o.status||k;if(!(c===k&&t.expectedStatus===O)&&c!==t.expectedStatus){(i=t.onError)==null||i.call(t,o.status);return}const b=S(o);if(c===O){const n=o.getResponseHeader("Content-Range"),E=/bytes (\d+)-(\d+)\/(\d+)/.exec(n);t.onDone({begin:parseInt(E[1],10),chunk:b})}else b?t.onDone({begin:0,chunk:b}):(l=t.onError)==null||l.call(t,o.status)}getRequestXhr(T){return this.pendingRequests[T].xhr}isPendingRequest(T){return T in this.pendingRequests}abortRequest(T){const h=this.pendingRequests[T].xhr;delete this.pendingRequests[T],h.abort()}}class f{constructor(T){this._source=T,this._manager=new _(T.url,{httpHeaders:T.httpHeaders,withCredentials:T.withCredentials}),this._rangeChunkSize=T.rangeChunkSize,this._fullRequestReader=null,this._rangeRequestReaders=[]}_onRangeRequestReaderClosed(T){const h=this._rangeRequestReaders.indexOf(T);h>=0&&this._rangeRequestReaders.splice(h,1)}getFullReader(){return(0,e.assert)(!this._fullRequestReader,"PDFNetworkStream.getFullReader can only be called once."),this._fullRequestReader=new C(this._manager,this._source),this._fullRequestReader}getRangeReader(T,h){const t=new L(this._manager,T,h);return t.onClosed=this._onRangeRequestReaderClosed.bind(this),this._rangeRequestReaders.push(t),t}cancelAllRequests(T){var h;(h=this._fullRequestReader)==null||h.cancel(T);for(const t of this._rangeRequestReaders.slice(0))t.cancel(T)}}r.PDFNetworkStream=f;class C{constructor(T,h){this._manager=T;const t={onHeadersReceived:this._onHeadersReceived.bind(this),onDone:this._onDone.bind(this),onError:this._onError.bind(this),onProgress:this._onProgress.bind(this)};this._url=h.url,this._fullRequestId=T.requestFull(t),this._headersReceivedCapability=(0,e.createPromiseCapability)(),this._disableRange=h.disableRange||!1,this._contentLength=h.length,this._rangeChunkSize=h.rangeChunkSize,!this._rangeChunkSize&&!this._disableRange&&(this._disableRange=!0),this._isStreamingSupported=!1,this._isRangeSupported=!1,this._cachedChunks=[],this._requests=[],this._done=!1,this._storedError=void 0,this._filename=null,this.onProgress=null}_onHeadersReceived(){const T=this._fullRequestId,h=this._manager.getRequestXhr(T),t=x=>h.getResponseHeader(x),{allowRangeRequests:o,suggestedLength:c}=(0,a.validateRangeRequestCapabilities)({getResponseHeader:t,isHttp:this._manager.isHttp,rangeChunkSize:this._rangeChunkSize,disableRange:this._disableRange});o&&(this._isRangeSupported=!0),this._contentLength=c||this._contentLength,this._filename=(0,a.extractFilenameFromHeader)(t),this._isRangeSupported&&this._manager.abortRequest(T),this._headersReceivedCapability.resolve()}_onDone(T){if(T&&(this._requests.length>0?this._requests.shift().resolve({value:T.chunk,done:!1}):this._cachedChunks.push(T.chunk)),this._done=!0,!(this._cachedChunks.length>0)){for(const h of this._requests)h.resolve({value:void 0,done:!0});this._requests.length=0}}_onError(T){this._storedError=(0,a.createResponseStatusError)(T,this._url),this._headersReceivedCapability.reject(this._storedError);for(const h of this._requests)h.reject(this._storedError);this._requests.length=0,this._cachedChunks.length=0}_onProgress(T){var h;(h=this.onProgress)==null||h.call(this,{loaded:T.loaded,total:T.lengthComputable?T.total:this._contentLength})}get filename(){return this._filename}get isRangeSupported(){return this._isRangeSupported}get isStreamingSupported(){return this._isStreamingSupported}get contentLength(){return this._contentLength}get headersReady(){return this._headersReceivedCapability.promise}async read(){if(this._storedError)throw this._storedError;if(this._cachedChunks.length>0)return{value:this._cachedChunks.shift(),done:!1};if(this._done)return{value:void 0,done:!0};const T=(0,e.createPromiseCapability)();return this._requests.push(T),T.promise}cancel(T){this._done=!0,this._headersReceivedCapability.reject(T);for(const h of this._requests)h.resolve({value:void 0,done:!0});this._requests.length=0,this._manager.isPendingRequest(this._fullRequestId)&&this._manager.abortRequest(this._fullRequestId),this._fullRequestReader=null}}class L{constructor(T,h,t){this._manager=T;const o={onDone:this._onDone.bind(this),onError:this._onError.bind(this),onProgress:this._onProgress.bind(this)};this._url=T.url,this._requestId=T.requestRange(h,t,o),this._requests=[],this._queuedChunk=null,this._done=!1,this._storedError=void 0,this.onProgress=null,this.onClosed=null}_close(){var T;(T=this.onClosed)==null||T.call(this,this)}_onDone(T){const h=T.chunk;this._requests.length>0?this._requests.shift().resolve({value:h,done:!1}):this._queuedChunk=h,this._done=!0;for(const t of this._requests)t.resolve({value:void 0,done:!0});this._requests.length=0,this._close()}_onError(T){this._storedError=(0,a.createResponseStatusError)(T,this._url);for(const h of this._requests)h.reject(this._storedError);this._requests.length=0,this._queuedChunk=null}_onProgress(T){var h;this.isStreamingSupported||(h=this.onProgress)==null||h.call(this,{loaded:T.loaded})}get isStreamingSupported(){return!1}async read(){if(this._storedError)throw this._storedError;if(this._queuedChunk!==null){const h=this._queuedChunk;return this._queuedChunk=null,{value:h,done:!1}}if(this._done)return{value:void 0,done:!0};const T=(0,e.createPromiseCapability)();return this._requests.push(T),T.promise}cancel(T){this._done=!0;for(const h of this._requests)h.resolve({value:void 0,done:!0});this._requests.length=0,this._manager.isPendingRequest(this._requestId)&&this._manager.abortRequest(this._requestId),this._close()}}},(A,r,y)=>{Object.defineProperty(r,"__esModule",{value:!0}),r.PDFFetchStream=void 0;var e=y(1),a=y(33);function k(C,L,w){return{method:"GET",headers:C,signal:w.signal,mode:"cors",credentials:L?"include":"same-origin",redirect:"follow"}}function O(C){const L=new Headers;for(const w in C){const T=C[w];typeof T>"u"||L.append(w,T)}return L}class S{constructor(L){this.source=L,this.isHttp=/^https?:/i.test(L.url),this.httpHeaders=this.isHttp&&L.httpHeaders||{},this._fullRequestReader=null,this._rangeRequestReaders=[]}get _progressiveDataLength(){var L;return((L=this._fullRequestReader)==null?void 0:L._loaded)??0}getFullReader(){return(0,e.assert)(!this._fullRequestReader,"PDFFetchStream.getFullReader can only be called once."),this._fullRequestReader=new _(this),this._fullRequestReader}getRangeReader(L,w){if(w<=this._progressiveDataLength)return null;const T=new f(this,L,w);return this._rangeRequestReaders.push(T),T}cancelAllRequests(L){this._fullRequestReader&&this._fullRequestReader.cancel(L);for(const w of this._rangeRequestReaders.slice(0))w.cancel(L)}}r.PDFFetchStream=S;class _{constructor(L){this._stream=L,this._reader=null,this._loaded=0,this._filename=null;const w=L.source;this._withCredentials=w.withCredentials||!1,this._contentLength=w.length,this._headersCapability=(0,e.createPromiseCapability)(),this._disableRange=w.disableRange||!1,this._rangeChunkSize=w.rangeChunkSize,!this._rangeChunkSize&&!this._disableRange&&(this._disableRange=!0),this._abortController=new AbortController,this._isStreamingSupported=!w.disableStream,this._isRangeSupported=!w.disableRange,this._headers=O(this._stream.httpHeaders);const T=w.url;fetch(T,k(this._headers,this._withCredentials,this._abortController)).then(h=>{if(!(0,a.validateResponseStatus)(h.status))throw(0,a.createResponseStatusError)(h.status,T);this._reader=h.body.getReader(),this._headersCapability.resolve();const t=x=>h.headers.get(x),{allowRangeRequests:o,suggestedLength:c}=(0,a.validateRangeRequestCapabilities)({getResponseHeader:t,isHttp:this._stream.isHttp,rangeChunkSize:this._rangeChunkSize,disableRange:this._disableRange});this._isRangeSupported=o,this._contentLength=c||this._contentLength,this._filename=(0,a.extractFilenameFromHeader)(t),!this._isStreamingSupported&&this._isRangeSupported&&this.cancel(new e.AbortException("Streaming is disabled."))}).catch(this._headersCapability.reject),this.onProgress=null}get headersReady(){return this._headersCapability.promise}get filename(){return this._filename}get contentLength(){return this._contentLength}get isRangeSupported(){return this._isRangeSupported}get isStreamingSupported(){return this._isStreamingSupported}async read(){await this._headersCapability.promise;const{value:L,done:w}=await this._reader.read();return w?{value:L,done:w}:(this._loaded+=L.byteLength,this.onProgress&&this.onProgress({loaded:this._loaded,total:this._contentLength}),{value:new Uint8Array(L).buffer,done:!1})}cancel(L){this._reader&&this._reader.cancel(L),this._abortController.abort()}}class f{constructor(L,w,T){this._stream=L,this._reader=null,this._loaded=0;const h=L.source;this._withCredentials=h.withCredentials||!1,this._readCapability=(0,e.createPromiseCapability)(),this._isStreamingSupported=!h.disableStream,this._abortController=new AbortController,this._headers=O(this._stream.httpHeaders),this._headers.append("Range",`bytes=${w}-${T-1}`);const t=h.url;fetch(t,k(this._headers,this._withCredentials,this._abortController)).then(o=>{if(!(0,a.validateResponseStatus)(o.status))throw(0,a.createResponseStatusError)(o.status,t);this._readCapability.resolve(),this._reader=o.body.getReader()}).catch(this._readCapability.reject),this.onProgress=null}get isStreamingSupported(){return this._isStreamingSupported}async read(){await this._readCapability.promise;const{value:L,done:w}=await this._reader.read();return w?{value:L,done:w}:(this._loaded+=L.byteLength,this.onProgress&&this.onProgress({loaded:this._loaded}),{value:new Uint8Array(L).buffer,done:!1})}cancel(L){this._reader&&this._reader.cancel(L),this._abortController.abort()}}}],__webpack_module_cache__={};function __w_pdfjs_require__(A){var r=__webpack_module_cache__[A];if(r!==void 0)return r.exports;var y=__webpack_module_cache__[A]={exports:{}};return __webpack_modules__[A](y,y.exports,__w_pdfjs_require__),y.exports}var __webpack_exports__={};return(()=>{var A=__webpack_exports__;Object.defineProperty(A,"__esModule",{value:!0}),Object.defineProperty(A,"AnnotationEditorLayer",{enumerable:!0,get:function(){return a.AnnotationEditorLayer}}),Object.defineProperty(A,"AnnotationEditorParamsType",{enumerable:!0,get:function(){return r.AnnotationEditorParamsType}}),Object.defineProperty(A,"AnnotationEditorType",{enumerable:!0,get:function(){return r.AnnotationEditorType}}),Object.defineProperty(A,"AnnotationEditorUIManager",{enumerable:!0,get:function(){return k.AnnotationEditorUIManager}}),Object.defineProperty(A,"AnnotationLayer",{enumerable:!0,get:function(){return O.AnnotationLayer}}),Object.defineProperty(A,"AnnotationMode",{enumerable:!0,get:function(){return r.AnnotationMode}}),Object.defineProperty(A,"CMapCompressionType",{enumerable:!0,get:function(){return r.CMapCompressionType}}),Object.defineProperty(A,"GlobalWorkerOptions",{enumerable:!0,get:function(){return S.GlobalWorkerOptions}}),Object.defineProperty(A,"InvalidPDFException",{enumerable:!0,get:function(){return r.InvalidPDFException}}),Object.defineProperty(A,"LoopbackPort",{enumerable:!0,get:function(){return y.LoopbackPort}}),Object.defineProperty(A,"MissingPDFException",{enumerable:!0,get:function(){return r.MissingPDFException}}),Object.defineProperty(A,"OPS",{enumerable:!0,get:function(){return r.OPS}}),Object.defineProperty(A,"PDFDataRangeTransport",{enumerable:!0,get:function(){return y.PDFDataRangeTransport}}),Object.defineProperty(A,"PDFDateString",{enumerable:!0,get:function(){return e.PDFDateString}}),Object.defineProperty(A,"PDFWorker",{enumerable:!0,get:function(){return y.PDFWorker}}),Object.defineProperty(A,"PasswordResponses",{enumerable:!0,get:function(){return r.PasswordResponses}}),Object.defineProperty(A,"PermissionFlag",{enumerable:!0,get:function(){return r.PermissionFlag}}),Object.defineProperty(A,"PixelsPerInch",{enumerable:!0,get:function(){return e.PixelsPerInch}}),Object.defineProperty(A,"RenderingCancelledException",{enumerable:!0,get:function(){return e.RenderingCancelledException}}),Object.defineProperty(A,"SVGGraphics",{enumerable:!0,get:function(){return C.SVGGraphics}}),Object.defineProperty(A,"UNSUPPORTED_FEATURES",{enumerable:!0,get:function(){return r.UNSUPPORTED_FEATURES}}),Object.defineProperty(A,"UnexpectedResponseException",{enumerable:!0,get:function(){return r.UnexpectedResponseException}}),Object.defineProperty(A,"Util",{enumerable:!0,get:function(){return r.Util}}),Object.defineProperty(A,"VerbosityLevel",{enumerable:!0,get:function(){return r.VerbosityLevel}}),Object.defineProperty(A,"XfaLayer",{enumerable:!0,get:function(){return L.XfaLayer}}),Object.defineProperty(A,"build",{enumerable:!0,get:function(){return y.build}}),Object.defineProperty(A,"createPromiseCapability",{enumerable:!0,get:function(){return r.createPromiseCapability}}),Object.defineProperty(A,"createValidAbsoluteUrl",{enumerable:!0,get:function(){return r.createValidAbsoluteUrl}}),Object.defineProperty(A,"getDocument",{enumerable:!0,get:function(){return y.getDocument}}),Object.defineProperty(A,"getFilenameFromUrl",{enumerable:!0,get:function(){return e.getFilenameFromUrl}}),Object.defineProperty(A,"getPdfFilenameFromUrl",{enumerable:!0,get:function(){return e.getPdfFilenameFromUrl}}),Object.defineProperty(A,"getXfaPageViewport",{enumerable:!0,get:function(){return e.getXfaPageViewport}}),Object.defineProperty(A,"isPdfFile",{enumerable:!0,get:function(){return e.isPdfFile}}),Object.defineProperty(A,"loadScript",{enumerable:!0,get:function(){return e.loadScript}}),Object.defineProperty(A,"renderTextLayer",{enumerable:!0,get:function(){return f.renderTextLayer}}),Object.defineProperty(A,"shadow",{enumerable:!0,get:function(){return r.shadow}}),Object.defineProperty(A,"version",{enumerable:!0,get:function(){return y.version}});var r=__w_pdfjs_require__(1),y=__w_pdfjs_require__(4),e=__w_pdfjs_require__(8),a=__w_pdfjs_require__(22),k=__w_pdfjs_require__(7),O=__w_pdfjs_require__(27),S=__w_pdfjs_require__(15),_=__w_pdfjs_require__(3),f=__w_pdfjs_require__(30),C=__w_pdfjs_require__(31),L=__w_pdfjs_require__(29);if(_.isNodeJS){const{PDFNodeStream:w}=__w_pdfjs_require__(32);(0,y.setPDFNetworkStreamFactory)(T=>new w(T))}else{const{PDFNetworkStream:w}=__w_pdfjs_require__(35),{PDFFetchStream:T}=__w_pdfjs_require__(36);(0,y.setPDFNetworkStreamFactory)(h=>(0,e.isValidFetchUrl)(h.url)?new T(h):new w(h))}})(),__webpack_exports__})())}(pdf)),pdf.exports}var pdfExports=requirePdf();function _objectWithoutProperties(A,r){if(A==null)return{};var y,e,a=_objectWithoutPropertiesLoose(A,r);if(Object.getOwnPropertySymbols){var k=Object.getOwnPropertySymbols(A);for(e=0;e<k.length;e++)y=k[e],r.indexOf(y)===-1&&{}.propertyIsEnumerable.call(A,y)&&(a[y]=A[y])}return a}function _typeof(A){"@babel/helpers - typeof";return _typeof=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(r){return typeof r}:function(r){return r&&typeof Symbol=="function"&&r.constructor===Symbol&&r!==Symbol.prototype?"symbol":typeof r},_typeof(A)}function _classCallCheck(A,r){if(!(A instanceof r))throw new TypeError("Cannot call a class as a function")}function toPrimitive(A,r){if(_typeof(A)!="object"||!A)return A;var y=A[Symbol.toPrimitive];if(y!==void 0){var e=y.call(A,r);if(_typeof(e)!="object")return e;throw new TypeError("@@toPrimitive must return a primitive value.")}return(r==="string"?String:Number)(A)}function toPropertyKey(A){var r=toPrimitive(A,"string");return _typeof(r)=="symbol"?r:r+""}function _defineProperties(A,r){for(var y=0;y<r.length;y++){var e=r[y];e.enumerable=e.enumerable||!1,e.configurable=!0,"value"in e&&(e.writable=!0),Object.defineProperty(A,toPropertyKey(e.key),e)}}function _createClass(A,r,y){return r&&_defineProperties(A.prototype,r),Object.defineProperty(A,"prototype",{writable:!1}),A}function _assertThisInitialized(A){if(A===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return A}function _inherits(A,r){if(typeof r!="function"&&r!==null)throw new TypeError("Super expression must either be null or a function");A.prototype=Object.create(r&&r.prototype,{constructor:{value:A,writable:!0,configurable:!0}}),Object.defineProperty(A,"prototype",{writable:!1}),r&&_setPrototypeOf(A,r)}function _possibleConstructorReturn(A,r){if(r&&(_typeof(r)=="object"||typeof r=="function"))return r;if(r!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return _assertThisInitialized(A)}function _getPrototypeOf(A){return _getPrototypeOf=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},_getPrototypeOf(A)}function _defineProperty(A,r,y){return(r=toPropertyKey(r))in A?Object.defineProperty(A,r,{value:y,enumerable:!0,configurable:!0,writable:!0}):A[r]=y,A}var __spreadArray=function(A,r,y){if(y||arguments.length===2)for(var e=0,a=r.length,k;e<a;e++)(k||!(e in r))&&(k||(k=Array.prototype.slice.call(r,0,e)),k[e]=r[e]);return A.concat(k||Array.prototype.slice.call(r))},clipboardEvents=["onCopy","onCut","onPaste"],compositionEvents=["onCompositionEnd","onCompositionStart","onCompositionUpdate"],focusEvents=["onFocus","onBlur"],formEvents=["onInput","onInvalid","onReset","onSubmit"],imageEvents=["onLoad","onError"],keyboardEvents=["onKeyDown","onKeyPress","onKeyUp"],mediaEvents=["onAbort","onCanPlay","onCanPlayThrough","onDurationChange","onEmptied","onEncrypted","onEnded","onError","onLoadedData","onLoadedMetadata","onLoadStart","onPause","onPlay","onPlaying","onProgress","onRateChange","onSeeked","onSeeking","onStalled","onSuspend","onTimeUpdate","onVolumeChange","onWaiting"],mouseEvents=["onClick","onContextMenu","onDoubleClick","onMouseDown","onMouseEnter","onMouseLeave","onMouseMove","onMouseOut","onMouseOver","onMouseUp"],dragEvents=["onDrag","onDragEnd","onDragEnter","onDragExit","onDragLeave","onDragOver","onDragStart","onDrop"],selectionEvents=["onSelect"],touchEvents=["onTouchCancel","onTouchEnd","onTouchMove","onTouchStart"],pointerEvents=["onPointerDown","onPointerMove","onPointerUp","onPointerCancel","onGotPointerCapture","onLostPointerCapture","onPointerEnter","onPointerLeave","onPointerOver","onPointerOut"],uiEvents=["onScroll"],wheelEvents=["onWheel"],animationEvents=["onAnimationStart","onAnimationEnd","onAnimationIteration"],transitionEvents=["onTransitionEnd"],otherEvents=["onToggle"],changeEvents=["onChange"],allEvents=__spreadArray(__spreadArray(__spreadArray(__spreadArray(__spreadArray(__spreadArray(__spreadArray(__spreadArray(__spreadArray(__spreadArray(__spreadArray(__spreadArray(__spreadArray(__spreadArray(__spreadArray(__spreadArray(__spreadArray(__spreadArray([],clipboardEvents,!0),compositionEvents,!0),focusEvents,!0),formEvents,!0),imageEvents,!0),keyboardEvents,!0),mediaEvents,!0),mouseEvents,!0),dragEvents,!0),selectionEvents,!0),touchEvents,!0),pointerEvents,!0),uiEvents,!0),wheelEvents,!0),animationEvents,!0),transitionEvents,!0),changeEvents,!0),otherEvents,!0);function makeEventProps(A,r){var y={};return allEvents.forEach(function(e){var a=A[e];a&&(r?y[e]=function(k){return a(k,r(e))}:y[e]=a)}),y}function makeCancellablePromise(A){var r=!1,y=new Promise(function(e,a){A.then(function(k){return!r&&e(k)}).catch(function(k){return!r&&a(k)})});return{promise:y,cancel:function(){r=!0}}}const DocumentContext=reactExports.createContext(null);function Message(A){var r=A.children,y=A.type;return React.createElement("div",{className:"react-pdf__message react-pdf__message--".concat(y)},r)}Message.propTypes={children:PropTypes.node,type:PropTypes.oneOf(["error","loading","no-data"]).isRequired};var DEFAULT_LINK_REL="noopener noreferrer nofollow",LinkService=function(){function A(){_classCallCheck(this,A),this.externalLinkTarget=null,this.externalLinkRel=null}return _createClass(A,[{key:"setDocument",value:function(y){this.pdfDocument=y}},{key:"setViewer",value:function(y){this.pdfViewer=y}},{key:"setExternalLinkRel",value:function(y){this.externalLinkRel=y}},{key:"setExternalLinkTarget",value:function(y){this.externalLinkTarget=y}},{key:"setHistory",value:function(){}},{key:"pagesCount",get:function(){return this.pdfDocument?this.pdfDocument.numPages:0}},{key:"page",get:function(){return this.pdfViewer.currentPageNumber},set:function(y){this.pdfViewer.currentPageNumber=y}},{key:"rotation",get:function(){return 0},set:function(y){}},{key:"goToDestination",value:function(y){var e=this;new Promise(function(a){typeof y=="string"?e.pdfDocument.getDestination(y).then(a):Array.isArray(y)?a(y):y.then(a)}).then(function(a){invariant(Array.isArray(a));var k=a[0];new Promise(function(O){k instanceof Object?e.pdfDocument.getPageIndex(k).then(function(S){O(S)}).catch(function(){invariant(!1)}):typeof k=="number"?O(k):invariant(!1)}).then(function(O){var S=O+1;invariant(S>=1&&S<=e.pagesCount),e.pdfViewer.scrollPageIntoView({dest:y,pageIndex:O,pageNumber:S})})})}},{key:"navigateTo",value:function(y){this.goToDestination(y)}},{key:"goToPage",value:function(){}},{key:"addLinkAttributes",value:function(y,e,a){y.href=e,y.rel=this.externalLinkRel||DEFAULT_LINK_REL,y.target=a?"_blank":this.externalLinkTarget||""}},{key:"getDestinationHash",value:function(){return"#"}},{key:"getAnchorUrl",value:function(){return"#"}},{key:"setHash",value:function(){}},{key:"executeNamedAction",value:function(){}},{key:"cachePageRef",value:function(){}},{key:"isPageVisible",value:function(){return!0}},{key:"isPageCached",value:function(){return!0}}]),A}(),PasswordResponses={NEED_PASSWORD:1,INCORRECT_PASSWORD:2};function _arrayWithHoles(A){if(Array.isArray(A))return A}function _iterableToArrayLimit(A,r){var y=A==null?null:typeof Symbol<"u"&&A[Symbol.iterator]||A["@@iterator"];if(y!=null){var e,a,k,O,S=[],_=!0,f=!1;try{if(k=(y=y.call(A)).next,r===0){if(Object(y)!==y)return;_=!1}else for(;!(_=(e=k.call(y)).done)&&(S.push(e.value),S.length!==r);_=!0);}catch(C){f=!0,a=C}finally{try{if(!_&&y.return!=null&&(O=y.return(),Object(O)!==O))return}finally{if(f)throw a}}return S}}function _arrayLikeToArray(A,r){(r==null||r>A.length)&&(r=A.length);for(var y=0,e=Array(r);y<r;y++)e[y]=A[y];return e}function _unsupportedIterableToArray(A,r){if(A){if(typeof A=="string")return _arrayLikeToArray(A,r);var y={}.toString.call(A).slice(8,-1);return y==="Object"&&A.constructor&&(y=A.constructor.name),y==="Map"||y==="Set"?Array.from(A):y==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(y)?_arrayLikeToArray(A,r):void 0}}function _nonIterableRest(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function _slicedToArray(A,r){return _arrayWithHoles(A)||_iterableToArrayLimit(A,r)||_unsupportedIterableToArray(A,r)||_nonIterableRest()}var isBrowser=typeof document<"u";function isDefined(A){return typeof A<"u"}function isProvided(A){return isDefined(A)&&A!==null}function isString(A){return typeof A=="string"}function isArrayBuffer(A){return A instanceof ArrayBuffer}function isBlob(A){return invariant(isBrowser),A instanceof Blob}function isFile$1(A){return invariant(isBrowser),A instanceof File}function isDataURI(A){return isString(A)&&/^data:/.test(A)}function dataURItoByteString(A){invariant(isDataURI(A));var r=A.split(","),y=_slicedToArray(r,2),e=y[0],a=y[1],k=e.split(";");return k.indexOf("base64")!==-1?atob(a):unescape(a)}function getDevicePixelRatio(){return isBrowser&&window.devicePixelRatio||1}function cancelRunningTask(A){A&&A.cancel&&A.cancel()}function makePageCallback(A,r){return Object.defineProperty(A,"width",{get:function(){return this.view[2]*r},configurable:!0}),Object.defineProperty(A,"height",{get:function(){return this.view[3]*r},configurable:!0}),Object.defineProperty(A,"originalWidth",{get:function(){return this.view[2]},configurable:!0}),Object.defineProperty(A,"originalHeight",{get:function(){return this.view[3]},configurable:!0}),A}function isCancelException(A){return A.name==="RenderingCancelledException"}function loadFromFile(A){return new Promise(function(r,y){var e=new FileReader;return e.onload=function(){return r(new Uint8Array(e.result))},e.onerror=function(a){switch(a.target.error.code){case a.target.error.NOT_FOUND_ERR:return y(new Error("Error while reading a file: File not found."));case a.target.error.NOT_READABLE_ERR:return y(new Error("Error while reading a file: File not readable."));case a.target.error.SECURITY_ERR:return y(new Error("Error while reading a file: Security error."));case a.target.error.ABORT_ERR:return y(new Error("Error while reading a file: Aborted."));default:return y(new Error("Error while reading a file."))}},e.readAsArrayBuffer(A),null})}function _arrayWithoutHoles(A){if(Array.isArray(A))return _arrayLikeToArray(A)}function _iterableToArray(A){if(typeof Symbol<"u"&&A[Symbol.iterator]!=null||A["@@iterator"]!=null)return Array.from(A)}function _nonIterableSpread(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function _toConsumableArray(A){return _arrayWithoutHoles(A)||_iterableToArray(A)||_unsupportedIterableToArray(A)||_nonIterableSpread()}var eventProps=function(){var A={};return[].concat(_toConsumableArray(mouseEvents),_toConsumableArray(touchEvents),_toConsumableArray(keyboardEvents)).forEach(function(r){A[r]=PropTypes.func}),A}(),fileTypes=[PropTypes.string,PropTypes.instanceOf(ArrayBuffer),PropTypes.shape({data:PropTypes.oneOfType([PropTypes.object,PropTypes.string]),httpHeaders:PropTypes.object,range:PropTypes.object,url:PropTypes.string,withCredentials:PropTypes.bool})];typeof File<"u"&&fileTypes.push(PropTypes.instanceOf(File));typeof Blob<"u"&&fileTypes.push(PropTypes.instanceOf(Blob));var isClassName=PropTypes.oneOfType([PropTypes.string,PropTypes.arrayOf(PropTypes.string)]),isFile=PropTypes.oneOfType(fileTypes),isLinkService=PropTypes.instanceOf(LinkService);PropTypes.oneOf(["_self","_blank","_parent","_top"]);var isPage=PropTypes.shape({commonObjs:PropTypes.shape({}).isRequired,getAnnotations:PropTypes.func.isRequired,getTextContent:PropTypes.func.isRequired,getViewport:PropTypes.func.isRequired,render:PropTypes.func.isRequired}),isPageIndex=function A(r,y,e){var a=r[y],k=r.pageNumber,O=r.pdf;if(!isDefined(O))return null;if(isDefined(a)){if(typeof a!="number")return new Error("`".concat(y,"` of type `").concat(_typeof(a),"` supplied to `").concat(e,"`, expected `number`."));if(a<0)return new Error("Expected `".concat(y,"` to be greater or equal to 0."));var S=O.numPages;if(a+1>S)return new Error("Expected `".concat(y,"` to be less or equal to ").concat(S-1,"."))}else if(!isDefined(k))return new Error("`".concat(y,"` not supplied. Either pageIndex or pageNumber must be supplied to `").concat(e,"`."));return null},isPageNumber=function A(r,y,e){var a=r[y],k=r.pageIndex,O=r.pdf;if(!isDefined(O))return null;if(isDefined(a)){if(typeof a!="number")return new Error("`".concat(y,"` of type `").concat(_typeof(a),"` supplied to `").concat(e,"`, expected `number`."));if(a<1)return new Error("Expected `".concat(y,"` to be greater or equal to 1."));var S=O.numPages;if(a>S)return new Error("Expected `".concat(y,"` to be less or equal to ").concat(S,"."))}else if(!isDefined(k))return new Error("`".concat(y,"` not supplied. Either pageIndex or pageNumber must be supplied to `").concat(e,"`."));return null},isPdf=PropTypes.oneOfType([PropTypes.shape({getDestination:PropTypes.func.isRequired,getOutline:PropTypes.func.isRequired,getPage:PropTypes.func.isRequired,numPages:PropTypes.number.isRequired}),PropTypes.bool]),isRef=PropTypes.oneOfType([PropTypes.func,PropTypes.shape({current:PropTypes.any})]),isRenderMode=PropTypes.oneOf(["canvas","none","svg"]),isRotate=PropTypes.oneOf([0,90,180,270]),_excluded$1=["url"];function ownKeys$3(A,r){var y=Object.keys(A);if(Object.getOwnPropertySymbols){var e=Object.getOwnPropertySymbols(A);r&&(e=e.filter(function(a){return Object.getOwnPropertyDescriptor(A,a).enumerable})),y.push.apply(y,e)}return y}function _objectSpread$3(A){for(var r=1;r<arguments.length;r++){var y=arguments[r]!=null?arguments[r]:{};r%2?ownKeys$3(Object(y),!0).forEach(function(e){_defineProperty(A,e,y[e])}):Object.getOwnPropertyDescriptors?Object.defineProperties(A,Object.getOwnPropertyDescriptors(y)):ownKeys$3(Object(y)).forEach(function(e){Object.defineProperty(A,e,Object.getOwnPropertyDescriptor(y,e))})}return A}function _createSuper$7(A){var r=_isNativeReflectConstruct$7();return function(){var e=_getPrototypeOf(A),a;if(r){var k=_getPrototypeOf(this).constructor;a=Reflect.construct(e,arguments,k)}else a=e.apply(this,arguments);return _possibleConstructorReturn(this,a)}}function _isNativeReflectConstruct$7(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}var PDFDataRangeTransport=pdfExports.PDFDataRangeTransport,Document=function(A){_inherits(y,A);var r=_createSuper$7(y);function y(){var e;_classCallCheck(this,y);for(var a=arguments.length,k=new Array(a),O=0;O<a;O++)k[O]=arguments[O];return e=r.call.apply(r,[this].concat(k)),_defineProperty(_assertThisInitialized(e),"state",{pdf:null}),_defineProperty(_assertThisInitialized(e),"viewer",{scrollPageIntoView:function(_){var f=_.dest,C=_.pageIndex,L=_.pageNumber,w=e.props.onItemClick;if(w){w({dest:f,pageIndex:C,pageNumber:L});return}var T=e.pages[C];if(T){T.scrollIntoView();return}}}),_defineProperty(_assertThisInitialized(e),"linkService",new LinkService),_defineProperty(_assertThisInitialized(e),"loadDocument",function(){cancelRunningTask(e.runningTask),e.loadingTask&&e.loadingTask.destroy();var S=makeCancellablePromise(e.findDocumentSource());e.runningTask=S,S.promise.then(function(_){if(e.onSourceSuccess(),!!_){e.setState(function(h){return h.pdf?{pdf:null}:null});var f=e.props,C=f.options,L=f.onLoadProgress,w=f.onPassword,T=pdfExports.getDocument(_objectSpread$3(_objectSpread$3({},_),C));T.onPassword=w,L&&(T.onProgress=L),e.loadingTask=T,T.promise.then(function(h){e.setState(function(t){return t.pdf&&t.pdf.fingerprint===h.fingerprint?null:{pdf:h}},e.onLoadSuccess)}).catch(function(h){e.onLoadError(h)})}}).catch(function(_){e.onSourceError(_)})}),_defineProperty(_assertThisInitialized(e),"setupLinkService",function(){var S=e.props,_=S.externalLinkRel,f=S.externalLinkTarget;e.linkService.setViewer(e.viewer),e.linkService.setExternalLinkRel(_),e.linkService.setExternalLinkTarget(f)}),_defineProperty(_assertThisInitialized(e),"onSourceSuccess",function(){var S=e.props.onSourceSuccess;S&&S()}),_defineProperty(_assertThisInitialized(e),"onSourceError",function(S){var _=e.props.onSourceError;_&&_(S)}),_defineProperty(_assertThisInitialized(e),"onLoadSuccess",function(){var S=e.props.onLoadSuccess,_=e.state.pdf;S&&S(_),e.pages=new Array(_.numPages),e.linkService.setDocument(_)}),_defineProperty(_assertThisInitialized(e),"onLoadError",function(S){e.setState({pdf:!1});var _=e.props.onLoadError;_&&_(S)}),_defineProperty(_assertThisInitialized(e),"findDocumentSource",function(){return new Promise(function(S){var _=e.props.file;if(_||S(null),typeof _=="string"){if(isDataURI(_)){var f=dataURItoByteString(_);S({data:f})}S({url:_})}if(_ instanceof PDFDataRangeTransport&&S({range:_}),isArrayBuffer(_)&&S({data:_}),isBrowser&&(isBlob(_)||isFile$1(_))){loadFromFile(_).then(function(T){S({data:T})});return}if(invariant(_typeof(_)==="object"),invariant(_.url||_.data||_.range),typeof _.url=="string"&&isDataURI(_.url)){var C=_.url,L=_objectWithoutProperties(_,_excluded$1),w=dataURItoByteString(C);S(_objectSpread$3({data:w},L))}S(_)})}),_defineProperty(_assertThisInitialized(e),"registerPage",function(S,_){e.pages[S]=_}),_defineProperty(_assertThisInitialized(e),"unregisterPage",function(S){delete e.pages[S]}),e}return _createClass(y,[{key:"componentDidMount",value:function(){this.loadDocument(),this.setupLinkService()}},{key:"componentDidUpdate",value:function(a){var k=this.props.file;k!==a.file&&this.loadDocument()}},{key:"componentWillUnmount",value:function(){cancelRunningTask(this.runningTask),this.loadingTask&&this.loadingTask.destroy()}},{key:"childContext",get:function(){var a=this.linkService,k=this.registerPage,O=this.unregisterPage,S=this.props,_=S.imageResourcesPath,f=S.renderMode,C=S.rotate,L=this.state.pdf;return{imageResourcesPath:_,linkService:a,pdf:L,registerPage:k,renderMode:f,rotate:C,unregisterPage:O}}},{key:"eventProps",get:function(){var a=this;return makeEventProps(this.props,function(){return a.state.pdf})}},{key:"renderChildren",value:function(){var a=this.props.children;return React.createElement(DocumentContext.Provider,{value:this.childContext},a)}},{key:"renderContent",value:function(){var a=this.props.file,k=this.state.pdf;if(!a){var O=this.props.noData;return React.createElement(Message,{type:"no-data"},typeof O=="function"?O():O)}if(k===null){var S=this.props.loading;return React.createElement(Message,{type:"loading"},typeof S=="function"?S():S)}if(k===!1){var _=this.props.error;return React.createElement(Message,{type:"error"},typeof _=="function"?_():_)}return this.renderChildren()}},{key:"render",value:function(){var a=this.props,k=a.className,O=a.inputRef;return React.createElement("div",_extends({className:clsx("react-pdf__Document",k),ref:O},this.eventProps),this.renderContent())}}]),y}(reactExports.PureComponent);Document.defaultProps={error:"Failed to load PDF file.",loading:"Loading PDF…",noData:"No PDF file specified.",onPassword:function A(r,y){switch(y){case PasswordResponses.NEED_PASSWORD:{var e=prompt("Enter the password to open this PDF file.");r(e);break}case PasswordResponses.INCORRECT_PASSWORD:{var a=prompt("Invalid password. Please try again.");r(a);break}}}};var isFunctionOrNode$1=PropTypes.oneOfType([PropTypes.func,PropTypes.node]);Document.propTypes=_objectSpread$3(_objectSpread$3({},eventProps),{},{children:PropTypes.node,className:isClassName,error:isFunctionOrNode$1,externalLinkRel:PropTypes.string,externalLinkTarget:PropTypes.string,file:isFile,imageResourcesPath:PropTypes.string,inputRef:isRef,loading:isFunctionOrNode$1,noData:isFunctionOrNode$1,onItemClick:PropTypes.func,onLoadError:PropTypes.func,onLoadProgress:PropTypes.func,onLoadSuccess:PropTypes.func,onPassword:PropTypes.func,onSourceError:PropTypes.func,onSourceSuccess:PropTypes.func,rotate:PropTypes.number});const OutlineContext=reactExports.createContext(null);var Ref=function(){function A(r){var y=r.num,e=r.gen;_classCallCheck(this,A),this.num=y,this.gen=e}return _createClass(A,[{key:"toString",value:function(){var y="".concat(this.num,"R");return this.gen!==0&&(y+=this.gen),y}}]),A}(),_excluded=["item"];function _createSuper$6(A){var r=_isNativeReflectConstruct$6();return function(){var e=_getPrototypeOf(A),a;if(r){var k=_getPrototypeOf(this).constructor;a=Reflect.construct(e,arguments,k)}else a=e.apply(this,arguments);return _possibleConstructorReturn(this,a)}}function _isNativeReflectConstruct$6(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}var OutlineItemInternal=function(A){_inherits(y,A);var r=_createSuper$6(y);function y(){var e;_classCallCheck(this,y);for(var a=arguments.length,k=new Array(a),O=0;O<a;O++)k[O]=arguments[O];return e=r.call.apply(r,[this].concat(k)),_defineProperty(_assertThisInitialized(e),"getDestination",function(){return new Promise(function(S,_){if(isDefined(e.destination)){S(e.destination);return}var f=e.props,C=f.item,L=f.pdf;typeof C.dest=="string"?L.getDestination(C.dest).then(S).catch(_):S(C.dest)}).then(function(S){return e.destination=S,S})}),_defineProperty(_assertThisInitialized(e),"getPageIndex",function(){return new Promise(function(S,_){var f=e.props.pdf;if(isDefined(e.pageIndex)){S(e.pageIndex);return}e.getDestination().then(function(C){if(C){var L=_slicedToArray(C,1),w=L[0];f.getPageIndex(new Ref(w)).then(S).catch(_)}})}).then(function(S){return e.pageIndex=S,e.pageIndex})}),_defineProperty(_assertThisInitialized(e),"getPageNumber",function(){return new Promise(function(S,_){if(isDefined(e.pageNumber)){S(e.pageNumber);return}e.getPageIndex().then(function(f){S(f+1)}).catch(_)}).then(function(S){return e.pageNumber=S,S})}),_defineProperty(_assertThisInitialized(e),"onClick",function(S){var _=e.props.onClick;return S.preventDefault(),_?Promise.all([e.getDestination(),e.getPageIndex(),e.getPageNumber()]).then(function(f){var C=_slicedToArray(f,3),L=C[0],w=C[1],T=C[2];_({dest:L,pageIndex:w,pageNumber:T})}):!1}),e}return _createClass(y,[{key:"renderSubitems",value:function(){var a=this.props,k=a.item,O=_objectWithoutProperties(a,_excluded);if(!k.items||!k.items.length)return null;var S=k.items;return React.createElement("ul",null,S.map(function(_,f){return React.createElement(y,_extends({key:typeof _.destination=="string"?_.destination:f,item:_},O))}))}},{key:"render",value:function(){var a=this.props.item;return React.createElement("li",null,React.createElement("a",{href:"#",onClick:this.onClick},a.title),this.renderSubitems())}}]),y}(reactExports.PureComponent),isDestination=PropTypes.oneOfType([PropTypes.string,PropTypes.arrayOf(PropTypes.any)]);OutlineItemInternal.propTypes={item:PropTypes.shape({dest:isDestination,items:PropTypes.arrayOf(PropTypes.shape({dest:isDestination,title:PropTypes.string})),title:PropTypes.string}).isRequired,onClick:PropTypes.func,pdf:isPdf.isRequired};var OutlineItem=function A(r){return React.createElement(DocumentContext.Consumer,null,function(y){return React.createElement(OutlineContext.Consumer,null,function(e){return React.createElement(OutlineItemInternal,_extends({},y,e,r))})})};function ownKeys$2(A,r){var y=Object.keys(A);if(Object.getOwnPropertySymbols){var e=Object.getOwnPropertySymbols(A);r&&(e=e.filter(function(a){return Object.getOwnPropertyDescriptor(A,a).enumerable})),y.push.apply(y,e)}return y}function _objectSpread$2(A){for(var r=1;r<arguments.length;r++){var y=arguments[r]!=null?arguments[r]:{};r%2?ownKeys$2(Object(y),!0).forEach(function(e){_defineProperty(A,e,y[e])}):Object.getOwnPropertyDescriptors?Object.defineProperties(A,Object.getOwnPropertyDescriptors(y)):ownKeys$2(Object(y)).forEach(function(e){Object.defineProperty(A,e,Object.getOwnPropertyDescriptor(y,e))})}return A}function _createSuper$5(A){var r=_isNativeReflectConstruct$5();return function(){var e=_getPrototypeOf(A),a;if(r){var k=_getPrototypeOf(this).constructor;a=Reflect.construct(e,arguments,k)}else a=e.apply(this,arguments);return _possibleConstructorReturn(this,a)}}function _isNativeReflectConstruct$5(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}var OutlineInternal=function(A){_inherits(y,A);var r=_createSuper$5(y);function y(){var e;_classCallCheck(this,y);for(var a=arguments.length,k=new Array(a),O=0;O<a;O++)k[O]=arguments[O];return e=r.call.apply(r,[this].concat(k)),_defineProperty(_assertThisInitialized(e),"state",{outline:null}),_defineProperty(_assertThisInitialized(e),"loadOutline",function(){var S=e.props.pdf;e.setState(function(f){return f.outline?{outline:null}:null});var _=makeCancellablePromise(S.getOutline());e.runningTask=_,_.promise.then(function(f){e.setState({outline:f},e.onLoadSuccess)}).catch(function(f){e.onLoadError(f)})}),_defineProperty(_assertThisInitialized(e),"onLoadSuccess",function(){var S=e.props.onLoadSuccess,_=e.state.outline;S&&S(_)}),_defineProperty(_assertThisInitialized(e),"onLoadError",function(S){e.setState({outline:!1});var _=e.props.onLoadError;_&&_(S)}),_defineProperty(_assertThisInitialized(e),"onItemClick",function(S){var _=S.dest,f=S.pageIndex,C=S.pageNumber,L=e.props.onItemClick;L&&L({dest:_,pageIndex:f,pageNumber:C})}),e}return _createClass(y,[{key:"componentDidMount",value:function(){var a=this.props.pdf;invariant(a),this.loadOutline()}},{key:"componentDidUpdate",value:function(a){var k=this.props.pdf;a.pdf&&k!==a.pdf&&this.loadOutline()}},{key:"componentWillUnmount",value:function(){cancelRunningTask(this.runningTask)}},{key:"childContext",get:function(){return{onClick:this.onItemClick}}},{key:"eventProps",get:function(){var a=this;return makeEventProps(this.props,function(){return a.state.outline})}},{key:"renderOutline",value:function(){var a=this.state.outline;return React.createElement("ul",null,a.map(function(k,O){return React.createElement(OutlineItem,{key:typeof k.destination=="string"?k.destination:O,item:k})}))}},{key:"render",value:function(){var a=this.props.pdf,k=this.state.outline;if(!a||!k)return null;var O=this.props,S=O.className,_=O.inputRef;return React.createElement("div",_extends({className:clsx("react-pdf__Outline",S),ref:_},this.eventProps),React.createElement(OutlineContext.Provider,{value:this.childContext},this.renderOutline()))}}]),y}(reactExports.PureComponent);OutlineInternal.propTypes=_objectSpread$2({className:isClassName,inputRef:isRef,onItemClick:PropTypes.func,onLoadError:PropTypes.func,onLoadSuccess:PropTypes.func,pdf:isPdf},eventProps);function Outline(A,r){return React.createElement(DocumentContext.Consumer,null,function(y){return React.createElement(OutlineInternal,_extends({ref:r},y,A))})}const Outline$1=React.forwardRef(Outline);function mergeRefs(){for(var A=[],r=0;r<arguments.length;r++)A[r]=arguments[r];var y=A.filter(Boolean);if(y.length<=1){var e=y[0];return e||null}return function(k){y.forEach(function(O){typeof O=="function"?O(k):O&&(O.current=k)})}}const PageContext=reactExports.createContext(null);function _createSuper$4(A){var r=_isNativeReflectConstruct$4();return function(){var e=_getPrototypeOf(A),a;if(r){var k=_getPrototypeOf(this).constructor;a=Reflect.construct(e,arguments,k)}else a=e.apply(this,arguments);return _possibleConstructorReturn(this,a)}}function _isNativeReflectConstruct$4(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}var ANNOTATION_MODE=pdfExports.AnnotationMode,PageCanvasInternal=function(A){_inherits(y,A);var r=_createSuper$4(y);function y(){var e;_classCallCheck(this,y);for(var a=arguments.length,k=new Array(a),O=0;O<a;O++)k[O]=arguments[O];return e=r.call.apply(r,[this].concat(k)),_defineProperty(_assertThisInitialized(e),"canvasElement",reactExports.createRef()),_defineProperty(_assertThisInitialized(e),"onRenderSuccess",function(){e.renderer=null;var S=e.props,_=S.onRenderSuccess,f=S.page,C=S.scale;_&&_(makePageCallback(f,C))}),_defineProperty(_assertThisInitialized(e),"onRenderError",function(S){if(!isCancelException(S)){var _=e.props.onRenderError;_&&_(S)}}),_defineProperty(_assertThisInitialized(e),"drawPageOnCanvas",function(){var S=e.canvasElement.current;if(!S)return null;var _=_assertThisInitialized(e),f=_.renderViewport,C=_.viewport,L=e.props,w=L.canvasBackground,T=L.page,h=L.renderForms;S.width=f.width,S.height=f.height,S.style.width="".concat(Math.floor(C.width),"px"),S.style.height="".concat(Math.floor(C.height),"px");var t={annotationMode:h?ANNOTATION_MODE.ENABLE_FORMS:ANNOTATION_MODE.ENABLE,get canvasContext(){return S.getContext("2d",{alpha:!1})},viewport:f};w&&(t.background=w),e.cancelRenderingTask();var o=T.render(t);return e.renderer=o,o.promise.then(e.onRenderSuccess).catch(e.onRenderError)}),e}return _createClass(y,[{key:"componentDidMount",value:function(){this.drawPageOnCanvas()}},{key:"componentDidUpdate",value:function(a){var k=this.props,O=k.canvasBackground,S=k.devicePixelRatio,_=k.page,f=k.renderForms;(O!==a.canvasBackground||S!==a.devicePixelRatio||f!==a.renderForms)&&(_.cleanup(),this.drawPageOnCanvas())}},{key:"componentWillUnmount",value:function(){this.cancelRenderingTask();var a=this.canvasElement.current;a&&(a.width=0,a.height=0)}},{key:"cancelRenderingTask",value:function(){this.renderer&&(this.renderer.cancel(),this.renderer=null)}},{key:"devicePixelRatio",get:function(){var a=this.props.devicePixelRatio;return a||getDevicePixelRatio()}},{key:"renderViewport",get:function(){var a=this.devicePixelRatio,k=this.props,O=k.page,S=k.rotate,_=k.scale;return O.getViewport({scale:_*a,rotation:S})}},{key:"viewport",get:function(){var a=this.props,k=a.page,O=a.rotate,S=a.scale;return k.getViewport({scale:S,rotation:O})}},{key:"render",value:function(){var a=this.props.canvasRef;return React.createElement("canvas",{className:"react-pdf__Page__canvas",dir:"ltr",ref:mergeRefs(a,this.canvasElement),style:{display:"block",userSelect:"none"}})}}]),y}(reactExports.PureComponent);PageCanvasInternal.propTypes={canvasBackground:PropTypes.string,canvasRef:isRef,devicePixelRatio:PropTypes.number,onRenderError:PropTypes.func,onRenderSuccess:PropTypes.func,page:isPage.isRequired,renderForms:PropTypes.bool,rotate:isRotate,scale:PropTypes.number.isRequired};function PageCanvas(A){return React.createElement(PageContext.Consumer,null,function(r){return React.createElement(PageCanvasInternal,_extends({},r,A))})}function _createSuper$3(A){var r=_isNativeReflectConstruct$3();return function(){var e=_getPrototypeOf(A),a;if(r){var k=_getPrototypeOf(this).constructor;a=Reflect.construct(e,arguments,k)}else a=e.apply(this,arguments);return _possibleConstructorReturn(this,a)}}function _isNativeReflectConstruct$3(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}var PageSVGInternal=function(A){_inherits(y,A);var r=_createSuper$3(y);function y(){var e;_classCallCheck(this,y);for(var a=arguments.length,k=new Array(a),O=0;O<a;O++)k[O]=arguments[O];return e=r.call.apply(r,[this].concat(k)),_defineProperty(_assertThisInitialized(e),"state",{svg:null}),_defineProperty(_assertThisInitialized(e),"onRenderSuccess",function(){e.renderer=null;var S=e.props,_=S.onRenderSuccess,f=S.page,C=S.scale;_&&_(makePageCallback(f,C))}),_defineProperty(_assertThisInitialized(e),"onRenderError",function(S){if(!isCancelException(S)){var _=e.props.onRenderError;_&&_(S)}}),_defineProperty(_assertThisInitialized(e),"renderSVG",function(){var S=e.props.page;return e.renderer=S.getOperatorList(),e.renderer.then(function(_){var f=new pdfExports.SVGGraphics(S.commonObjs,S.objs);e.renderer=f.getSVG(_,e.viewport).then(function(C){e.setState({svg:C},e.onRenderSuccess)}).catch(e.onRenderError)}).catch(e.onRenderError)}),_defineProperty(_assertThisInitialized(e),"drawPageOnContainer",function(S){var _=e.state.svg;if(!(!S||!_)){S.firstElementChild||S.appendChild(_);var f=e.viewport,C=f.width,L=f.height;_.setAttribute("width",C),_.setAttribute("height",L)}}),e}return _createClass(y,[{key:"componentDidMount",value:function(){this.renderSVG()}},{key:"viewport",get:function(){var a=this.props,k=a.page,O=a.rotate,S=a.scale;return k.getViewport({scale:S,rotation:O})}},{key:"render",value:function(){var a=this,k=this.viewport,O=k.width,S=k.height;return React.createElement("div",{className:"react-pdf__Page__svg",ref:function(f){return a.drawPageOnContainer(f)},style:{display:"block",backgroundColor:"white",overflow:"hidden",width:O,height:S,userSelect:"none"}})}}]),y}(reactExports.PureComponent);PageSVGInternal.propTypes={onRenderError:PropTypes.func,onRenderSuccess:PropTypes.func,page:isPage.isRequired,rotate:isRotate,scale:PropTypes.number.isRequired};function PageSVG(A){return React.createElement(PageContext.Consumer,null,function(r){return React.createElement(PageSVGInternal,_extends({},r,A))})}function ownKeys$1(A,r){var y=Object.keys(A);if(Object.getOwnPropertySymbols){var e=Object.getOwnPropertySymbols(A);r&&(e=e.filter(function(a){return Object.getOwnPropertyDescriptor(A,a).enumerable})),y.push.apply(y,e)}return y}function _objectSpread$1(A){for(var r=1;r<arguments.length;r++){var y=arguments[r]!=null?arguments[r]:{};r%2?ownKeys$1(Object(y),!0).forEach(function(e){_defineProperty(A,e,y[e])}):Object.getOwnPropertyDescriptors?Object.defineProperties(A,Object.getOwnPropertyDescriptors(y)):ownKeys$1(Object(y)).forEach(function(e){Object.defineProperty(A,e,Object.getOwnPropertyDescriptor(y,e))})}return A}function _createSuper$2(A){var r=_isNativeReflectConstruct$2();return function(){var e=_getPrototypeOf(A),a;if(r){var k=_getPrototypeOf(this).constructor;a=Reflect.construct(e,arguments,k)}else a=e.apply(this,arguments);return _possibleConstructorReturn(this,a)}}function _isNativeReflectConstruct$2(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}var TextLayerInternal=function(A){_inherits(y,A);var r=_createSuper$2(y);function y(){var e;_classCallCheck(this,y);for(var a=arguments.length,k=new Array(a),O=0;O<a;O++)k[O]=arguments[O];return e=r.call.apply(r,[this].concat(k)),_defineProperty(_assertThisInitialized(e),"state",{textContent:null}),_defineProperty(_assertThisInitialized(e),"layerElement",reactExports.createRef()),_defineProperty(_assertThisInitialized(e),"endElement",reactExports.createRef()),_defineProperty(_assertThisInitialized(e),"loadTextContent",function(){var S=e.props.page,_=makeCancellablePromise(S.getTextContent());e.runningTask=_,_.promise.then(function(f){e.setState({textContent:f},e.onLoadSuccess)}).catch(function(f){e.onLoadError(f)})}),_defineProperty(_assertThisInitialized(e),"onLoadSuccess",function(){var S=e.props.onGetTextSuccess,_=e.state.textContent;S&&S(_)}),_defineProperty(_assertThisInitialized(e),"onLoadError",function(S){e.setState({textItems:!1});var _=e.props.onGetTextError;_&&_(S)}),_defineProperty(_assertThisInitialized(e),"onRenderSuccess",function(){var S=e.props.onRenderTextLayerSuccess;S&&S()}),_defineProperty(_assertThisInitialized(e),"onRenderError",function(S){var _=e.props.onRenderTextLayerError;_&&_(S)}),_defineProperty(_assertThisInitialized(e),"onMouseDown",function(){var S=e.endElement.current;S&&S.classList.add("active")}),_defineProperty(_assertThisInitialized(e),"onMouseUp",function(){var S=e.endElement.current;S&&S.classList.remove("active")}),e}return _createClass(y,[{key:"componentDidMount",value:function(){var a=this.props.page;invariant(a),parseInt(window.getComputedStyle(document.body).getPropertyValue("--react-pdf-text-layer"),10),this.loadTextContent()}},{key:"componentDidUpdate",value:function(a){var k=this.props.page;a.page&&k!==a.page&&this.loadTextContent()}},{key:"componentWillUnmount",value:function(){cancelRunningTask(this.runningTask)}},{key:"viewport",get:function(){var a=this.props,k=a.page,O=a.rotate,S=a.scale;return k.getViewport({scale:S,rotation:O})}},{key:"unrotatedViewport",get:function(){var a=this.props,k=a.page,O=a.scale;return k.getViewport({scale:O})}},{key:"rotate",get:function(){var a=this.props,k=a.page,O=a.rotate;return O-k.rotate}},{key:"renderTextLayer",value:function(){var a=this,k=this.state.textContent;if(!k)return null;var O=this.layerElement.current,S=this.viewport,_=this.props,f=_.customTextRenderer,C=_.pageIndex,L=_.pageNumber;cancelRunningTask(this.runningTask),O.innerHTML="";var w={container:O,textContent:k,viewport:S},T=pdfExports.renderTextLayer(w);this.runningTask=T,T.promise.then(function(){var h=document.createElement("div");if(h.className="endOfContent",O.append(h),a.endElement.current=h,f){var t=0;k.items.forEach(function(o,c){var x=a.layerElement.current.children[t],b=f(_objectSpread$1({pageIndex:C,pageNumber:L,itemIndex:c},o));x.innerHTML=b,t+=o.str&&o.hasEOL?2:1})}a.onRenderSuccess()}).catch(function(h){a.onRenderError(h)})}},{key:"render",value:function(){return React.createElement("div",{className:"react-pdf__Page__textContent textLayer",onMouseUp:this.onMouseUp,onMouseDown:this.onMouseDown,ref:this.layerElement},this.renderTextLayer())}}]),y}(reactExports.PureComponent);TextLayerInternal.propTypes={customTextRenderer:PropTypes.func,onGetTextError:PropTypes.func,onGetTextSuccess:PropTypes.func,onRenderTextLayerError:PropTypes.func,onRenderTextLayerSuccess:PropTypes.func,page:isPage.isRequired,pageIndex:PropTypes.number.isRequired,pageNumber:PropTypes.number.isRequired,rotate:isRotate,scale:PropTypes.number};function TextLayer(A){return React.createElement(PageContext.Consumer,null,function(r){return React.createElement(TextLayerInternal,_extends({},r,A))})}function _createSuper$1(A){var r=_isNativeReflectConstruct$1();return function(){var e=_getPrototypeOf(A),a;if(r){var k=_getPrototypeOf(this).constructor;a=Reflect.construct(e,arguments,k)}else a=e.apply(this,arguments);return _possibleConstructorReturn(this,a)}}function _isNativeReflectConstruct$1(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}var AnnotationLayerInternal=function(A){_inherits(y,A);var r=_createSuper$1(y);function y(){var e;_classCallCheck(this,y);for(var a=arguments.length,k=new Array(a),O=0;O<a;O++)k[O]=arguments[O];return e=r.call.apply(r,[this].concat(k)),_defineProperty(_assertThisInitialized(e),"state",{annotations:null}),_defineProperty(_assertThisInitialized(e),"layerElement",reactExports.createRef()),_defineProperty(_assertThisInitialized(e),"loadAnnotations",function(){var S=e.props.page,_=makeCancellablePromise(S.getAnnotations());e.runningTask=_,_.promise.then(function(f){e.setState({annotations:f},e.onLoadSuccess)}).catch(function(f){e.onLoadError(f)})}),_defineProperty(_assertThisInitialized(e),"onLoadSuccess",function(){var S=e.props.onGetAnnotationsSuccess,_=e.state.annotations;S&&S(_)}),_defineProperty(_assertThisInitialized(e),"onLoadError",function(S){e.setState({annotations:!1});var _=e.props.onGetAnnotationsError;_&&_(S)}),_defineProperty(_assertThisInitialized(e),"onRenderSuccess",function(){var S=e.props.onRenderAnnotationLayerSuccess;S&&S()}),_defineProperty(_assertThisInitialized(e),"onRenderError",function(S){var _=e.props.onRenderAnnotationLayerError;_&&_(S)}),e}return _createClass(y,[{key:"componentDidMount",value:function(){var a=this.props.page;invariant(a),parseInt(window.getComputedStyle(document.body).getPropertyValue("--react-pdf-annotation-layer"),10),this.loadAnnotations()}},{key:"componentDidUpdate",value:function(a){var k=this.props,O=k.page,S=k.renderForms;(a.page&&O!==a.page||S!==a.renderForms)&&this.loadAnnotations()}},{key:"componentWillUnmount",value:function(){cancelRunningTask(this.runningTask)}},{key:"viewport",get:function(){var a=this.props,k=a.page,O=a.rotate,S=a.scale;return k.getViewport({scale:S,rotation:O})}},{key:"renderAnnotationLayer",value:function(){var a=this.state.annotations;if(a){var k=this.props,O=k.imageResourcesPath,S=k.linkService,_=k.page,f=k.renderForms,C=this.viewport.clone({dontFlip:!0}),L={annotations:a,div:this.layerElement.current,imageResourcesPath:O,linkService:S,page:_,renderForms:f,viewport:C};this.layerElement.current.innerHTML="";try{pdfExports.AnnotationLayer.render(L),this.onRenderSuccess()}catch(w){this.onRenderError(w)}}}},{key:"render",value:function(){return React.createElement("div",{className:"react-pdf__Page__annotations annotationLayer",ref:this.layerElement},this.renderAnnotationLayer())}}]),y}(reactExports.PureComponent);AnnotationLayerInternal.propTypes={imageResourcesPath:PropTypes.string,linkService:isLinkService.isRequired,onGetAnnotationsError:PropTypes.func,onGetAnnotationsSuccess:PropTypes.func,onRenderAnnotationLayerError:PropTypes.func,onRenderAnnotationLayerSuccess:PropTypes.func,page:isPage,renderForms:PropTypes.bool,rotate:isRotate,scale:PropTypes.number};var AnnotationLayer=function A(r){return React.createElement(DocumentContext.Consumer,null,function(y){return React.createElement(PageContext.Consumer,null,function(e){return React.createElement(AnnotationLayerInternal,_extends({},y,e,r))})})};function ownKeys(A,r){var y=Object.keys(A);if(Object.getOwnPropertySymbols){var e=Object.getOwnPropertySymbols(A);r&&(e=e.filter(function(a){return Object.getOwnPropertyDescriptor(A,a).enumerable})),y.push.apply(y,e)}return y}function _objectSpread(A){for(var r=1;r<arguments.length;r++){var y=arguments[r]!=null?arguments[r]:{};r%2?ownKeys(Object(y),!0).forEach(function(e){_defineProperty(A,e,y[e])}):Object.getOwnPropertyDescriptors?Object.defineProperties(A,Object.getOwnPropertyDescriptors(y)):ownKeys(Object(y)).forEach(function(e){Object.defineProperty(A,e,Object.getOwnPropertyDescriptor(y,e))})}return A}function _createSuper(A){var r=_isNativeReflectConstruct();return function(){var e=_getPrototypeOf(A),a;if(r){var k=_getPrototypeOf(this).constructor;a=Reflect.construct(e,arguments,k)}else a=e.apply(this,arguments);return _possibleConstructorReturn(this,a)}}function _isNativeReflectConstruct(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}var defaultScale=1,PageInternal=function(A){_inherits(y,A);var r=_createSuper(y);function y(){var e;_classCallCheck(this,y);for(var a=arguments.length,k=new Array(a),O=0;O<a;O++)k[O]=arguments[O];return e=r.call.apply(r,[this].concat(k)),_defineProperty(_assertThisInitialized(e),"state",{page:null}),_defineProperty(_assertThisInitialized(e),"pageElement",reactExports.createRef()),_defineProperty(_assertThisInitialized(e),"onLoadSuccess",function(){var S=e.props,_=S.onLoadSuccess,f=S.registerPage,C=e.state.page;_&&_(makePageCallback(C,e.scale)),f&&f(e.pageIndex,e.pageElement.current)}),_defineProperty(_assertThisInitialized(e),"onLoadError",function(S){e.setState({page:!1});var _=e.props.onLoadError;_&&_(S)}),_defineProperty(_assertThisInitialized(e),"loadPage",function(){var S=e.props.pdf,_=e.getPageNumber();if(_){e.setState(function(C){return C.page?{page:null}:null});var f=makeCancellablePromise(S.getPage(_));e.runningTask=f,f.promise.then(function(C){e.setState({page:C},e.onLoadSuccess)}).catch(function(C){e.onLoadError(C)})}}),e}return _createClass(y,[{key:"componentDidMount",value:function(){var a=this.props.pdf;invariant(a),this.loadPage()}},{key:"componentDidUpdate",value:function(a){var k=this.props.pdf;if(a.pdf&&k!==a.pdf||this.getPageNumber()!==this.getPageNumber(a)){var O=this.props.unregisterPage;O&&O(this.getPageIndex(a)),this.loadPage()}}},{key:"componentWillUnmount",value:function(){var a=this.props.unregisterPage;a&&a(this.pageIndex),cancelRunningTask(this.runningTask)}},{key:"childContext",get:function(){var a=this.pageIndex,k=this.pageNumber,O=this.state.page;if(!O)return{};var S=this.props,_=S.canvasBackground,f=S.customTextRenderer,C=S.devicePixelRatio,L=S.onGetAnnotationsError,w=S.onGetAnnotationsSuccess,T=S.onGetTextError,h=S.onGetTextSuccess,t=S.onRenderAnnotationLayerError,o=S.onRenderAnnotationLayerSuccess,c=S.onRenderError,x=S.onRenderSuccess,b=S.onRenderTextLayerError,d=S.onRenderTextLayerSuccess,i=S.renderForms,l=S.renderInteractiveForms;return{canvasBackground:_,customTextRenderer:f,devicePixelRatio:C,onGetAnnotationsError:L,onGetAnnotationsSuccess:w,onGetTextError:T,onGetTextSuccess:h,onRenderAnnotationLayerError:t,onRenderAnnotationLayerSuccess:o,onRenderError:c,onRenderSuccess:x,onRenderTextLayerError:b,onRenderTextLayerSuccess:d,page:O,pageIndex:a,pageNumber:k,renderForms:i??l,rotate:this.rotate,scale:this.scale}}},{key:"getPageIndex",value:function(){var a=arguments.length>0&&arguments[0]!==void 0?arguments[0]:this.props;return isProvided(a.pageNumber)?a.pageNumber-1:isProvided(a.pageIndex)?a.pageIndex:null}},{key:"getPageNumber",value:function(){var a=arguments.length>0&&arguments[0]!==void 0?arguments[0]:this.props;return isProvided(a.pageNumber)?a.pageNumber:isProvided(a.pageIndex)?a.pageIndex+1:null}},{key:"pageIndex",get:function(){return this.getPageIndex()}},{key:"pageNumber",get:function(){return this.getPageNumber()}},{key:"rotate",get:function(){var a=this.props.rotate;if(isProvided(a))return a;var k=this.state.page;return k?k.rotate:null}},{key:"scale",get:function(){var a=this.state.page;if(!a)return null;var k=this.props,O=k.scale,S=k.width,_=k.height,f=this.rotate,C=1,L=O===null?defaultScale:O;if(S||_){var w=a.getViewport({scale:1,rotation:f});C=S?S/w.width:_/w.height}return L*C}},{key:"eventProps",get:function(){var a=this;return makeEventProps(this.props,function(){var k=a.state.page;return k&&makePageCallback(k,a.scale)})}},{key:"pageKey",get:function(){return"".concat(this.pageIndex,"@").concat(this.scale,"/").concat(this.rotate)}},{key:"pageKeyNoScale",get:function(){return"".concat(this.pageIndex,"/").concat(this.rotate)}},{key:"renderMainLayer",value:function(){var a=this.props,k=a.canvasRef,O=a.renderMode;switch(O){case"none":return null;case"svg":return React.createElement(PageSVG,{key:"".concat(this.pageKeyNoScale,"_svg")});case"canvas":default:return React.createElement(PageCanvas,{key:"".concat(this.pageKey,"_canvas"),canvasRef:k})}}},{key:"renderTextLayer",value:function(){var a=this.props.renderTextLayer;return a?React.createElement(TextLayer,{key:"".concat(this.pageKey,"_text")}):null}},{key:"renderAnnotationLayer",value:function(){var a=this.props.renderAnnotationLayer;return a?React.createElement(AnnotationLayer,{key:"".concat(this.pageKey,"_annotations")}):null}},{key:"renderChildren",value:function(){var a=this.props.children;return React.createElement(PageContext.Provider,{value:this.childContext},this.renderMainLayer(),this.renderTextLayer(),this.renderAnnotationLayer(),a)}},{key:"renderContent",value:function(){var a=this.pageNumber,k=this.props.pdf,O=this.state.page;if(!a){var S=this.props.noData;return React.createElement(Message,{type:"no-data"},typeof S=="function"?S():S)}if(k===null||O===null){var _=this.props.loading;return React.createElement(Message,{type:"loading"},typeof _=="function"?_():_)}if(k===!1||O===!1){var f=this.props.error;return React.createElement(Message,{type:"error"},typeof f=="function"?f():f)}return this.renderChildren()}},{key:"render",value:function(){var a=this.pageNumber,k=this.props,O=k.className,S=k.inputRef;return React.createElement("div",_extends({className:clsx("react-pdf__Page",O),"data-page-number":a,ref:mergeRefs(S,this.pageElement),style:{position:"relative",minWidth:"min-content",minHeight:"min-content"}},this.eventProps),this.renderContent())}}]),y}(reactExports.PureComponent);PageInternal.defaultProps={error:"Failed to load the page.",loading:"Loading page…",noData:"No page specified.",renderAnnotationLayer:!0,renderMode:"canvas",renderTextLayer:!0,scale:defaultScale};var isFunctionOrNode=PropTypes.oneOfType([PropTypes.func,PropTypes.node]);PageInternal.propTypes=_objectSpread(_objectSpread({},eventProps),{},{canvasBackground:PropTypes.string,children:PropTypes.node,className:isClassName,customTextRenderer:PropTypes.func,devicePixelRatio:PropTypes.number,error:isFunctionOrNode,height:PropTypes.number,imageResourcesPath:PropTypes.string,inputRef:isRef,loading:isFunctionOrNode,noData:isFunctionOrNode,onGetTextError:PropTypes.func,onGetTextSuccess:PropTypes.func,onLoadError:PropTypes.func,onLoadSuccess:PropTypes.func,onRenderError:PropTypes.func,onRenderSuccess:PropTypes.func,onRenderTextLayerError:PropTypes.func,onRenderTextLayerSuccess:PropTypes.func,pageIndex:isPageIndex,pageNumber:isPageNumber,pdf:isPdf,registerPage:PropTypes.func,renderAnnotationLayer:PropTypes.bool,renderForms:PropTypes.bool,renderInteractiveForms:PropTypes.bool,renderMode:isRenderMode,renderTextLayer:PropTypes.bool,rotate:isRotate,scale:PropTypes.number,unregisterPage:PropTypes.func,width:PropTypes.number});function Page(A,r){return React.createElement(DocumentContext.Consumer,null,function(y){return React.createElement(PageInternal,_extends({ref:r},y,A))})}const Page$1=React.forwardRef(Page);pdfExports.GlobalWorkerOptions.workerSrc=new URL("/assets/pdf.worker-JgWQ90x2.js",import.meta.url);function PDFCard(A){var t,o;const[r,y]=reactExports.useState("width"),[e,a]=reactExports.useState(1),[k,O]=reactExports.useState(!1),[S,_]=reactExports.useState(A.card.currentPage),{dispatch:f}=reactExports.useContext(ReducerContext),C=reactExports.useContext(ViewTypeContext),L=reactExports.useRef(null),w=C!==ViewType.Player||A.card.playerViewPermission===PlayerViewPermission.Interact;if(reactExports.useEffect(()=>{w||_(A.card.currentPage)},[A.card.currentPage,w]),A.card.pdfUrl==="")return w?jsxRuntimeExports.jsx(BaseCard,{cardState:A.card,commands:null,children:jsxRuntimeExports.jsx(FileUpload,{currentUrl:A.card.pdfUrl,onFileSelect:c=>{setCardPDF(A.card,f,c.name,c.url)},fileType:"pdf",fileInputAccept:".pdf"})}):jsxRuntimeExports.jsx(Paragraph,{children:"No PDF Uploaded."});const T=c=>{c<1&&(c=1),c>e&&(c=e),C!==ViewType.Player&&f(CardActions.SetPDFPage({cardId:A.card.cardId,page:c})),_(c)},h=jsxRuntimeExports.jsxs(jsxRuntimeExports.Fragment,{children:[jsxRuntimeExports.jsx(Button,{icon:jsxRuntimeExports.jsx(FontAwesomeIcon,{icon:faFileUpload}),tip:"Select or upload PDF",onClick:()=>clearCardPDF(A.card,f)}),jsxRuntimeExports.jsx(Button,{icon:jsxRuntimeExports.jsx(FontAwesomeIcon,{icon:faList}),tip:"Toggle outline",onClick:()=>O(!k),active:k}),jsxRuntimeExports.jsx(Button,{icon:jsxRuntimeExports.jsx(FontAwesomeIcon,{icon:faStepBackward}),onClick:()=>T(1)}),jsxRuntimeExports.jsx(Button,{icon:jsxRuntimeExports.jsx(FontAwesomeIcon,{icon:faCaretLeft}),onClick:()=>T(S-1)}),jsxRuntimeExports.jsx(Box,{style:{width:"60px"},flex:"grow",children:jsxRuntimeExports.jsx(TextInput,{type:"number",value:S,className:"no-spinner",style:{textAlign:"center"},onChange:c=>T(parseInt(c.target.value)),onFocus:c=>c.target.select()})}),jsxRuntimeExports.jsx(Button,{icon:jsxRuntimeExports.jsx(FontAwesomeIcon,{icon:faCaretRight}),onClick:()=>T(S+1)}),jsxRuntimeExports.jsx(Button,{icon:jsxRuntimeExports.jsx(FontAwesomeIcon,{icon:faStepForward}),onClick:()=>T(e)}),jsxRuntimeExports.jsx(Button,{icon:jsxRuntimeExports.jsx(FontAwesomeIcon,{icon:faArrowsAltV}),onClick:()=>y("height"),tip:"Fit document to card height",active:r==="height"}),jsxRuntimeExports.jsx(Button,{icon:jsxRuntimeExports.jsx(FontAwesomeIcon,{icon:faArrowsAltH}),onClick:()=>y("width"),tip:"Fit document to card width",active:r==="width"})]});return jsxRuntimeExports.jsx(BaseCard,{centerRow:!k,cardState:A.card,onKeyDown:c=>{["ArrowLeft","PageUp"].includes(c.key)&&T(S-1),["ArrowRight","PageDown"].includes(c.key)&&T(S+1),["Home"].includes(c.key)&&T(1),["End"].includes(c.key)&&T(e)},commands:h,innerBoxRef:L,children:jsxRuntimeExports.jsx(Box,{overflow:"auto",align:"center",children:jsxRuntimeExports.jsx(Document,{file:A.card.pdfUrl,onLoadSuccess:c=>{a(c.numPages)},children:k?jsxRuntimeExports.jsx(Outline$1,{onItemClick:c=>{T(parseInt(c.pageNumber)),O(!1)}},A.card.pdfUrl):jsxRuntimeExports.jsx(Page$1,{pageNumber:isNaN(S)?1:S,width:r==="width"?(((t=L.current)==null?void 0:t.clientWidth)??30)-30:void 0,height:r==="height"?(((o=L.current)==null?void 0:o.clientHeight)??30)-30:void 0,renderAnnotationLayer:!1})})})})}function setCardPDF(A,r,y,e){r(CardActions.SetPDF({cardId:A.cardId,pdfURL:e,pdfTitle:y}))}function clearCardPDF(A,r){r(CardActions.SetPDF({cardId:A.cardId,pdfURL:"",pdfTitle:""}))}export{PDFCard as default};
