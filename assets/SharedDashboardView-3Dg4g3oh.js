import{r as i,j as e}from"./index-B8dM5wP1.js";import{R as c,u as h,b as j,F as y,l as w,m as D,n as v,q as A,H as C,B as l,a as p,G as u,i as f,j as x,g as I,r as B,o as R,d as m,V as T,h as V,U as P,k}from"./FirebaseUtils-DEoDaR8n.js";import{R as E,A as F}from"./RollAllTablesButton-BievJZqc.js";import{u as G,C as H}from"./usePageTitle-C69C0c9x.js";import"./RollTableCard-BmRqVbPf.js";import"./TextArea-DyAA7ivr.js";import"./useScrollTo-CPgUcn6H.js";function L(){const{state:t}=i.useContext(c),a=h();return e.jsx(j,{icon:e.jsx(y,{icon:w}),label:"Copy this Dashboard",onClick:()=>O(t,a)})}function O(t,a){if(!a)return;const s=localStorage.getItem("appState"),o=s?JSON.parse(s):null,r=D.merge(v(),o),d=A(),n=t.dashboardsById[a];n&&(r.dashboardsById[d]={...n,campaignId:void 0}),r.cardsById={...r.cardsById,...t.cardsById},localStorage.setItem("appState",JSON.stringify(r)),window.location.href=`/e/${d}`}const g=()=>{var s,o;const{state:t}=i.useContext(c),a=h();return e.jsxs(C,{background:"brand",pad:"none",fill:"horizontal",children:[e.jsxs(l,{fill:"horizontal",direction:"row",justify:"center",align:"center",pad:{left:"10px",right:"10px"},children:[e.jsx(p,{level:1,size:"small",margin:"none",title:((s=u(t,a))==null?void 0:s.name)||"Loading...",children:((o=u(t,a))==null?void 0:o.name)||"Loading..."}),e.jsx(p,{level:2,size:"small",margin:{left:"10px"},title:"Shared from Paragon Campaign Dashboard",style:{whiteSpace:"nowrap",overflow:"hidden",textOverflow:"ellipsis"},children:"Shared from Paragon Campaign Dashboard"})]}),e.jsxs(l,{direction:"row",flex:"grow",children:[e.jsx(E,{}),e.jsx(L,{})]})]})};function z(t){const[a,s]=i.useState(null);return i.useEffect(()=>{if(!t)return;const o=I(),r=B(o,`shared/${t}`);return R(r,d=>{const n=d.val();if(!n)return;m(r);const S=P(n),b=k.restorePrunedEmptyArrays(S);s(b)}),()=>m(r)},[t]),a}function Q(){const t=h(),a=z(t);return a?e.jsx(N,{loadedState:a}):e.jsx(f,{style:{minHeight:"100%"},theme:x,children:e.jsx(l,{fill:!0,align:"center",children:e.jsx(g,{})})})}function N(t){const[a,s]=i.useReducer(F,t.loadedState);return G(a),e.jsx(c.Provider,{value:{state:a,dispatch:s},children:e.jsx(T.Provider,{value:V.Dashboard,children:e.jsx(f,{style:{minHeight:"100%"},theme:x,children:e.jsxs(l,{fill:!0,align:"center",children:[e.jsx(g,{}),e.jsx(H,{})]})})})})}export{N as SharedDashboardViewWithState,Q as default};
